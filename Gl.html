<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>גלריה פיזיקלית - צינור כרטיסיות</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        #physics-container {
             /* --- שינוי: קונטיינר צר יותר --- */
            width: 350px; /* רוחב ה"צינור" */
            max-width: 90%; /* מגבלה רספונסיבית */
            height: 85vh; /* גובה מספיק לערימה */
            position: relative;
            border: 1px solid #ccc;
            background-color: #e9e9e9; /* שינוי רקע קל */
            overflow: hidden;
        }

        .work-card {
            position: absolute;
            background-color: #3498db; /* צבע שונה לדוגמה */
            color: white;
            padding: 10px; /* פדינג קטן יותר */
            border-radius: 5px; /* עיגול פינות קטן */
            box-shadow: 1px 1px 4px rgba(0,0,0,0.2);
            cursor: grab;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around; /* פיזור התוכן */
            text-align: center;
             /* --- שינוי: כרטיס רחב וגבוה --- */
            width: 95%; /* כמעט מלא רוחב הקונטיינר */
            height: 180px; /* גובה משמעותי לכרטיסיה גדולה */
            box-sizing: border-box;
            will-change: transform, top, left;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            /* חשוב שה-HTML יקבל את הרוחב כמעט מלא */
            left: 2.5%; /* ממקם במרכז (בערך) אם הרוחב הוא 95% */
        }

        .work-card img {
            max-width: 80%;
            max-height: 70%; /* מגביל גובה תמונה */
            height: auto;
            margin-bottom: 5px;
            pointer-events: none;
        }
        .work-card span {
             font-size: 1em; /* גופן מעט גדול יותר */
             pointer-events: none;
        }

    </style>
</head>
<body>

<div id="physics-container">
    <div class="work-card">
        <img src="placeholder.png" alt="עבודה 1">
        <span>עבודה ראשונה</span>
    </div>
    <div class="work-card">
        <img src="placeholder.png" alt="עבודה 2">
        <span>העבודה השנייה</span>
    </div>
    <div class="work-card">
        <img src="placeholder.png" alt="עבודה 3">
        <span>פרויקט גמר</span>
    </div>
    <div class="work-card">
       <span>כרטיס טקסט בלבד</span>
    </div>
     </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const Engine = Matter.Engine;
        const Runner = Matter.Runner;
        const Bodies = Matter.Bodies;
        const Composite = Matter.Composite;
        const Mouse = Matter.Mouse;
        const MouseConstraint = Matter.MouseConstraint;
        const Events = Matter.Events;

        const container = document.getElementById('physics-container');
        // חשוב לקבל מידות אחרי שה-CSS הוחל
        let containerRect = container.getBoundingClientRect();
        const cards = Array.from(container.querySelectorAll('.work-card'));

        const engine = Engine.create();
        const world = engine.world;
         // --- שינוי: אפשר להפחית מעט כבידה לאפקט "רך" יותר ---
        engine.world.gravity.y = 0.7;

        // --- שינוי: עדכון מיקום ורוחב הגבולות ---
        const wallThickness = 60; // עובי הקירות (מחוץ למסך)
        const wallOptions = {
            isStatic: true,
            render: { visible: false }
        };

        let ground, ceiling, leftWall, rightWall;

        function updateWalls() {
            containerRect = container.getBoundingClientRect(); // עדכן מידות
             // הסר קירות קודמים אם קיימים (למקרה של resize)
            if (ground) Composite.remove(world, [ground, ceiling, leftWall, rightWall]);

            ground = Bodies.rectangle(containerRect.width / 2, containerRect.height + wallThickness / 2, containerRect.width, wallThickness, wallOptions);
            ceiling = Bodies.rectangle(containerRect.width / 2, -wallThickness / 2, containerRect.width, wallThickness, wallOptions);
            // קירות צמודים יותר ליצירת "צינור"
            leftWall = Bodies.rectangle(-wallThickness / 2, containerRect.height / 2, wallThickness, containerRect.height, wallOptions);
            rightWall = Bodies.rectangle(containerRect.width + wallThickness / 2, containerRect.height / 2, wallThickness, containerRect.height, wallOptions);

            Composite.add(world, [ground, ceiling, leftWall, rightWall]);
        }

        updateWalls(); // קריאה ראשונית ליצירת הקירות

        // --- שינוי: מיקום התחלתי בערימה ---
        const stackStartX = containerRect.width / 2; // מרכז אופקי
        const stackStartY = 30; // התחל קצת מתחת לקצה העליון
        const cardSpacing = 8; // מרווח קטן בין הכרטיסיות בערימה ההתחלתית

        const cardBodies = cards.map((card, index) => {
            // חשוב לקחת מידות אחרי שה-CSS נטען
            const cardWidth = card.offsetWidth;
            const cardHeight = card.offsetHeight;

            // מיקום התחלתי: מרכז אופקי, ערימה אנכית מהחלק העליון
            const initialX = stackStartX + (Math.random() * 4 - 2); // הטיה אופקית קטנה למניעת ערימה "מושלמת"
            const initialY = stackStartY + index * (cardHeight + cardSpacing) + cardHeight / 2;

            const body = Bodies.rectangle(
                initialX,
                initialY,
                cardWidth * 0.98, // גוף פיזי מעט יותר צר מה-HTML למניעת הידבקות לקיר
                cardHeight,
                {
                     // --- שינוי: התאמת פרמטרים לערימה ---
                    restitution: 0.2, // פחות קפיציות
                    friction: 0.4,    // יותר חיכוך (עוזר ליציבות ערימה)
                    frictionAir: 0.03, // מעט יותר חיכוך אוויר
                    density: 0.0015   // אפשר להגדיל מעט צפיפות
                }
            );

            body.element = card;
            card.body = body;
            return body;
        });

        Composite.add(world, cardBodies);

        // הוספת שליטה עם העכבר
        const mouse = Mouse.create(container);
        const mouseConstraint = MouseConstraint.create(engine, {
            mouse: mouse,
            constraint: {
                stiffness: 0.2,
                render: { visible: false }
            }
        });
        Composite.add(world, mouseConstraint);

        // לולאת עדכון לסינכרון ה-HTML
        Events.on(engine, 'afterUpdate', () => {
            cardBodies.forEach(body => {
                const element = body.element;
                if (element) {
                    // ה-CSS כבר ממקם את ה-left: 2.5%, אז נשלוט רק ב-top ובסיבוב
                    element.style.top = `${body.position.y - element.offsetHeight / 2}px`;
                     // עדכון ה-left חשוב כי הפיזיקה מחשבת אותו מהמרכז
                    element.style.left = `${body.position.x - element.offsetWidth / 2}px`;
                    element.style.transform = `rotate(${body.angle}rad)`;
                }
            });
        });

        const runner = Runner.create();
        Runner.run(runner, engine);

         // עדכון גבולות בחלון שינוי גודל
         window.addEventListener('resize', () => {
             updateWalls(); // קורא לפונקציה שמעדכנת מידות וממקמת קירות מחדש
             // ייתכן שיהיה צורך גם לעדכן מיקומי גופים דינמיים או קנה מידה,
             // אך לרוב עדכון הקירות מספיק להתנהגות סבירה.
         });
    });
</script>

</body>
</html>
