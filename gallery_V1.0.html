<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>טבלת פיצויים אינטראקטיבית – ריטיינר דינמי</title>
  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
  <style>
    body {
      margin: 0; padding: 20px;
      font-family: Arial, sans-serif;
      background: #f0f2f5;
    }
    h1 {
      text-align: center; margin-bottom: 20px;
    }
    .controls {
      position: -webkit-sticky; /* Safari */
      position: sticky;
      top: 0;
      background: #f0f2f5;
      padding: 10px 0;
      display: flex; flex-wrap: wrap;
      gap: 15px; max-width: 800px;
      margin: 0 auto 30px;
      z-index: 1000;
    }
    .slider-group {
      flex: 1 1 45%;
      min-width: 140px;
    }
    .slider-group label {
      display: block;
      font-size: 1rem;
      font-weight: bold;
      margin-bottom: 5px;
      text-align: right;
    }
    .slider-group input[type=range] {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: #ddd;
      outline: none;
      -webkit-appearance: none;
    }
    .slider-group input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #007bff;
      cursor: pointer;
      border: 2px solid #fff;
      margin-top: -8px;
    }
    .slider-group input[type=range]::-moz-range-thumb {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #007bff;
      cursor: pointer;
      border: 2px solid #fff;
    }
    .slider-value-display {
      text-align: center;
      margin-top: 4px;
      font-size: 1rem;
      color: #333;
    }
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
      gap: 15px;
      max-width: 900px; margin: 0 auto;
    }
    .card {
      background: #fff; border-radius: 8px;
      padding: 20px; text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      transition: transform .2s, box-shadow .2s;
    }
    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .card-icon {
      font-size: 1.8em; margin-bottom: 10px;
      display: inline-block; padding: 10px;
      border-radius: 50%;
    }
    .icon-rate-work     { background: rgba(23,162,184,0.1); color: #17a2b8; }
    .icon-rate-travel   { background: rgba(255,193,7,0.1); color: #ffc107; }
    .icon-sum-work      { background: rgba(40,167,69,0.1); color: #28a745; }
    .icon-sum-travel    { background: rgba(0,123,255,0.1); color: #007bff; }
    .icon-comp-total    { background: rgba(108,117,125,0.1); color: #6c757d; }
    .icon-ops-expense   { background: rgba(220,53,69,0.1); color: #dc3545; }
    .icon-retainer      { background: rgba(0,123,255,0.1); color: #007bff; }
    .card-title {
      font-size: 1.05em; margin-bottom: 6px;
      font-weight: bold;
    }
    .card-value {
      font-size: 1.4em; font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>טבלת פיצויים אינטראקטיבית</h1>

  <div class="controls">
    <div class="slider-group">
      <label for="retainer">ריטיינר חודשי ($):</label>
      <input type="range" id="retainer" min="0" max="20000" step="50" value="8650" />
      <div class="slider-value-display" id="retainerDisplay">$8,650.00</div>
    </div>
    <div class="slider-group">
      <label for="workDays">ימי עבודה/הכנה:</label>
      <input type="range" id="workDays" min="0" max="30" value="10" />
      <div class="slider-value-display" id="workDaysDisplay">10 ימים</div>
    </div>
    <div class="slider-group">
      <label for="travelDays">ימי נסיעה:</label>
      <input type="range" id="travelDays" min="0" max="30" value="11" />
      <div class="slider-value-display" id="travelDaysDisplay">11 ימים</div>
    </div>
    <div class="slider-group">
      <label for="opsRate">הוצאות מנהל ליום נסיעה ($):</label>
      <input type="range" id="opsRate" min="0" max="500" step="5" value="205" />
      <div class="slider-value-display" id="opsRateDisplay">$205.00</div>
    </div>
  </div>

  <div class="cards">
    <div class="card">
      <div class="card-icon icon-rate-work"><i class="fas fa-tags"></i></div>
      <div class="card-title">תעריף ליום עבודה</div>
      <div class="card-value" id="rateWorkValue">$0.00</div>
    </div>
    <div class="card">
      <div class="card-icon icon-rate-travel"><i class="fas fa-tags"></i></div>
      <div class="card-title">תעריף ליום נסיעה</div>
      <div class="card-value" id="rateTravelValue">$0.00</div>
    </div>
    <div class="card">
      <div class="card-icon icon-sum-work"><i class="fas fa-calendar-check"></i></div>
      <div class="card-title">סכום ימי עבודה</div>
      <div class="card-value" id="sumWorkValue">$0.00</div>
    </div>
    <div class="card">
      <div class="card-icon icon-sum-travel"><i class="fas fa-plane"></i></div>
      <div class="card-title">סכום ימי נסיעה</div>
      <div class="card-value" id="sumTravelValue">$0.00</div>
    </div>
    <div class="card">
      <div class="card-icon icon-comp-total"><i class="fas fa-hand-holding-usd"></i></div>
      <div class="card-title">סך הכל פיצוי</div>
      <div class="card-value" id="compTotalValue">$0.00</div>
    </div>
    <div class="card">
      <div class="card-icon icon-ops-expense"><i class="fas fa-file-invoice-dollar"></i></div>
      <div class="card-title">הוצאות מנהל תפעול</div>
      <div class="card-value" id="opsExpenseValue">$0.00</div>
    </div>
    <div class="card">
      <div class="card-icon icon-retainer"><i class="fas fa-wallet"></i></div>
      <div class="card-title">ריטיינר חודשי</div>
      <div class="card-value" id="retainerValue">$8,650.00</div>
    </div>
  </div>

  <script>
    const BASE_RATIO = 356.86 / 256.86;
    const retainerSlider = document.getElementById('retainer');
    const workSlider     = document.getElementById('workDays');
    const travelSlider   = document.getElementById('travelDays');
    const opsSlider      = document.getElementById('opsRate');

    const retainerDisplay = document.getElementById('retainerDisplay');
    const workDisplay     = document.getElementById('workDaysDisplay');
    const travelDisplay   = document.getElementById('travelDaysDisplay');
    const opsDisplay      = document.getElementById('opsRateDisplay');

    const rateWorkEl    = document.getElementById('rateWorkValue');
    const rateTravelEl  = document.getElementById('rateTravelValue');
    const sumWorkEl     = document.getElementById('sumWorkValue');
    const sumTravelEl   = document.getElementById('sumTravelValue');
    const compTotalEl   = document.getElementById('compTotalValue');
    const opsExpEl      = document.getElementById('opsExpenseValue');
    const retainerEl    = document.getElementById('retainerValue');

    function formatUSD(val) {
      return '$' + val.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function updateAll() {
      const R = +retainerSlider.value;
      const wd = +workSlider.value;
      const td = +travelSlider.value;
      const or = +opsSlider.value;

      retainerDisplay.textContent = formatUSD(R);
      workDisplay.textContent     = wd + (wd === 1 ? ' יום' : ' ימים');
      travelDisplay.textContent   = td + (td === 1 ? ' יום' : ' ימים');
      opsDisplay.textContent      = formatUSD(or);

      const totalOpsExp = td * or;
      const compPool = R - totalOpsExp;
      const k = compPool / (wd * BASE_RATIO + td);
      const rateTravel = isFinite(k) && k > 0 ? k : 0;
      const rateWork   = BASE_RATIO * rateTravel;

      const sumWork   = rateWork * wd;
      const sumTravel = rateTravel * td;

      rateWorkEl.textContent   = formatUSD(rateWork);
      rateTravelEl.textContent = formatUSD(rateTravel);
      sumWorkEl.textContent    = formatUSD(sumWork);
      sumTravelEl.textContent  = formatUSD(sumTravel);
      compTotalEl.textContent  = formatUSD(compPool);
      opsExpEl.textContent     = formatUSD(totalOpsExp);
      retainerEl.textContent   = formatUSD(R);
    }

    [retainerSlider, workSlider, travelSlider, opsSlider].forEach(slider =>
      slider.addEventListener('input', updateAll)
    );

    updateAll();
  </script>
</body>
</html>
