<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Orion Infinity V9 - Pro Data</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap');

        body {
            font-family: 'Heebo', sans-serif;
            background-color: #050505;
            color: #e5e5e5;
            overflow: hidden;
            margin: 0; padding: 0;
            touch-action: manipulation;
        }

        /* --- Background Video Mixers --- */
        #video-stage {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: 0; background: #000; pointer-events: none;
        }
        .player-wrapper {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; transition: opacity 0.5s ease-in-out; 
        }
        .video-foreground { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        @media (min-aspect-ratio: 16/9) { .video-foreground iframe { width: 100%; height: 140%; top: -20%; } }
        @media (max-aspect-ratio: 16/9) { .video-foreground iframe { width: 140%; height: 100%; left: -20%; } }
        .player-wrapper iframe { width: 100%; height: 100%; pointer-events: none; }

        /* --- FLOATING INFO CARD --- */
        #floating-info {
            position: fixed; top: 20px; left: 20px; z-index: 10;
            background: rgba(10, 10, 10, 0.85); backdrop-filter: blur(12px);
            border-right: 3px solid #4ade80;
            border-radius: 4px;
            padding: 12px 16px;
            max-width: 240px; cursor: pointer;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            transform: translateY(0); opacity: 1;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #floating-info:hover { background: rgba(20, 20, 20, 0.95); transform: translateY(2px); }
        #floating-info.hidden-card { transform: translateY(-100px); opacity: 0; pointer-events: none; }
        
        .float-label { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 2px; }
        .float-title { font-size: 0.9rem; font-weight: 900; color: white; line-height: 1.1; margin-bottom: 4px; }
        .float-tech { font-size: 0.75rem; color: #4ade80; font-family: monospace; border-top: 1px solid #333; padding-top: 4px; margin-top: 4px; }
        .float-hint { font-size: 0.65rem; color: #888; margin-top: 6px; display: flex; align-items: center; gap: 4px; }

        /* --- UI Overlay --- */
        #ui-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 20;
            background: rgba(5, 5, 5, 0.96); backdrop-filter: blur(10px);
            transition: opacity 0.4s ease, transform 0.4s ease;
            display: flex; flex-direction: column;
        }
        #ui-layer.hidden-ui { opacity: 0; pointer-events: none; transform: scale(1.02); }

        /* --- Search Bar --- */
        .search-container { padding: 0 15px 10px 15px; background: #0a0a0a; border-bottom: 1px solid #222; }
        .search-input {
            width: 100%; background: #151515; border: 1px solid #333; color: white;
            padding: 10px 14px; border-radius: 6px; font-size: 0.9rem;
            transition: border-color 0.2s;
        }
        .search-input:focus { outline: none; border-color: #4ade80; background: #1a1a1a; }

        /* --- Tabs --- */
        .tab-bar { display: flex; background: #0a0a0a; border-bottom: 1px solid #222; flex-shrink: 0; }
        .tab-btn {
            flex: 1; padding: 14px; text-align: center; color: #666; font-weight: bold; font-size: 0.85rem;
            border-bottom: 2px solid transparent; transition: all 0.2s; cursor: pointer;
        }
        .tab-btn.active { color: #fff; border-bottom-color: #4ade80; background: #111; }

        #tab-content-area { flex: 1; overflow-y: auto; padding: 15px; position: relative; }
        .view-section { display: none; animation: fadeIn 0.3s ease-out; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- DETAILS VIEW --- */
        .details-header { margin-bottom: 20px; }
        .details-title { font-size: 1.5rem; font-weight: 900; line-height: 1.1; margin-bottom: 5px; color: white; }
        .details-subtitle { font-size: 0.9rem; color: #888; font-weight: 300; }
        
        .tech-box { background: #111; border: 1px solid #333; border-radius: 8px; padding: 15px; margin-bottom: 20px; }
        .tech-label { font-size: 0.7rem; color: #4ade80; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .tech-content { font-size: 0.95rem; color: #ddd; line-height: 1.4; }

        .tag-cloud { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; }
        .tag { background: #1a1a1a; border: 1px solid #333; padding: 6px 10px; border-radius: 4px; font-size: 0.8rem; color: #ccc; }
        .tag.brand { border-color: #4ade80; color: #4ade80; background: rgba(74, 222, 128, 0.05); }

        .highlight-item {
            padding: 12px; border-bottom: 1px solid #222; display: flex; gap: 12px; align-items: center;
            cursor: pointer; transition: background 0.2s;
        }
        .highlight-item:hover { background: #151515; }
        .highlight-item:last-child { border-bottom: none; }
        .time-badge { background: #222; padding: 4px 8px; border-radius: 4px; font-family: monospace; font-size: 0.8rem; color: #4ade80; border: 1px solid #333; }

        /* --- Sequence List --- */
        .clip-card {
            background: #111; border: 1px solid #222; border-radius: 8px;
            margin-bottom: 8px; padding: 10px; display: flex; align-items: center; gap: 12px;
            transition: all 0.2s; position: relative; overflow: hidden;
        }
        .clip-card.playing { border-color: #4ade80; background: #0f1f15; }
        .clip-info { flex: 1; overflow: hidden; cursor: pointer; z-index: 2; }
        .clip-title { font-weight: bold; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #e5e5e5; }
        .clip-tech { font-size: 0.75rem; color: #666; margin-top: 2px; font-family: monospace; }
        
        .mini-timeline-bg { height: 3px; background: #222; border-radius: 2px; margin-top: 8px; position: relative; width: 100%; overflow: hidden; }
        .mini-timeline-fill { position: absolute; height: 100%; background: #333; width: 100%; }
        .mini-range { position: absolute; height: 100%; background: #4ade80; border-radius: 2px; z-index: 2; }

        .btn-icon { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px; color: #666; transition: 0.2s; z-index: 2; }
        .btn-icon:hover { background: #222; color: white; }

        /* --- Source List --- */
        .source-group { margin-bottom: 15px; border: 1px solid #222; border-radius: 8px; overflow: hidden; background: #0a0a0a; }
        .source-header { padding: 12px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #222; }
        .source-title { font-weight: bold; font-size: 0.95rem; color: #fff; }
        .source-sub { font-size: 0.75rem; color: #666; margin-top: 2px; }
        .source-actions button { background: #1a1a1a; border: 1px solid #333; color: #ccc; font-size: 0.75rem; padding: 4px 10px; border-radius: 4px; transition: 0.2s; }
        .source-actions button:hover { border-color: #4ade80; color: #4ade80; }

        /* --- EDITOR MODAL --- */
        #editor-modal {
            position: fixed; inset: 0; z-index: 50; background: #000;
            display: flex; flex-direction: column; transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        #editor-modal.open { transform: translateY(0); }
        #editor-player-container { width: 100%; aspect-ratio: 16/9; background: #000; flex-shrink: 0; position: relative; }
        .editor-controls { padding: 20px; flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        
        .timeline-wrapper { position: relative; height: 60px; display: flex; align-items: center; touch-action: none; margin: 0 10px; }
        .timeline-track { position: absolute; left: 0; right: 0; height: 24px; background: #111; border-radius: 4px; border: 1px solid #333; overflow: hidden; }
        /* Simulated waveform */
        .waveform-pattern { width: 100%; height: 100%; opacity: 0.2; background-image: linear-gradient(90deg, transparent 50%, #444 50%); background-size: 4px 100%; }
        
        .timeline-range { position: absolute; height: 24px; background: rgba(74, 222, 128, 0.2); border: 1px solid #4ade80; box-sizing: border-box; }
        .timeline-handle { position: absolute; top: 50%; transform: translate(-50%, -50%); width: 40px; height: 60px; z-index: 10; cursor: col-resize; display: flex; justify-content: center; align-items: center; }
        .timeline-handle::after { content: ''; display: block; width: 4px; height: 40px; border-radius: 2px; background: #fff; box-shadow: 0 0 5px rgba(0,0,0,0.8); }
        .handle-l::after { background: #4ade80; } .handle-r::after { background: #ef4444; }

        /* General Controls */
        #settings-toggle { position: fixed; top: 20px; right: 20px; z-index: 30; background: rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.2); width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; backdrop-filter: blur(4px); cursor: pointer; transition: 0.2s; }
        #settings-toggle:hover { background: white; color: black; }
        #unmute-overlay { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); z-index: 25; background: #4ade80; color: black; padding: 12px 24px; border-radius: 50px; display: flex; align-items: center; gap: 10px; animation: fadeIn 1s ease-out; cursor: pointer; font-weight: bold; box-shadow: 0 0 20px rgba(74,222,128,0.4); }
        #unmute-overlay.hidden { display: none; }

    </style>
</head>
<body>

    <!-- Background Mixers -->
    <div id="video-stage" onclick="app.unmuteAll()">
        <div id="player1-wrapper" class="player-wrapper video-foreground"><div id="player1"></div></div>
        <div id="player2-wrapper" class="player-wrapper video-foreground"><div id="player2"></div></div>
    </div>

    <!-- Floating Info Card -->
    <div id="floating-info" class="hidden-card" onclick="app.openDetailsTab()">
        <div class="float-label">NOW PLAYING</div>
        <div class="float-title" id="float-title">◊õ◊ï◊™◊®◊™</div>
        <div class="float-tech" id="float-tech">TECH SPECS</div>
        <div class="float-hint"><span>‚ÑπÔ∏è</span> ◊ú◊ó◊• ◊ú◊§◊®◊ò◊ô◊ù ◊û◊ú◊ê◊ô◊ù</div>
    </div>

    <!-- Controls -->
    <div id="settings-toggle" onclick="app.toggleUI()">‚öôÔ∏è</div>
    <div id="unmute-overlay" onclick="app.unmuteAll()">
        <span>üîá</span><span>◊ú◊ó◊• ◊ú◊î◊§◊¢◊ú◊™ ◊°◊ê◊ï◊†◊ì</span>
    </div>

    <!-- Main UI -->
    <div id="ui-layer" class="hidden-ui">
        <div class="p-4 bg-black/80 border-b border-white/10 flex justify-between items-center shrink-0">
            <div>
                <h1 class="text-xl font-black tracking-tight text-white">ORION <span class="text-green-400">INFINITY</span></h1>
                <div class="text-[10px] text-gray-500 uppercase tracking-widest">Post-Production Portfolio</div>
            </div>
            <div class="flex gap-2">
                <button onclick="app.downloadJSON()" class="text-xs bg-gray-800 border border-gray-600 px-3 py-1 rounded hover:bg-gray-700">Backup</button>
                <input type="file" id="file-input" accept=".json" style="display: none" onchange="app.uploadJSON(this)">
                <button onclick="document.getElementById('file-input').click()" class="text-xs bg-gray-800 border border-gray-600 px-3 py-1 rounded hover:bg-gray-700">Load</button>
                <button onclick="app.toggleUI()" class="text-2xl ml-4 text-gray-400 hover:text-white">‚úï</button>
            </div>
        </div>

        <div class="search-container">
            <input type="text" id="search-input" class="search-input" placeholder="◊ó◊§◊© ◊ú◊§◊ô ◊ò◊õ◊†◊ô◊ß◊î, ◊û◊ï◊™◊í ◊ê◊ï ◊©◊ù ◊§◊®◊ï◊ô◊ß◊ò..." oninput="app.handleSearch(this.value)">
        </div>

        <div class="tab-bar">
            <div class="tab-btn active" onclick="app.switchTab('sequence')">SEQUENCE</div>
            <div class="tab-btn" onclick="app.switchTab('sources')">SOURCES (MEDIA POOL)</div>
            <div class="tab-btn" onclick="app.switchTab('details')">METADATA</div>
        </div>

        <div id="tab-content-area">
            <!-- VIEW 1: SEQUENCE -->
            <div id="view-sequence" class="view-section active">
                <div id="playlist-container"></div>
                <div class="mt-8 text-center pb-12">
                    <button onclick="app.regeneratePlaylist()" class="bg-red-600 hover:bg-red-500 text-white px-8 py-3 rounded-full text-sm font-bold shadow-lg transition transform hover:scale-105">
                        üé≤ RE-SHUFFLE MIX
                    </button>
                </div>
            </div>

            <!-- VIEW 2: SOURCES -->
            <div id="view-sources" class="view-section">
                <div id="sources-container"></div>
            </div>

            <!-- VIEW 3: DETAILS -->
            <div id="view-details" class="view-section">
                <div id="details-content" class="p-2">
                    <div class="flex flex-col items-center justify-center h-64 text-gray-500">
                        <div class="text-4xl mb-2">üé¨</div>
                        <div>Select a clip to view metadata</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Editor Modal -->
    <div id="editor-modal">
        <div class="flex justify-between items-center p-4 bg-black border-b border-white/10">
            <h2 class="text-sm font-bold text-gray-300 uppercase tracking-wider">Clip Editor</h2>
            <button onclick="editor.close()" class="text-white px-4 py-2 bg-green-600 hover:bg-green-500 rounded text-xs font-bold">DONE</button>
        </div>
        <div id="editor-player-container"><div id="editor-player"></div></div>
        <div class="editor-controls">
            <div class="flex justify-between items-end px-2">
                <div>
                    <div class="text-[10px] text-gray-500 uppercase">Current Time</div>
                    <div id="editor-time-display" class="font-mono text-2xl text-blue-400 font-bold">00:00</div>
                </div>
                <button onclick="editor.togglePlay()" class="w-12 h-12 bg-white text-black rounded-full flex items-center justify-center text-xl font-bold hover:scale-110 transition">‚ñ∂</button>
            </div>
            
            <div class="mt-4 px-2">
                <div class="flex justify-between text-xs text-gray-400 mb-2 font-mono">
                    <span id="label-in">IN: 0.0s</span><span id="label-out">OUT: 5.0s</span>
                </div>
                <div class="timeline-wrapper" id="timeline-track-area">
                    <div class="timeline-track"><div class="waveform-pattern"></div></div>
                    <div class="timeline-range" id="timeline-fill"></div>
                    <div class="playhead" id="editor-playhead"></div>
                    <div class="timeline-handle handle-l" id="handle-in"></div>
                    <div class="timeline-handle handle-r" id="handle-out"></div>
                </div>
                <div class="flex justify-between text-[10px] text-gray-600 mt-2 px-1 font-mono">
                    <span>00:00</span><span id="total-duration-label">00:00</span>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 mt-4 px-2">
                <button onclick="editor.duplicateClip()" class="bg-blue-900/30 text-blue-200 py-3 rounded border border-blue-500/30 hover:bg-blue-900/50 transition font-bold text-xs uppercase">üìÑ Duplicate Segment</button>
                <button onclick="editor.deleteClip()" class="bg-red-900/30 text-red-200 py-3 rounded border border-red-500/30 hover:bg-red-900/50 transition font-bold text-xs uppercase">üóë Remove Segment</button>
            </div>
            <div class="h-20"></div>
        </div>
    </div>

    <script>
        // --- 1. FULL DATA INTEGRATION (20+ LINKS) ---
        const VIDEO_DATABASE = [
            {
                id: '1bA6cTw1DJ4',
                title: "◊°◊®◊ò◊ï◊ü ◊ô◊ï◊ù ◊î◊ï◊ú◊ì◊™: ◊û◊ï◊ò◊ô ◊ú◊ô◊ë◊†◊î",
                brand: "Private / Birthday",
                concept: "Character Animation / Storytelling",
                editing_style: "After Effects Animation",
                tech_desc: "◊ì◊û◊ï◊ô◊ï◊™ ◊ï◊ï◊ß◊ò◊ï◊®◊ô◊ï◊™, ◊®◊ô◊í (Rigging) ◊ë◊°◊ô◊°◊ô, ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊ò◊ß◊°◊ò, ◊û◊¢◊ë◊®◊ô◊ù ◊í◊®◊§◊ô◊ô◊ù.",
                objects: ["◊ì◊û◊ï◊ô◊ï◊™ ◊û◊¶◊ï◊ô◊®◊ï◊™", "◊¢◊ï◊í◊î", "◊ë◊ú◊ï◊†◊ô◊ù", "◊ò◊ß◊°◊ò ◊ß◊ô◊†◊ò◊ô"],
                duration: 40
            },
            {
                id: 'T9vEvAcai_I',
                title: "◊ó◊ô◊™◊ï◊ö ◊ô◊®◊ï◊ß (Green Screen) ◊®◊ó◊§◊ü",
                brand: "VFX Demo",
                concept: "Compositing / Keying",
                editing_style: "Chroma Key / Tracking",
                tech_desc: "◊î◊°◊®◊™ ◊®◊ß◊¢ ◊ô◊®◊ï◊ß ◊û◊©◊ï◊ò ◊®◊ó◊§◊ü ◊ë◊™◊†◊ï◊¢◊î, ◊î◊™◊ê◊û◊™ ◊¶◊ë◊¢◊ô◊ù (Color Match), ◊î◊ï◊°◊§◊™ ◊î◊©◊™◊ß◊§◊ï◊ô◊ï◊™ ◊¢◊ú ◊î◊û◊ô◊ù.",
                objects: ["◊ô◊ù", "◊®◊ó◊§◊ü", "◊û◊°◊ö ◊ô◊®◊ï◊ß", "◊ë◊†◊ô◊ô◊†◊ô◊ù"],
                duration: 30
            },
            {
                id: 'p02kAntlIyY',
                title: "◊ß◊ú◊ô◊§ ◊û◊ô◊ú◊ô◊ù: ◊†◊ï◊¢◊ù ◊û◊ô◊õ◊ê◊ú",
                brand: "Noam Michael",
                concept: "Lyric Video / Performance",
                editing_style: "Kinetic Typography",
                tech_desc: "◊°◊†◊õ◊®◊ï◊ü ◊ò◊ß◊°◊ò ◊ú◊û◊ï◊ñ◊ô◊ß◊î, ◊©◊ô◊û◊ï◊© ◊ë◊û◊¶◊ú◊û◊î ◊ï◊ô◊®◊ò◊ï◊ê◊ú◊ô◊™ ◊ë-AE, ◊©◊ô◊ú◊ï◊ë ◊ò◊ß◊°◊ò ◊ë◊ó◊ú◊ú (3D Text Integration).",
                objects: ["◊ñ◊û◊®", "◊í◊ô◊ò◊®◊î", "◊ò◊ß◊°◊ò ◊®◊•", "◊®◊ß◊¢ ◊©◊ó◊ï◊®"],
                duration: 180
            },
            {
                id: 'zUmTkhqFhgw',
                title: "◊°◊®◊ò◊ï◊ü ◊î◊ì-◊°◊ò◊ê◊®◊ò: ◊í◊®◊ô◊†◊ò◊ô",
                brand: "GreenTea",
                concept: "Crowdfunding / Promo",
                editing_style: "Motion Graphics / Explainer",
                tech_desc: "◊©◊ô◊ú◊ï◊ë ◊ê◊ú◊û◊†◊ò◊ô◊ù ◊í◊®◊§◊ô◊ô◊ù ◊¢◊ú ◊ï◊ô◊ì◊ê◊ï (HUD), ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊ú◊ï◊í◊ï, ◊û◊¢◊ë◊®◊ô ◊©◊ß◊ï◊§◊ô◊ï◊™, ◊™◊ô◊ß◊ï◊†◊ô ◊¶◊ë◊¢.",
                objects: ["◊™◊î", "◊¶◊†◊¶◊†◊™", "◊õ◊ô◊™◊ï◊ë◊ô◊ù ◊¶◊§◊ô◊ù", "◊®◊ê◊ô◊ï◊†◊ï◊™"],
                duration: 120
            },
            {
                id: 'kjBkgAY7S2A',
                title: "◊ß◊ú◊ô◊§ ◊ê◊ô◊©◊ô: ◊ò◊û◊ô◊®◊î",
                brand: "Private",
                concept: "Family / Tribute",
                editing_style: "Montage / Slow Motion",
                tech_desc: "◊¢◊®◊ô◊õ◊™ ◊û◊ï◊†◊ò◊ê◊ñ' ◊®◊í◊©◊ô◊™, ◊©◊ô◊û◊ï◊© ◊ë-Speed Ramps, ◊ô◊ô◊¶◊ï◊ë ◊©◊ï◊ò◊ô◊ù (Stabilization).",
                objects: ["◊û◊©◊§◊ó◊î", "◊ê◊ô◊®◊ï◊¢", "◊®◊ô◊ß◊ï◊ì◊ô◊ù"],
                duration: 180
            },
            {
                id: 'HFvaEpiMwJU',
                title: "◊ß◊ú◊ô◊§ ◊ê◊ô◊©◊ô: ◊ê◊ë◊ô◊ë ◊ï◊ê◊ô◊ì◊î",
                brand: "Wedding / Private",
                concept: "Wedding Highlight",
                editing_style: "Cinematic / Color Grading",
                tech_desc: "◊™◊ô◊ß◊ï◊†◊ô ◊¶◊ë◊¢ (Grading), ◊ê◊§◊ß◊ò◊ô◊ù ◊©◊ú ◊ê◊ï◊® (Light Leaks), ◊û◊¢◊ë◊®◊ô◊ù ◊ó◊ú◊ß◊ô◊ù.",
                objects: ["◊ó◊™◊ü ◊ï◊õ◊ú◊î", "◊ó◊ï◊§◊î", "◊®◊ô◊ß◊ï◊ì◊ô◊ù"],
                duration: 180
            },
            {
                id: 'jCVjX_K0swc',
                title: "◊î◊†◊§◊©◊™ ◊û◊ï◊ì◊ú: ReLife",
                brand: "ReLife",
                concept: "3D Rendering / Product",
                editing_style: "3D Animation / Compositing",
                tech_desc: "◊®◊ô◊†◊ì◊ï◊® ◊û◊ï◊ì◊ú ◊™◊ú◊™-◊û◊û◊ì◊ô, ◊î◊¶◊í◊™ ◊û◊ï◊¶◊® ◊ë-360, ◊õ◊ô◊™◊ï◊ë◊ô ◊î◊°◊ë◊® (Callouts) ◊¢◊ï◊ß◊ë◊ô◊ù.",
                objects: ["◊û◊ï◊ì◊ú ◊®◊§◊ï◊ê◊ô", "◊°◊ë◊ô◊ë◊î ◊†◊ß◊ô◊ô◊î", "◊ò◊ß◊°◊ò ◊¶◊£"],
                duration: 60
            },
            {
                id: 'Bw3X4phfpmI',
                title: "◊†◊ï◊¢◊ù ◊û◊ô◊õ◊ê◊ú: ◊î◊ï◊§◊¢◊î ◊ó◊ô◊î",
                brand: "Noam Michael",
                concept: "Live Performance",
                editing_style: "Multicam Editing",
                tech_desc: "◊¢◊®◊ô◊õ◊™ ◊û◊ï◊ú◊ò◊ô-◊ß◊ê◊ù (4 ◊û◊¶◊ú◊û◊ï◊™), ◊°◊†◊õ◊®◊ï◊ü ◊°◊ê◊ï◊†◊ì ◊ó◊ô◊¶◊ï◊†◊ô, ◊™◊ô◊ß◊ï◊†◊ô ◊¶◊ë◊¢ ◊ú◊™◊ê◊ï◊®◊™ ◊ë◊û◊î.",
                objects: ["◊ë◊û◊î", "◊™◊ê◊ï◊®◊î ◊õ◊ó◊ï◊ú◊î", "◊ß◊î◊ú", "◊ú◊î◊ß◊î"],
                duration: 240
            },
            {
                id: 'Y76qS937PvU',
                title: "◊ß◊®◊ß◊° ◊î◊ó◊ô◊ï◊õ◊ô◊ù: ◊®◊ó◊©◊ô ◊ú◊ë",
                brand: "Rachashei Lev",
                concept: "Event / Charity",
                editing_style: "Documentary / Fast Paced",
                tech_desc: "◊¢◊®◊ô◊õ◊î ◊ß◊¶◊ë◊ô◊™ ◊ú◊û◊ï◊ñ◊ô◊ß◊î, ◊©◊ô◊ú◊ï◊ë ◊®◊ê◊ô◊ï◊†◊ï◊™ ◊¢◊ù B-Roll, ◊í◊®◊§◊ô◊ß◊î ◊™◊ó◊™◊ï◊†◊î (Lower Thirds).",
                objects: ["◊ú◊ô◊¶◊†◊ô◊ù", "◊ô◊ú◊ì◊ô◊ù", "◊ë◊ô◊™ ◊ó◊ï◊ú◊ô◊ù", "◊ë◊ú◊ï◊†◊ô◊ù"],
                duration: 150
            },
            {
                id: 'daumEVQ1yms',
                title: "◊¶'◊ê◊®◊ú◊ô ◊¶'◊ê◊§◊ú◊ô◊ü ◊ë◊©◊ô◊ë\"◊ê",
                brand: "Sheba Hospital",
                concept: "Silent Film Style / Comedy",
                editing_style: "Old Film Look",
                tech_desc: "◊ê◊§◊ß◊ò ◊°◊®◊ò ◊ô◊©◊ü (Old Film Grain), ◊©◊ô◊†◊ï◊ô ◊§◊®◊ô◊ô◊û◊®◊ô◊ô◊ò (Posterize Time), ◊õ◊®◊ò◊ô◊°◊ô◊ï◊™ ◊ò◊ß◊°◊ò ◊©◊ó◊ï◊®-◊ú◊ë◊ü.",
                objects: ["◊¶'◊ê◊®◊ú◊ô ◊¶'◊ê◊§◊ú◊ô◊ü", "◊®◊ï◊§◊ê◊ô◊ù", "◊û◊°◊ì◊®◊ï◊ü ◊ë◊ô◊™ ◊ó◊ï◊ú◊ô◊ù"],
                duration: 120
            },
            {
                id: 'WQya6tnGBQk',
                title: "◊ñ◊ï◊î◊® ◊¢◊ô◊ú◊ù: ◊û◊§◊¢◊ô◊ú ◊ê◊ô◊®◊ï◊¢◊ô◊ù",
                brand: "Zohar Eilam",
                concept: "Promo / Showreel",
                editing_style: "Dynamic / Sizzle",
                tech_desc: "◊ó◊ô◊™◊ï◊õ◊ô◊ù ◊û◊î◊ô◊®◊ô◊ù (Jump Cuts), ◊°◊†◊õ◊®◊ï◊ü ◊ú◊ë◊ô◊ò◊ô◊ù, ◊ê◊§◊ß◊ò◊ô◊ù ◊©◊ú ◊°◊ê◊ï◊†◊ì (SFX).",
                objects: ["◊û◊°◊ô◊ë◊î", "◊û◊ô◊ß◊®◊ï◊§◊ï◊ü", "◊ô◊ú◊ì◊ô◊ù ◊®◊ï◊ß◊ì◊ô◊ù"],
                duration: 90
            },
            {
                id: '_rv2sMdyCpg',
                title: "RedBull Remake (◊û◊ß◊ï◊ù ◊®◊ê◊©◊ï◊ü)",
                brand: "RedBull Contest",
                concept: "Stop Motion / Creative",
                editing_style: "VFX / Stop Motion",
                tech_desc: "◊©◊ô◊ú◊ï◊ë ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊°◊ò◊ï◊§-◊û◊ï◊©◊ü ◊¢◊ù ◊ï◊ô◊ì◊ê◊ï ◊ó◊ô, ◊ê◊§◊ß◊ò◊ô◊ù ◊û◊¶◊ï◊ô◊®◊ô◊ù (Scribble Effect), ◊ß◊ï◊û◊§◊ï◊ñ◊ô◊ò◊ô◊†◊í.",
                objects: ["◊§◊ó◊ô◊™ ◊®◊ì◊ë◊ï◊ú", "◊ì◊û◊ï◊ô◊ï◊™", "◊®◊ß◊¢ ◊û◊¶◊ï◊ô◊®"],
                duration: 60
            },
            {
                id: 'mBKxCEEzdn4',
                title: "◊î◊ñ◊û◊†◊î ◊ú◊ô◊ï◊ù ◊î◊ï◊ú◊ì◊™: ◊†◊ò◊ô ◊í◊ô◊ê",
                brand: "Private",
                concept: "Invitation / Fun",
                editing_style: "Green Screen / Compositing",
                tech_desc: "◊î◊©◊™◊ú◊™ ◊î◊ì◊û◊ï◊™ ◊ë◊®◊ß◊¢◊ô◊ù ◊©◊ï◊†◊ô◊ù, ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊ò◊ß◊°◊ò ◊ë◊°◊ô◊°◊ô◊™.",
                objects: ["◊ì◊û◊ï◊™", "◊®◊ß◊¢◊ô◊ù ◊û◊™◊ó◊ú◊§◊ô◊ù", "◊ò◊ß◊°◊ò ◊î◊ñ◊û◊†◊î"],
                duration: 60
            },
            {
                id: 'Ra7ntt3M61E',
                title: "◊ô◊ú◊ì◊ô◊ù ◊ë◊°◊ô◊õ◊ï◊ô: ◊ê◊ô◊®◊ï◊¢ ◊©◊†◊™◊ô",
                brand: "Yeladim BeSikuy",
                concept: "Event Coverage",
                editing_style: "Corporate / Highlight",
                tech_desc: "◊°◊ô◊õ◊ï◊ù ◊ê◊ô◊®◊ï◊¢, ◊©◊ô◊ú◊ï◊ë ◊†◊ê◊ï◊û◊ô◊ù ◊¢◊ù ◊û◊ï◊ñ◊ô◊ß◊™ ◊®◊ß◊¢, ◊¢◊®◊ô◊õ◊î ◊ú◊ô◊†◊ô◊ê◊®◊ô◊™.",
                objects: ["◊†◊ê◊ï◊û◊ô◊ù", "◊ß◊î◊ú", "◊õ◊ô◊ë◊ï◊ì", "◊ú◊ï◊í◊ï ◊î◊¢◊û◊ï◊™◊î"],
                duration: 180
            },
            {
                id: 'fL0Ww1tt8EI',
                title: "◊©◊ï◊ê◊ï◊®◊ô◊ú 2014",
                brand: "Portfolio",
                concept: "Showreel",
                editing_style: "Fast Cut / Montage",
                tech_desc: "◊°◊ô◊õ◊ï◊ù ◊¢◊ë◊ï◊ì◊ï◊™, ◊î◊™◊ê◊û◊™ ◊ß◊¶◊ë (Pacing), ◊û◊¢◊ë◊®◊ô◊ù ◊ô◊¶◊ô◊®◊™◊ô◊ô◊ù.",
                objects: ["◊ê◊ï◊°◊£ ◊ß◊ò◊¢◊ô◊ù", "◊ú◊ï◊í◊ï ◊§◊™◊ô◊ó◊î", "◊ú◊ï◊í◊ï ◊°◊ô◊ï◊ù"],
                duration: 90
            },
            {
                id: 'aydTo0aZRtA',
                title: "◊¶◊ô◊ú◊ï◊ù ◊®◊ó◊§◊ü + ◊™◊†◊ï◊¢◊î ◊ë◊§◊ï◊°◊ò",
                brand: "VFX Test",
                concept: "Camera Tracking",
                editing_style: "3D Tracking",
                tech_desc: "◊ë◊ô◊¶◊ï◊¢ 3D Camera Tracker ◊ë-AE, ◊©◊™◊ô◊ú◊™ ◊ò◊ß◊°◊ò ◊™◊ú◊™-◊û◊û◊ì◊ô ◊ë◊ó◊ú◊ú ◊î◊ê◊ï◊ï◊ô◊®◊ô, ◊î◊¶◊û◊ì◊î ◊ú◊ß◊®◊ß◊¢.",
                objects: ["◊®◊ó◊§◊ü", "◊†◊ï◊£ ◊ê◊ï◊®◊ë◊†◊ô", "◊ò◊ß◊°◊ò ◊¶◊£"],
                duration: 30
            },
            {
                id: 'J1fY6H1cj3A',
                title: "◊î◊ó◊ú◊§◊™ ◊©◊ô◊ú◊ï◊ò ◊ì◊®◊ö ◊®◊ê◊©◊ô◊™",
                brand: "VFX Test",
                concept: "Planar Tracking / Mocha",
                editing_style: "Compositing / Rotoscoping",
                tech_desc: "◊©◊ô◊û◊ï◊© ◊ë-Mocha ◊ú◊û◊¢◊ß◊ë ◊û◊©◊ò◊ó◊ô (Planar Track), ◊î◊ó◊ú◊§◊™ ◊™◊ï◊õ◊ü ◊©◊ú ◊©◊ú◊ò, ◊î◊™◊ê◊û◊™ ◊ò◊©◊ò◊ï◊© ◊™◊†◊ï◊¢◊î (Motion Blur).",
                objects: ["◊õ◊ë◊ô◊© ◊û◊î◊ô◊®", "◊©◊ú◊ò ◊ó◊ï◊¶◊ï◊™", "◊û◊õ◊ï◊†◊ô◊ï◊™"],
                duration: 15
            },
            {
                id: 'WSL1iYAyj4I',
                title: "◊î◊†◊§◊©◊™ ◊¢◊ò◊ô◊§◊î: ◊í◊ë◊®◊ô◊ê◊ú",
                brand: "Gabriel",
                concept: "Album Art Animation",
                editing_style: "Parallax Effect",
                tech_desc: "◊ó◊ô◊™◊ï◊ö ◊©◊õ◊ë◊ï◊™ ◊ë◊§◊ï◊ò◊ï◊©◊ï◊§, ◊ô◊¶◊ô◊®◊™ ◊¢◊ï◊û◊ß (Parallax) ◊ë-AE, ◊î◊ï◊°◊§◊™ ◊ó◊ú◊ß◊ô◊ß◊ô◊ù (Particles).",
                objects: ["◊¢◊ò◊ô◊§◊™ ◊ê◊ú◊ë◊ï◊ù", "◊ì◊û◊ï◊™", "◊¢◊©◊ü/◊¢◊®◊§◊ú"],
                duration: 20
            },
            {
                id: 'NT_4d8sSdls',
                title: "◊î◊†◊§◊©◊™ ◊¢◊ò◊ô◊§◊î: ◊ê◊°◊£ ◊ê◊ï◊®",
                brand: "Asaf Or",
                concept: "Album Art Animation",
                editing_style: "Puppet Tool",
                tech_desc: "◊©◊ô◊û◊ï◊© ◊ë-Puppet Tool ◊ú◊î◊ñ◊ñ◊™ ◊ì◊û◊ï◊ô◊ï◊™ ◊°◊ò◊ò◊ô◊ï◊™, ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊ú◊ï◊§.",
                objects: ["◊¶◊ô◊ï◊®", "◊ì◊û◊ï◊™ ◊û◊†◊í◊†◊™", "◊®◊ß◊¢ ◊ñ◊ñ"],
                duration: 20
            },
            {
                id: 'LvdGbCkZAiY',
                title: "◊ê◊†◊ô ◊ë◊ú ◊ú◊ô - ◊ß◊ú◊ô◊§ ◊®◊©◊û◊ô",
                brand: "Bal Li",
                concept: "Music Video / AI Art",
                editing_style: "AI Animation / Hybrid",
                tech_desc: "◊©◊ô◊ú◊ï◊ë ◊ï◊ô◊ì◊ê◊ï ◊¢◊ù ◊ê◊†◊ô◊û◊¶◊ô◊ï◊™ AI (Stable Diffusion/Kaiber), ◊û◊¢◊ë◊®◊ô◊ù ◊î◊ñ◊ô◊ô◊™◊ô◊ô◊ù, ◊ê◊§◊ß◊ò◊ô◊ù ◊©◊ú ◊ñ◊ï◊î◊®.",
                objects: ["◊ñ◊û◊®◊™", "◊ê◊†◊ô◊û◊¶◊ô◊î ◊¶◊ë◊¢◊ï◊†◊ô◊™", "◊ì◊û◊ï◊ô◊ï◊™ ◊û◊™◊ó◊ú◊§◊ï◊™"],
                duration: 190
            }
        ];

        // --- APP LOGIC ---
        class LoopApp {
            constructor() {
                this.playlist = this.loadPlaylist();
                this.currentIndex = 0;
                this.isPlaying = false;
                this.activePlayer = 1;
                this.isMuted = true;
                this.monitorInterval = null;
                this.fadeInterval = null;
                this.nextLoaded = false;
                this.currentTab = 'sequence';
                this.searchQuery = '';
            }

            loadPlaylist() {
                const saved = localStorage.getItem('orionMixV9');
                if (saved) { try { return JSON.parse(saved); } catch(e) {} }
                return this.createAutoPlaylist();
            }

            createAutoPlaylist() {
                let list = [];
                // 3. FULL COVERAGE ALGORITHM:
                // Loop through EVERY video in the DB, slicing it into chunks so we see everything.
                VIDEO_DATABASE.forEach(video => {
                    const step = 6; // 6 seconds per clip
                    const overlap = 0.5; // slight overlap logic if needed, here simple steps
                    
                    // Create segments covering the full duration
                    for (let t = 0; t < (video.duration - 2); t += step) {
                        list.push({
                            uuid: crypto.randomUUID(),
                            videoId: video.id,
                            title: video.title,
                            brand: video.brand,
                            tech_desc: video.tech_desc,
                            start: t,
                            duration: 5, // 5s play time
                            totalDuration: video.duration
                        });
                    }
                });
                // 4. SHUFFLE ON INIT
                return list.sort(() => Math.random() - 0.5);
            }

            save() { localStorage.setItem('orionMixV9', JSON.stringify(this.playlist)); }

            toggleUI() {
                document.getElementById('ui-layer').classList.toggle('hidden-ui');
                this.renderUI();
            }

            handleSearch(val) {
                this.searchQuery = val.toLowerCase();
                if(this.currentTab === 'sources') this.renderSources();
            }

            switchTab(tab) {
                this.currentTab = tab;
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
                
                const idx = tab === 'sequence' ? 0 : tab === 'sources' ? 1 : 2;
                document.querySelectorAll('.tab-btn')[idx].classList.add('active');
                document.getElementById(`view-${tab}`).classList.add('active');
                
                this.renderUI();
            }

            openDetailsTab() {
                if(!this.isPlaying) return;
                const clip = this.playlist[this.currentIndex];
                const data = VIDEO_DATABASE.find(v => v.id === clip.videoId);
                
                // Open UI if closed
                const ui = document.getElementById('ui-layer');
                if(ui.classList.contains('hidden-ui')) ui.classList.remove('hidden-ui');
                
                this.switchTab('details');
                this.renderDetails(data, clip);
            }

            renderUI() {
                if (this.currentTab === 'sequence') this.renderSequence();
                else if (this.currentTab === 'sources') this.renderSources();
                else if (this.currentTab === 'details') {
                    const clip = this.playlist[this.currentIndex];
                    if(clip) {
                        const data = VIDEO_DATABASE.find(v => v.id === clip.videoId);
                        this.renderDetails(data, clip);
                    }
                }
            }

            renderDetails(data, clip) {
                if(!data) return;
                const container = document.getElementById('details-content');
                
                let tagsHtml = `<div class="tag brand">${data.brand}</div>`;
                data.objects.forEach(o => tagsHtml += `<div class="tag">${o}</div>`);
                if(data.editing_style) tagsHtml += `<div class="tag" style="border-color:#3b82f6; color:#60a5fa">${data.editing_style}</div>`;

                container.innerHTML = `
                    <div class="details-header">
                        <div class="details-title">${data.title}</div>
                        <div class="details-subtitle">${data.concept}</div>
                    </div>

                    <div class="tech-box">
                        <div class="tech-label">Technical Breakdown (After Effects / Editing)</div>
                        <div class="tech-content">${data.tech_desc}</div>
                    </div>

                    <div class="mb-6">
                        <div class="tech-label mb-2">Metadata Tags</div>
                        <div class="tag-cloud">${tagsHtml}</div>
                    </div>
                    
                    <div style="margin-top:40px; text-align:center; opacity:0.3; font-size:0.8rem;">
                        ID: ${data.id} ‚Ä¢ DUR: ${data.duration}s
                    </div>
                `;
            }

            renderSequence() {
                const container = document.getElementById('playlist-container');
                container.innerHTML = '';
                // Limit rendering for performance if list is huge (it is now)
                // We render a window around current index
                const windowSize = 50;
                let startIdx = Math.max(0, this.currentIndex - 10);
                let endIdx = Math.min(this.playlist.length, startIdx + windowSize);
                
                // Add spacer if needed
                if(startIdx > 0) container.innerHTML += `<div style="height:20px; text-align:center; color:#333;">... ${startIdx} previous clips ...</div>`;

                for (let i = startIdx; i < endIdx; i++) {
                    const clip = this.playlist[i];
                    const isActive = i === this.currentIndex;
                    const total = clip.totalDuration || 100;
                    const leftP = (clip.start / total) * 100;
                    const widthP = (clip.duration / total) * 100;
                    
                    const el = document.createElement('div');
                    el.className = `clip-card ${isActive ? 'playing' : ''}`;
                    el.onclick = (e) => { if(!e.target.closest('.btn-icon')) editor.open(i); };
                    el.innerHTML = `
                        <div class="text-gray-600 text-[10px] font-mono w-6 text-center">#${i+1}</div>
                        <div class="clip-info">
                            <div class="clip-title">${clip.title}</div>
                            <div class="clip-tech">${clip.tech_desc ? clip.tech_desc.substring(0, 50) + '...' : ''}</div>
                            <div class="mini-timeline-bg"><div class="mini-timeline-fill"></div><div class="mini-range" style="left:${leftP}%; width:${widthP}%"></div></div>
                        </div>
                        <button class="btn-icon" onclick="editor.open(${i})">‚úèÔ∏è</button>
                    `;
                    container.appendChild(el);
                }
                
                if(endIdx < this.playlist.length) container.innerHTML += `<div style="height:20px; text-align:center; color:#333;">... ${this.playlist.length - endIdx} more ...</div>`;
            }

            renderSources() {
                const container = document.getElementById('sources-container');
                container.innerHTML = '';
                
                const filteredDB = VIDEO_DATABASE.filter(v => {
                    const q = this.searchQuery;
                    if(!q) return true;
                    const text = (v.title + v.brand + v.concept + v.tech_desc + v.objects.join(' ')).toLowerCase();
                    return text.includes(q);
                });

                filteredDB.forEach(data => {
                    const groupEl = document.createElement('div');
                    groupEl.className = 'source-group';
                    const clipsInPlaylist = this.playlist.filter(p => p.videoId === data.id);
                    
                    groupEl.innerHTML = `
                        <div class="source-header">
                            <div>
                                <div class="source-title">${data.title}</div>
                                <div class="source-sub">${data.editing_style}</div>
                            </div>
                            <div class="source-actions">
                                <button onclick="app.addClipToSource('${data.id}')">+ ADD SEGMENT</button>
                            </div>
                        </div>
                        <div class="p-2 text-xs text-gray-500 bg-black/40 border-t border-white/5">
                            ${clipsInPlaylist.length} instances in sequence ‚Ä¢ ${data.duration}s total source
                        </div>
                    `;
                    container.appendChild(groupEl);
                });
            }

            addClipToSource(vidId) {
                const data = VIDEO_DATABASE.find(v => v.id === vidId);
                const newClip = {
                    uuid: crypto.randomUUID(), videoId: vidId, title: data.title, brand: data.brand,
                    tech_desc: data.tech_desc, start: 0, duration: 5, totalDuration: data.duration
                };
                this.playlist.push(newClip);
                this.save();
                alert("Clip added to end of sequence");
            }

            regeneratePlaylist() {
                if(confirm('◊ú◊¢◊®◊ë◊ë ◊û◊ó◊ì◊© ◊ê◊™ ◊õ◊ú ◊î◊ß◊ò◊¢◊ô◊ù? (◊§◊¢◊ï◊ú◊î ◊ñ◊ï ◊™◊ê◊§◊° ◊ê◊™ ◊î◊®◊©◊ô◊û◊î)')) {
                    this.playlist = this.createAutoPlaylist();
                    this.currentIndex = 0;
                    this.save();
                    this.renderUI();
                }
            }

            // --- Playback Engine ---
            startEngine() {
                this.isPlaying = true;
                this.playSequence(this.currentIndex);
                this.renderUI();
            }

            playSequence(index) {
                if (!this.isPlaying) return;
                if (index >= this.playlist.length) index


