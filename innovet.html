<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Innovet Cohort 2 - Program Schedule</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Heebo', sans-serif;
            background-color: #F1F1F1;
            color: #191B1D;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
            width: 100%;
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            height: 8px;
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #F1F1F1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #C1C1C1;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #A8A8A8;
        }

        /* Hide scrollbar for clean tab navigation */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Draggable Cursor Classes */
        .cursor-grab { cursor: grab; }
        .cursor-grabbing { cursor: grabbing; }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin-slow {
            animation: spin-slow 60s linear infinite;
        }

        /* Dropdown Hover Logic */
        .group:hover .group-hover\:block {
            display: block;
        }
        
        /* Black Filter for Icon */
        .icon-black {
            filter: grayscale(100%) brightness(0);
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Heebo', 'sans-serif'],
                    },
                    colors: {
                        innovet: {
                            black: '#191B1D',
                            dark: '#17191A', 
                            yellow: '#FFC700',
                            blue: '#1F63C7',
                            bg: '#F1F1F1',
                            gray: '#E3E3E3'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="antialiased flex flex-col min-h-screen relative w-full overflow-x-hidden">
    
    <!-- Static Background Image -->
    <div class="fixed inset-0 z-0 flex items-center justify-center pointer-events-none overflow-hidden">
        <img src="./INNOVET_ICON-05linear-1.webp" alt="" class="w-[120vw] max-w-none opacity-5 grayscale" />
    </div>

    <div id="root" class="flex flex-col min-h-screen z-10 relative w-full"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURATION ---
        const GOOGLE_API_KEY = 'AIzaSyCmnriYz5_rQfTNk8YmyvW0wfQN_96LJ6A'; 
        const SPREADSHEET_ID = '1RMatyMjsFM35grZTRSoslKN04cTdUy7km4I8clyVil4'; 

        // --- HOOKS ---
        
        // Custom Hook for Drag-to-Scroll (Desktop Only)
        // Allows dragging unless on text/interactive elements
        const useDraggableScroll = (ref) => {
            useEffect(() => {
                const el = ref.current;
                if (!el) return;

                let isDown = false;
                let startX;
                let scrollLeft;

                const onMouseDown = (e) => {
                    // Only allow left click
                    if (e.button !== 0) return;

                    // Check if user is clicking on text directly or interactive elements
                    const target = e.target;
                    const tagName = target.tagName;
                    
                    // If interactive element, ignore
                    if (['A', 'BUTTON', 'INPUT', 'TEXTAREA', 'SELECT'].includes(tagName)) return;

                    // If cursor is 'text', likely over text user wants to select -> ignore drag
                    const computedCursor = window.getComputedStyle(target).cursor;
                    if (computedCursor === 'text') return;

                    isDown = true;
                    el.classList.add('cursor-grabbing');
                    el.classList.remove('cursor-grab');
                    startX = e.pageX - el.offsetLeft;
                    scrollLeft = el.scrollLeft;
                };

                const onMouseLeave = () => {
                    isDown = false;
                    el.classList.remove('cursor-grabbing');
                    el.classList.add('cursor-grab');
                };

                const onMouseUp = () => {
                    isDown = false;
                    el.classList.remove('cursor-grabbing');
                    el.classList.add('cursor-grab');
                };

                const onMouseMove = (e) => {
                    if (!isDown) return;
                    e.preventDefault(); // Prevent selection dragging while we scroll
                    const x = e.pageX - el.offsetLeft;
                    const walk = (x - startX) * 1.5; // Scroll speed multiplier
                    el.scrollLeft = scrollLeft - walk;
                };

                // Add initial class
                el.classList.add('cursor-grab');

                // Mouse events only (Touch handled natively by CSS overflow)
                el.addEventListener('mousedown', onMouseDown);
                el.addEventListener('mouseleave', onMouseLeave);
                el.addEventListener('mouseup', onMouseUp);
                el.addEventListener('mousemove', onMouseMove);

                return () => {
                    el.removeEventListener('mousedown', onMouseDown);
                    el.removeEventListener('mouseleave', onMouseLeave);
                    el.removeEventListener('mouseup', onMouseUp);
                    el.removeEventListener('mousemove', onMouseMove);
                };
            }, [ref]);
        };

        // --- Lucide-style Icons Components (Recreated as SVGs) ---
        const Layout = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="3" x2="21" y1="9" y2="9"/><line x1="9" x2="9" y1="21" y2="9"/></svg>
        );
        const Target = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
        );
        const Calendar = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
        );
        const Clock = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        );
        const CheckSquare = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
        );
        const Users = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        );
        const Menu = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
        );
        const X = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        );
        const ArrowLeft = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
        );
        const ArrowRight = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        );
        const Star = ({size=24, className, strokeWidth=2}) => (
             <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" /></svg>
        );
        const Download = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
        );
        const ChevronDown = ({size=24, className, strokeWidth=2}) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="6 9 12 15 18 9"></polyline></svg>
        );

        // --- Translations & Constants ---
        const UI_TEXT = {
            he: {
                home: 'בית',
                program: 'התוכנית',
                schedule: 'לו"ז ומטלות',
                contact: 'צור קשר',
                privacy: 'מדיניות פרטיות',
                heroTitle: 'תוכנית',
                heroTitle2: 'העבודה',
                heroSubtitle: 'Program Schedule & Resources',
                heroDesc: 'מבט כולל על 19 שבועות של יזמות, משלב הרעיון ועד ל-Demo Day. השתמשו בכלי ה-AI המומלצים בכל שלב.',
                tabAgenda: 'מטריצת התוכנית',
                tabDeliverables: 'תוצרים ומטלות',
                tabOfficeHours: 'מומחים וסדנאות',
                tabCalendar: 'לוח אירועים',
                sectionJourney: 'מסע היזם (The Journey)',
                sectionStudent: 'חובות הסטודנט',
                sectionExperts: 'מפגשי מומחים',
                sectionEvents: 'אירועי מפתח',
                week: 'שבוע',
                category: 'קטגוריה',
                phase: 'שלב בתוכנית',
                subject: 'נושא שבועי',
                tools: 'AI Tools',
                milestones: 'אבני דרך',
                task: 'מטלה / תוצר',
                details: 'פירוט',
                status: 'סטטוס',
                download: 'הורד הנחיות',
                upcoming: 'Upcoming',
                book: 'שריין מקום',
                with: 'עם',
                rights: '© 2025 כל הזכויות שמורות',
                builtBy: 'נבנה ע"י PsychoFlash',
                phases: {
                    ideation: "שלב האידאציה (Ideation)",
                    accelerator: "אקסלרטור (Accelerator)",
                    launch: "השקה (Launch)"
                }
            },
            en: {
                home: 'Home',
                program: 'Program',
                schedule: 'Schedule & Tasks',
                contact: 'Contact',
                privacy: 'Privacy Policy',
                heroTitle: 'WORK',
                heroTitle2: 'PLAN',
                heroSubtitle: 'Program Schedule & Resources',
                heroDesc: 'A comprehensive view of 19 weeks of entrepreneurship, from Ideation to Demo Day. Use the recommended AI tools at each stage.',
                tabAgenda: 'Program Matrix',
                tabDeliverables: 'Deliverables',
                tabOfficeHours: 'Experts & Workshops',
                tabCalendar: 'Events Calendar',
                sectionJourney: 'The Journey',
                sectionStudent: 'Student Deliverables',
                sectionExperts: 'Expert Sessions',
                sectionEvents: 'Key Events',
                week: 'WEEK',
                category: 'Category',
                phase: 'Phase',
                subject: 'Weekly Subject',
                tools: 'AI Tools',
                milestones: 'Milestones',
                task: 'Task / Deliverable',
                details: 'Details',
                status: 'Status',
                download: 'Download Guide',
                upcoming: 'Upcoming',
                book: 'Book Slot',
                with: 'With',
                rights: '© 2025 All Rights Reserved',
                builtBy: 'Built by PsychoFlash',
                phases: {
                    ideation: "Ideation Phase",
                    accelerator: "Accelerator Phase",
                    launch: "Launch Phase"
                }
            }
        };

        // --- Main App Component ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('agenda');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [lang, setLang] = useState('he'); // 'he' or 'en'
            const [loading, setLoading] = useState(false);
            
            // Data States
            const [agendaData, setAgendaData] = useState([]);
            const [deliverablesData, setDeliverablesData] = useState([]);
            const [officeHoursData, setOfficeHoursData] = useState([]);
            const [calendarHighlights, setCalendarHighlights] = useState([]);

            const mainContentRef = useRef(null);
            
            // Refs for Draggable Tables
            const agendaRef = useRef(null);
            const deliverablesRef = useRef(null);

            // Apply Drag Hook
            useDraggableScroll(agendaRef);
            useDraggableScroll(deliverablesRef);

            const toggleMobileMenu = () => setIsMobileMenuOpen(!isMobileMenuOpen);
            const toggleLang = () => setLang(lang === 'he' ? 'en' : 'he');

            const t = UI_TEXT[lang];
            const isRTL = lang === 'he';
            const ArrowIcon = isRTL ? ArrowLeft : ArrowRight;

            // Scroll Handling
            const scrollToTop = () => window.scrollTo({ top: 0, behavior: 'smooth' });
            const scrollToContent = () => {
                if (mainContentRef.current) {
                    mainContentRef.current.scrollIntoView({ behavior: 'smooth' });
                }
            };
            
            const handleNavClick = (tabId) => {
                setActiveTab(tabId);
                scrollToContent();
                setIsMobileMenuOpen(false);
            };

            // Update document dir
            useEffect(() => {
                document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
                document.documentElement.lang = lang;
            }, [lang, isRTL]);


            // --- DATA FETCHING LOGIC ---

            const fetchSheetData = async (sheetName) => {
                if (!GOOGLE_API_KEY || !SPREADSHEET_ID) return null;
                const encodedName = encodeURIComponent(sheetName);
                try {
                    const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${encodedName}?key=${GOOGLE_API_KEY}`);
                    const data = await response.json();
                    if (data.error) {
                         console.error(`Error from Google Sheets API for ${sheetName}:`, data.error);
                         return null;
                    }
                    return data.values;
                } catch (error) {
                    console.error(`Error fetching ${sheetName}:`, error);
                    return null;
                }
            };

            // Helper to Transpose Data
            const transpose = (matrix) => {
                if (!matrix || matrix.length === 0) return [];
                return matrix[0].map((_, colIndex) => matrix.map(row => row[colIndex]));
            };

            // Initialize Data
            useEffect(() => {
                const loadData = async () => {
                    // 1. Load Default Data First
                    initDefaultData();

                    // 2. Fetch from Google Sheets
                    if (GOOGLE_API_KEY && SPREADSHEET_ID) {
                        setLoading(true);
                        try {
                            const SHEET_NAMES = {
                                agendaEn: 'Agenda ',
                                agendaHe: 'Agenda_he',
                                delivEn: 'Deliverabels',
                                delivHe: 'Deliverabels_he',
                                officeEn: 'Office Hours',
                                officeHe: 'Office Hours_he',
                                calEn: 'Calendar',
                                calHe: 'Calendar_he'
                            };

                            // --- Step A: Agenda (Transposed) ---
                            const agendaEnRaw = await fetchSheetData(SHEET_NAMES.agendaEn);
                            const agendaHeRaw = await fetchSheetData(SHEET_NAMES.agendaHe);
                            
                            if (agendaEnRaw && agendaHeRaw) {
                                // Normalize and Transpose
                                const normalize = (data) => {
                                     const maxLen = Math.max(...data.map(r => r.length));
                                     return data.map(r => {
                                         const newR = [...r];
                                         while (newR.length < maxLen) newR.push("");
                                         return newR;
                                     });
                                };
                                
                                const agendaEnT = transpose(normalize(agendaEnRaw));
                                const agendaHeT = transpose(normalize(agendaHeRaw));

                                const mergedAgenda = [];
                                const maxRows = Math.max(agendaEnT.length, agendaHeT.length);
                                
                                for (let i = 1; i < maxRows; i++) {
                                    const rowEn = agendaEnT[i] || [];
                                    const rowHe = agendaHeT[i] || [];
                                    
                                    if (!rowEn[2] && !rowHe[2]) continue;

                                    mergedAgenda.push({
                                        week: i, 
                                        phase_en: rowEn[1] || "",
                                        phase_he: rowHe[1] || "",
                                        subject_en: rowEn[2] || "",
                                        subject_he: rowHe[2] || "",
                                        tools: (rowEn[4] || rowHe[4]) ? (rowEn[4] || rowHe[4]).split('\n').map(s => s.trim()).filter(s => s) : [],
                                        milestone: rowEn[5] || rowHe[5] || "" 
                                    });
                                }
                                if (mergedAgenda.length > 0) setAgendaData(mergedAgenda);
                            }

                            // --- Step B: Deliverables ---
                            const delivEnRaw = await fetchSheetData(SHEET_NAMES.delivEn);
                            const delivHeRaw = await fetchSheetData(SHEET_NAMES.delivHe);

                            if (delivEnRaw && delivHeRaw) {
                                const mergedDeliv = [];
                                const maxRows = Math.max(delivEnRaw.length, delivHeRaw.length);
                                for (let i = 1; i < maxRows; i++) {
                                    const rowEn = delivEnRaw[i] || [];
                                    const rowHe = delivHeRaw[i] || [];
                                    
                                    if (!rowEn[0] && !rowHe[0]) continue;

                                    let link = rowEn[4] || rowHe[4] || "#";
                                    if (!link.startsWith("http")) {
                                         if (rowEn[5] && rowEn[5].startsWith("http")) link = rowEn[5];
                                         else if (rowHe[5] && rowHe[5].startsWith("http")) link = rowHe[5];
                                    }

                                    mergedDeliv.push({
                                        week: rowEn[1] || rowHe[1] || "", 
                                        task_en: rowEn[0] || "", 
                                        task_he: rowHe[0] || "",
                                        desc_en: rowEn[0] || "", 
                                        desc_he: rowHe[0] || "",
                                        link: link
                                    });
                                }
                                if (mergedDeliv.length > 0) setDeliverablesData(mergedDeliv);
                            }

                            // --- Step C: Office Hours ---
                            const officeEnRaw = await fetchSheetData(SHEET_NAMES.officeEn);
                            const officeHeRaw = await fetchSheetData(SHEET_NAMES.officeHe);

                            if (officeEnRaw && officeHeRaw) {
                                const mergedOffice = [];
                                const maxRows = Math.max(officeEnRaw.length, officeHeRaw.length);
                                for (let i = 1; i < maxRows; i++) {
                                    const rowEn = officeEnRaw[i] || [];
                                    const rowHe = officeHeRaw[i] || [];
                                    
                                    if (!rowEn[1] && !rowHe[1]) continue;

                                    mergedOffice.push({
                                        week: rowEn[6] || rowHe[6] || "", 
                                        topic_en: rowEn[1] || "", 
                                        topic_he: rowHe[1] || "",
                                        expert_en: rowEn[0] || "Expert", 
                                        expert_he: rowHe[0] || "מומחה",
                                        email: rowEn[5] || rowHe[5] || "" 
                                    });
                                }
                                if (mergedOffice.length > 0) setOfficeHoursData(mergedOffice);
                            }

                            // --- Step D: Calendar ---
                            const calEnRaw = await fetchSheetData(SHEET_NAMES.calEn);
                            const calHeRaw = await fetchSheetData(SHEET_NAMES.calHe);

                            if (calEnRaw && calHeRaw) {
                                const mergedCal = [];
                                
                                const parseCalendarGrid = (rows, isHebrew) => {
                                    let currentMonth = "";
                                    const events = [];
                                    
                                    const getVal = (r, c) => (rows[r] && rows[r][c]) ? rows[r][c].toString().trim() : "";

                                    for (let r = 0; r < rows.length; r++) {
                                        const row = rows[r];
                                        const rowStr = row.join(' ').trim();
                                        
                                        if (rowStr.includes('202') && (rowStr.length < 40)) {
                                            const monthMatch = rowStr.match(/([a-zA-Z\u0590-\u05FF]+)\s+202\d/);
                                            if (monthMatch) {
                                                currentMonth = monthMatch[0]; 
                                                continue;
                                            }
                                            
                                            if (rowStr.match(/\d{4}-\d{2}-\d{2}/)) {
                                                 const date = new Date(rowStr.match(/\d{4}-\d{2}-\d{2}/)[0]);
                                                 currentMonth = date.toLocaleString(isHebrew ? 'he-IL' : 'en-US', { month: 'long', year: 'numeric' });
                                                 continue;
                                            }
                                        }
                                        
                                        for (let c = 0; c < row.length; c++) {
                                            const cell = row[c];
                                            if (!cell) continue;
                                            
                                            const isDayNumber = !isNaN(parseInt(cell)) && cell.trim().length < 3;
                                            const isWeekday = /Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|ראשון|שני|שלישי|רביעי|חמישי|שישי|שבת/i.test(cell);
                                            
                                            if (!isDayNumber && !isWeekday && cell.length > 3) {
                                                let day = "";
                                                let time = "";
                                                
                                                const cellAbove = getVal(r-1, c);
                                                if (!isNaN(parseInt(cellAbove)) && cellAbove.length < 3) {
                                                    day = cellAbove;
                                                }
                                                
                                                const timeMatch = cell.match(/\d{1,2}:\d{2}/);
                                                time = timeMatch ? timeMatch[0] : "";

                                                if (day) {
                                                     events.push({
                                                         month: currentMonth || "TBD",
                                                         day: day,
                                                         event: cell,
                                                         time: time
                                                     });
                                                } else if (cell.toLowerCase().includes("kickoff") || cell.includes("פתיחה")) {
                                                     events.push({
                                                         month: currentMonth || "JAN",
                                                         day: "4", 
                                                         event: cell,
                                                         time: time
                                                     });
                                                }
                                            }
                                        }
                                    }
                                    return events;
                                };
                                
                                const enEvents = parseCalendarGrid(calEnRaw, false);
                                const heEvents = parseCalendarGrid(calHeRaw, true);
                                
                                const maxEv = Math.max(enEvents.length, heEvents.length);
                                for(let k=0; k<maxEv; k++) {
                                     const eEn = enEvents[k] || {};
                                     const eHe = heEvents[k] || {};
                                     
                                     let monthDisplay = "JAN";
                                     const rawMonth = eEn.month || eHe.month;
                                     if (rawMonth) {
                                         monthDisplay = rawMonth.split(' ')[0].substring(0,3).toUpperCase();
                                         if (/[א-ת]/.test(monthDisplay)) monthDisplay = "HOD"; 
                                     }

                                     mergedCal.push({
                                        date: `${eEn.day || eHe.day || "?"}`,
                                        month: rawMonth,
                                        event_en: eEn.event || "",
                                        event_he: eHe.event || "",
                                        time: eEn.time || eHe.time || "",
                                        details_en: eEn.event || "",
                                        details_he: eHe.event || ""
                                     });
                                }
                                
                                if (mergedCal.length > 0) setCalendarHighlights(mergedCal);
                            }

                        } catch (e) {
                            console.error("Error processing Google Sheets data:", e);
                        } finally {
                            setLoading(false);
                        }
                    }
                };

                loadData();
            }, []);

            // Fallback Data
            const initDefaultData = () => {
                 // Fallback placeholder
            };

            // ---------------- UI COMPONENTS ----------------

            const TabButton = ({ id, label, icon: Icon }) => (
                <button
                    onClick={() => handleNavClick(id)}
                    className={`relative px-4 md:px-8 py-5 text-base md:text-xl font-bold transition-all duration-200 uppercase tracking-tight border-b-4 flex-1 md:flex-none whitespace-nowrap ${
                        activeTab === id
                            ? 'bg-white text-black border-innovet-yellow'
                            : 'bg-transparent text-innovet-black border-transparent hover:text-innovet-blue hover:bg-white/50'
                    }`}
                >
                    <div className="flex items-center justify-center gap-3">
                        <Icon size={22} className={activeTab === id ? 'text-innovet-blue' : 'text-innovet-black opacity-50'} strokeWidth={2} />
                        {label}
                    </div>
                </button>
            );

            const SectionTitle = ({ title, icon: Icon }) => (
                <div className="mb-10 flex items-center gap-4 border-b-2 border-innovet-black pb-6">
                    {Icon && <div className="bg-innovet-yellow p-2 text-black"><Icon size={32} strokeWidth={2.5} /></div>}
                    <h2 className="text-3xl md:text-5xl font-black text-[#080610] uppercase tracking-tighter leading-[0.8]">
                        {title}
                    </h2>
                </div>
            );

            // MATRIX VIEW
            const AgendaMatrixView = () => (
                <div className="bg-white border border-innovet-gray shadow-sm">
                    {/* Wrapped in overflow-x-auto and ref attached here for drag */}
                    <div ref={agendaRef} className={`overflow-x-auto custom-scrollbar`} dir={isRTL ? 'rtl' : 'ltr'}>
                        <table className={`w-full border-collapse ${isRTL ? 'text-right' : 'text-left'} min-w-[800px]`}>
                            <thead>
                                <tr className="bg-innovet-dark text-white">
                                    <th className={`sticky ${isRTL ? 'right-0' : 'left-0'} z-20 bg-innovet-dark p-6 text-2xl font-bold ${isRTL ? 'border-l' : 'border-r'} border-gray-700 min-w-[220px]`}>
                                        {t.week} / {t.category}
                                    </th>
                                    {agendaData.map((item) => (
                                        <th key={item.week} className={`p-4 text-center min-w-[180px] ${isRTL ? 'border-l' : 'border-r'} border-gray-700`}>
                                            <div className="flex flex-col items-center">
                                                <span className="text-innovet-yellow text-sm font-bold uppercase tracking-widest mb-1">{t.week}</span>
                                                <span className="text-4xl font-black">{item.week}</span>
                                            </div>
                                        </th>
                                    ))}
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-innovet-gray">
                                <tr className="bg-innovet-bg">
                                    <td className={`sticky ${isRTL ? 'right-0' : 'left-0'} z-10 bg-innovet-bg p-6 text-xl font-bold text-innovet-blue ${isRTL ? 'border-l' : 'border-r'} border-b border-[#D1D1D1]`}>
                                        {t.phase}
                                    </td>
                                    {agendaData.map((item, idx) => (
                                        <td key={idx} className={`p-4 text-sm font-bold text-innovet-blue text-center ${isRTL ? 'border-l' : 'border-r'} border-b border-[#D1D1D1]`}>
                                            {lang === 'he' ? item.phase_he : item.phase_en}
                                        </td>
                                    ))}
                                </tr>
                                <tr className="group hover:bg-[#FAFAFA]">
                                    <td className={`sticky ${isRTL ? 'right-0' : 'left-0'} z-10 bg-white group-hover:bg-[#FAFAFA] p-6 text-xl font-bold text-innovet-black ${isRTL ? 'border-l' : 'border-r'} border-innovet-gray`}>
                                        {t.subject}
                                    </td>
                                    {agendaData.map((item, idx) => (
                                        <td key={idx} className={`p-5 text-lg font-medium text-innovet-black ${isRTL ? 'border-l' : 'border-r'} border-innovet-gray align-top`}>
                                            {lang === 'he' ? item.subject_he : item.subject_en}
                                        </td>
                                    ))}
                                </tr>
                                <tr className="group hover:bg-[#FAFAFA]">
                                    <td className={`sticky ${isRTL ? 'right-0' : 'left-0'} z-10 bg-white group-hover:bg-[#FAFAFA] p-6 text-xl font-bold text-innovet-black ${isRTL ? 'border-l' : 'border-r'} border-innovet-gray`}>
                                        {t.tools}
                                    </td>
                                    {agendaData.map((item, idx) => (
                                        <td key={idx} className={`p-5 ${isRTL ? 'border-l' : 'border-r'} border-innovet-gray align-top`}>
                                            <div className="flex flex-wrap gap-2">
                                                {item.tools && item.tools.map((t, i) => (
                                                    <span key={i} className="inline-block px-2 py-1 bg-innovet-black text-white text-xs font-bold uppercase tracking-wide">
                                                        {t}
                                                    </span>
                                                ))}
                                            </div>
                                        </td>
                                    ))}
                                </tr>
                                <tr className="bg-innovet-yellow/10">
                                    <td className={`sticky ${isRTL ? 'right-0' : 'left-0'} z-10 bg-[#FFF8E1] p-6 text-xl font-bold text-innovet-black ${isRTL ? 'border-l' : 'border-r'} border-innovet-gray`}>
                                        {t.milestones}
                                    </td>
                                    {agendaData.map((item, idx) => (
                                        <td key={idx} className={`p-5 ${isRTL ? 'border-l' : 'border-r'} border-innovet-gray align-top h-full`}>
                                            {item.milestone && (
                                                <div className="p-3 bg-innovet-yellow text-black text-sm font-bold text-center shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] border border-black">
                                                    <div className="flex justify-center mb-1 text-black">
                                                        <Star size={16} className="fill-black" />
                                                    </div>
                                                    {item.milestone}
                                                </div>
                                            )}
                                        </td>
                                    ))}
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            );

            // DELIVERABLES VIEW
            const TableDeliverables = () => (
                <div className="bg-white border-t-4 border-innovet-blue shadow-sm">
                    <div ref={deliverablesRef} className="overflow-x-auto custom-scrollbar">
                        <table className={`w-full ${isRTL ? 'text-right' : 'text-left'} border-collapse min-w-[600px]`}>
                            <thead className="bg-innovet-bg text-innovet-black">
                                <tr>
                                    <th className="px-8 py-6 text-lg font-bold border-b-2 border-innovet-black w-32">{t.week}</th>
                                    <th className="px-8 py-6 text-lg font-bold border-b-2 border-innovet-black">{t.task}</th>
                                    <th className="px-8 py-6 text-lg font-bold border-b-2 border-innovet-black w-48">{t.status}</th>
                                </tr>
                            </thead>
                            <tbody className="text-innovet-black">
                                {deliverablesData.map((item, index) => (
                                    <tr key={index} className="border-b border-innovet-gray hover:bg-[#FAFAFA] transition-colors">
                                        <td className="px-8 py-6 font-black text-2xl text-innovet-blue">{item.week}</td>
                                        <td className="px-8 py-6 text-xl font-bold">{lang === 'he' ? item.task_he : item.task_en}</td>
                                        <td className="px-8 py-6">
                                            {item.link && item.link.startsWith('http') ? (
                                                <a href={item.link} target="_blank" className="flex items-center gap-2 text-sm font-bold uppercase tracking-wider hover:text-innovet-yellow transition-colors">
                                                    {t.download} <Download size={16}/>
                                                </a>
                                            ) : (
                                                <span className="text-sm text-gray-400 font-bold uppercase tracking-wider cursor-not-allowed opacity-50">
                                                    {t.download} <Download size={16}/>
                                                </span>
                                            )}
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );

            // OFFICE HOURS VIEW
            const TableOfficeHours = () => (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                    {officeHoursData.map((item, index) => (
                        <div key={index} className="bg-white border-2 border-innovet-bg hover:border-innovet-blue transition-all duration-300 p-8 group">
                            <div className="flex justify-between items-start mb-6">
                                <div className="bg-innovet-black text-white px-4 py-1 text-sm font-bold uppercase tracking-wider">
                                    {item.week} 
                                </div>
                                <div className="text-innovet-yellow">
                                    <Users size={28} strokeWidth={2} />
                                </div>
                            </div>
                            <h3 className="text-3xl font-bold text-innovet-black mb-2 group-hover:text-innovet-blue transition-colors">
                                {lang === 'he' ? item.topic_he : item.topic_en}
                            </h3>
                            <p className="text-xl text-gray-500 mb-8 font-light">
                                {t.with} {lang === 'he' ? item.expert_he : item.expert_en}
                            </p>
                            
                            {item.email ? (
                                <a href={`mailto:${item.email}?subject=Innovet Office Hours: ${item.topic_en}`} className="w-full py-4 bg-innovet-bg text-innovet-black font-bold text-lg uppercase hover:bg-innovet-yellow transition-colors flex justify-center items-center gap-2">
                                    {t.book} <ArrowIcon size={20} />
                                </a>
                            ) : (
                                <button disabled className="w-full py-4 bg-gray-100 text-gray-400 font-bold text-lg uppercase cursor-not-allowed flex justify-center items-center gap-2">
                                    {t.book} <ArrowIcon size={20} />
                                </button>
                            )}
                        </div>
                    ))}
                </div>
            );

            // CALENDAR VIEW
            const CalendarView = () => (
                <div className="space-y-0">
                    {calendarHighlights.map((event, index) => (
                        <div key={index} className="flex flex-col md:flex-row bg-innovet-dark text-white border-b border-gray-800 hover:bg-[#1F1F1F] transition-colors group">
                            <div className={`md:w-48 p-8 ${isRTL ? 'md:border-l' : 'md:border-r'} border-gray-800 flex flex-col justify-center items-center md:items-start text-innovet-yellow text-center md:text-start`}>
                                <span className="text-3xl md:text-5xl font-black leading-none block">{event.date}</span>
                                <span className="text-lg md:text-xl font-bold uppercase tracking-widest mt-2 block text-gray-500">
                                    {event.month ? event.month.split(' ')[0].substring(0,3).toUpperCase() : "JAN"}
                                </span>
                            </div>
                            <div className="flex-grow p-8 flex flex-col justify-center">
                                <div className="flex items-center gap-4 mb-2">
                                    <h3 className="text-3xl font-bold uppercase tracking-wide group-hover:text-innovet-yellow transition-colors">
                                        {lang === 'he' ? event.event_he : event.event_en}
                                    </h3>
                                </div>
                                <p className="text-gray-400 text-lg font-light font-sans max-w-2xl" style={{whiteSpace: 'pre-line'}}>
                                    {lang === 'he' ? event.details_he : event.details_en}
                                </p>
                            </div>
                            <div className={`p-8 flex items-center justify-end md:w-64`}>
                                {event.time && (
                                    <div className="flex items-center gap-3 text-xl font-bold">
                                        <Clock size={24} className="text-innovet-yellow" />
                                        {event.time}
                                    </div>
                                )}
                            </div>
                        </div>
                    ))}
                </div>
            );

            return (
                <div className="min-h-screen font-sans text-innovet-black flex flex-col z-10 relative w-full overflow-x-hidden">
                    
                    {/* Header */}
                    <header className="bg-white sticky top-0 z-50 border-b border-innovet-gray w-full">
                        <div className="max-w-[1600px] mx-auto px-4 md:px-6 h-24 flex items-center justify-between">
                            <div className="flex items-center gap-4 md:gap-6 h-full">
                                {/* Logo Image */}
                                <div className="cursor-pointer flex items-center gap-2 md:gap-4" onClick={scrollToTop}>
                                    <img 
                                        src="./INNOVET_ICON-05-1.svg" 
                                        alt="Innovet Logo" 
                                        className="h-10 md:h-16 w-auto object-contain icon-black" 
                                        onError={(e) => {
                                            e.target.style.display = 'none'; 
                                        }} 
                                    />
                                    
                                    <div className="flex flex-col">
                                        <span className="text-2xl md:text-3xl font-black tracking-tighter leading-none">INNOVET</span>
                                        <span className="text-xs md:text-sm font-bold text-innovet-blue tracking-widest uppercase">Cohort 2</span>
                                    </div>
                                </div>
                                
                                <div className="hidden md:block h-8 w-px bg-innovet-gray"></div>
                                
                                {/* Desktop Nav */}
                                <nav className="hidden md:flex gap-8 h-full items-center">
                                    <button onClick={scrollToTop} className="text-lg font-bold hover:text-innovet-blue transition-colors">{t.program}</button>
                                    
                                    {/* Subcategories Dropdown */}
                                    <div className="relative group h-full flex items-center">
                                        <button 
                                            onClick={() => handleNavClick('agenda')}
                                            className="text-lg font-bold text-innovet-blue transition-colors flex items-center gap-1 py-8"
                                        >
                                            {t.schedule} <ChevronDown size={16} />
                                        </button>
                                        
                                        {/* Dropdown Content */}
                                        <div className="absolute top-[95%] right-0 w-64 bg-white shadow-xl border border-innovet-gray hidden group-hover:block animate-fadeIn z-50">
                                             <div className="py-2">
                                                <button onClick={(e) => { e.stopPropagation(); handleNavClick('agenda'); }} className="block w-full text-right px-6 py-3 text-base font-bold hover:bg-innovet-bg hover:text-innovet-blue transition-colors border-b border-gray-100">
                                                    {t.tabAgenda}
                                                </button>
                                                <button onClick={(e) => { e.stopPropagation(); handleNavClick('deliverables'); }} className="block w-full text-right px-6 py-3 text-base font-bold hover:bg-innovet-bg hover:text-innovet-blue transition-colors border-b border-gray-100">
                                                    {t.tabDeliverables}
                                                </button>
                                                <button onClick={(e) => { e.stopPropagation(); handleNavClick('office-hours'); }} className="block w-full text-right px-6 py-3 text-base font-bold hover:bg-innovet-yellow hover:text-black transition-colors border-b border-gray-100">
                                                    {t.tabOfficeHours}
                                                </button>
                                                <button onClick={(e) => { e.stopPropagation(); handleNavClick('calendar'); }} className="block w-full text-right px-6 py-3 text-base font-bold hover:bg-innovet-bg hover:text-innovet-blue transition-colors">
                                                    {t.tabCalendar}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </nav>
                            </div>

                            <div className="flex items-center gap-2 md:gap-4">
                                {/* Language Toggle with Flags */}
                                <button onClick={toggleLang} className="flex items-center gap-2 px-2 py-2 bg-innovet-bg hover:bg-gray-200 transition rounded-full font-bold text-sm uppercase">
                                    <img 
                                        src={lang === 'he' ? "./united-states.png" : "./israel.png"} 
                                        alt={lang === 'he' ? "English" : "Hebrew"}
                                        className="w-6 h-6 object-contain"
                                    />
                                    <span>{lang === 'he' ? 'EN' : 'HE'}</span>
                                </button>

                                {/* Mobile Menu Button */}
                                <div className="md:hidden">
                                    <button onClick={toggleMobileMenu} className="text-black hover:text-innovet-blue transition-colors">
                                        {isMobileMenuOpen ? <X size={28} /> : <Menu size={28} />}
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Mobile Menu Dropdown */}
                        {isMobileMenuOpen && (
                            <div className="md:hidden bg-white border-t border-innovet-gray animate-fadeIn absolute w-full shadow-xl">
                                <nav className="flex flex-col p-6 gap-4 text-center">
                                    <button onClick={scrollToTop} className="text-xl font-bold hover:text-innovet-blue transition-colors py-2">{t.home}</button>
                                    <button onClick={scrollToTop} className="text-xl font-bold hover:text-innovet-blue transition-colors py-2">{t.program}</button>
                                    <div className="bg-gray-50 py-2 rounded-lg">
                                        <div className="text-xl font-bold text-innovet-blue mb-2">{t.schedule}</div>
                                        <div className="flex flex-col gap-2">
                                             <button onClick={() => handleNavClick('agenda')} className="text-sm font-bold text-gray-600">{t.tabAgenda}</button>
                                             <button onClick={() => handleNavClick('deliverables')} className="text-sm font-bold text-gray-600">{t.tabDeliverables}</button>
                                             <button onClick={() => handleNavClick('office-hours')} className="text-sm font-bold text-innovet-yellow bg-black/5 py-1 mx-10 rounded">{t.tabOfficeHours}</button>
                                             <button onClick={() => handleNavClick('calendar')} className="text-sm font-bold text-gray-600">{t.tabCalendar}</button>
                                        </div>
                                    </div>
                                </nav>
                            </div>
                        )}
                    </header>

                    {/* Hero / Page Title */}
                    <div className="bg-innovet-dark text-white py-24 relative overflow-hidden w-full">
                        {/* Background Image (INNOVET_LOGO_HOR_NEG-02-2.svg) */}
                        <div className="absolute inset-0 z-0 pointer-events-none opacity-10">
                            <img src="./INNOVET_LOGO_HOR_NEG-02-2.svg" alt="" className="w-full h-full object-cover" />
                        </div>

                        {/* Starburst Decoration (Spinning) - High Opacity as requested */}
                        <div className="absolute -right-20 -top-20 z-0 opacity-100 pointer-events-none animate-spin-slow mix-blend-overlay">
                             <img src="./INNOVET_ICON-05linear-1.webp" alt="" className="w-[600px] h-[600px]" />
                        </div>

                        <div className="max-w-[1600px] mx-auto px-6 relative z-10">
                            <div className="flex flex-col md:flex-row justify-between items-end gap-10">
                                <div>
                                    <span className="text-innovet-yellow font-bold text-xl tracking-widest uppercase mb-4 block">
                                        {t.heroSubtitle}
                                    </span>
                                    <h1 className="text-6xl md:text-8xl font-black uppercase leading-[0.85] tracking-tight">
                                        {t.heroTitle} <br/> {t.heroTitle2}
                                    </h1>
                                </div>
                                <div className="md:max-w-xl mb-2">
                                    <p className="text-lg md:text-2xl font-light text-gray-300 leading-relaxed">
                                        {t.heroDesc}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main ref={mainContentRef} className="max-w-[1600px] mx-auto px-4 md:px-6 py-16 relative -mt-12 flex-grow w-full">
                        
                        {/* Navigation Tabs - STICKY & SCROLLABLE ON MOBILE */}
                        <div className="bg-white p-2 shadow-lg mb-12 flex overflow-x-auto hide-scrollbar sticky top-24 z-40 transition-all w-full md:w-auto md:inline-flex gap-2 relative">
                            <TabButton id="agenda" label={t.tabAgenda} icon={Layout} />
                            <TabButton id="deliverables" label={t.tabDeliverables} icon={CheckSquare} />
                            <TabButton id="office-hours" label={t.tabOfficeHours} icon={Users} />
                            <TabButton id="calendar" label={t.tabCalendar} icon={Calendar} />
                        </div>

                        {/* Dynamic Content */}
                        <div className="animate-fadeIn w-full">
                            {loading ? (
                                <div className="flex justify-center items-center h-64">
                                    <div className="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-innovet-blue"></div>
                                </div>
                            ) : (
                                <>
                                    {activeTab === 'agenda' && (
                                        <>
                                            <SectionTitle title={t.sectionJourney} icon={Target} />
                                            <AgendaMatrixView />
                                        </>
                                    )}
                                    {activeTab === 'deliverables' && (
                                        <>
                                            <SectionTitle title={t.sectionStudent} icon={CheckSquare} />
                                            <TableDeliverables />
                                        </>
                                    )}
                                    {activeTab === 'office-hours' && (
                                        <>
                                            <SectionTitle title={t.sectionExperts} icon={Users} />
                                            <TableOfficeHours />
                                        </>
                                    )}
                                    {activeTab === 'calendar' && (
                                        <>
                                            <SectionTitle title={t.sectionEvents} icon={Calendar} />
                                            <CalendarView />
                                        </>
                                    )}
                                </>
                            )}
                        </div>
                    </main>

                    {/* Footer */}
                    <footer className="bg-innovet-dark text-white py-16 border-t border-gray-800 relative z-10 mt-auto w-full">
                        <div className="max-w-[1600px] mx-auto px-6 flex flex-col md:flex-row justify-between items-center">
                            <div className={`text-center ${isRTL ? 'md:text-right' : 'md:text-left'} mb-8 md:mb-0`}>
                                <h2 className="text-4xl font-black mb-2">INNOVET</h2>
                                <p className="text-gray-500">{t.rights}</p>
                            </div>
                            <div className="flex gap-8 items-center">
                                <span className="text-gray-400 font-bold uppercase tracking-wider">{t.builtBy}</span>
                                <img src="./Starburst-Logo-White-svg-1.webp" alt="Starburst Logo" className="h-8 opacity-70 hover:opacity-100 transition-opacity" />
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
