<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>מדריך גלישת סנובורד</title>
  <style>
    /* איפוס בסיסי (Reset) */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      font-family: Arial, sans-serif;
      direction: rtl;
      overflow-x: hidden; /* למניעת גלילה לצדדים */
    }

    /* תפריט עליון (Header) */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background-color: rgba(0, 0, 0, 0.8);
      color: #fff;
      z-index: 9999;
      height: 90px; 
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    nav {
      display: flex;
      gap: 40px;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: bold;
      padding: 10px 15px;
      border-radius: 4px;
      font-size: 18px;
      transition: background-color 0.3s, color 0.3s;
      cursor: pointer;
    }
    nav a:hover {
      background-color: #ffdd57;
      color: #333;
    }
 header nav a {
      font-size: 18px;
      padding: 10px 15px;
    }

    h2 {
      font-size: 20px;
    }

    p, ul, li {
      font-size: 16px;
    }

    /* מדיה קווריז לפלאפון */
    @media screen and (max-width: 768px) {
      .category-content {
        max-width: 5%; /* כמעט רוחב מלא */
        margin: 10px auto; /* ריווח קטן יותר */
        padding: 15px;
      }

      header nav a {
        font-size: 14px; /* טקסט קטן יותר */
        padding: 8px 10px;
      }

      h2 {
        font-size: 18px; /* כותרות קטנות יותר */
      }

      p, ul, li {
        font-size: 14px; /* טקסט קטן יותר */
      }

      body {
        padding: 0 10px; /* ריווח פנימי מסביב לעמוד */
      }
    }
    /* שני ה־Canvas לשלג (רקע + קדמי) */
    #snow-canvas-back,
    #snow-canvas-front {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    #snow-canvas-front {
      z-index: 10000; /* מעל כל התוכן */
    }

    /* מעטפת העמוד (כוללת את שלוש הקטגוריות) */
    .main-container {
      position: relative;
      top: 90px; /* מתחת לתפריט */
      z-index: 1; /* מעל ה־canvas האחורי */
      min-height: calc(100vh - 90px);
    }

    /* "דפי" הקטגוריה – כל אחד מוצג/מוסתר ב-Fade */
    .category-page {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      min-height: calc(100vh - 90px);
      opacity: 0;
      pointer-events: none; 
      transition: opacity 0.6s ease-in-out;
    }
    .category-page.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* "סליידר" רקע (ברוטציה) – נשתמש בעד 5 רקעים מתחלפים */
    .category-page.fade-bg {
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      /* מעבר חלק ברקע עצמו */
      transition: background-image 1.5s ease-in-out;
    }

    /* תוכן פנימי (כרטיסיות) */
    .category-content {
  max-width: 800px;
  margin: 20px auto; /* מרכז הכרטיסיות */
  padding: 20px;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}
    .category-content h2 {
      margin-bottom: 10px;
      color: #333;
    }

    .category-content p {
      margin-bottom: 15px;
      line-height: 1.6;
      color: #444;
    }

    .category-content ul {
      list-style-type: disc;
      list-style-position: inside;
      margin-bottom: 20px;
      color: #444;
    }
    .category-content li {
      margin-bottom: 8px;
    }

    .highlight {
      font-weight: bold;
      color: #333;
    }

    /* סרגל משנה (סאב קטגוריות) */
  .sub-nav {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 15px;
  justify-content: center; /* מרכז אופקי */
}
/*	  .sub-nav {
 display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 15px;
  justify-content: center; 
  align-items: center; 
  height: 100%; 
}
	  */
    .sub-nav a {
		  display: flex;
  flex-wrap: wrap;
      display: inline-block;
      text-decoration: none;
      background: #333;
      color: #fff;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
      cursor: pointer;
		margin-bottom: 15px;
  justify-content: center; 
  align-items: center; 
  height: 100%; 
      transition: background-color 0.3s;
    }
    .sub-nav a:hover {
      background-color: #ffdd57;
      color: #333;
    }

    /* עוגנים פנימיים (עבור הסאב קטגוריות) */
    .anchor {
      display: block;
      height: 60px; /* לפצות על התפריט העליון */
      margin-top: -60px;
      visibility: hidden;
    }

    /* טיפים נפתחים / נסגרים */
    .tip-box {
      margin-top: 10px;
    }
    .tip-header {
      background-color: #d7e7f7;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      color: #333;
      display: inline-block;
    }
    .tip-content {
      background-color: #f4f4f4;
      border-radius: 4px;
      margin-top: 5px;
      padding: 10px 12px;
      display: none; /* מוסתר כברירת מחדל */
    }
  </style>
</head>
<body>

<!-- שכבות השלג -->
<canvas id="snow-canvas-back"></canvas>
<canvas id="snow-canvas-front"></canvas>

<!-- תפריט עליון קבוע (3 קטגוריות אב) -->
<header>
  <nav>
    <a data-category="cat1">הכרה</a>
    <a data-category="cat2">אימונים לפני</a>
    <a data-category="cat3">יום גלישה</a>
  </nav>
</header>

<!-- מעטפת העמוד (מכילה את דפי הקטגוריות) -->
<div class="main-container">

  <!-- קטגוריה 1: הכרה -->
  <div id="cat1" class="category-page fade-bg">
    
    <!-- סרגל משנה (סאב-קטגוריות) -->
    <div class="sub-nav">
      <a href="#cat1-sub1">מבוא וסקירה כללית</a>
      <a href="#cat1-sub2">הכרת הציוד</a>
      <a href="#cat1-sub3">בטיחות וטכניקות נפילה</a>
    </div>

    <!-- כרטיסייה 1 -->
    <div class="category-content">
      <span class="anchor" id="cat1-sub1"></span>
      <h2>מבוא וסקירה כללית</h2>
      <p>
        גלישת סנובורד הפכה לאחד מענפי ספורט החורף הפופולריים ביותר. 
        היא משלבת מהירות, זרימה ושליטה, עם תחושת חופש אדירה על השלג. 
        בחלק זה, נלמד מהי גלישת סנובורד, מה ההיסטוריה שלה, וכיצד התפתחה לתרבות שלמה.
      </p>
      <!-- טיפ נפתח/נסגר -->
      <div class="tip-box">
        <div class="tip-header">טיפ: מהיכן הגיע הסנובורד?</div>
        <div class="tip-content">
          תחילת הסנובורד משויכת לשנות ה-60 של המאה הקודמת. 
          גולשי גלים וסקייטבורדיסטים חיפשו דרך לגלוש על שלג, וכך המציאו את ה־Snurfer, 
          שהפך לבסיס לסנובורד המודרני.
        </div>
      </div>
    </div>

    <!-- כרטיסייה 2 -->
    <div class="category-content">
      <span class="anchor" id="cat1-sub2"></span>
      <h2>הכרת הציוד</h2>
      <ul>
        <li><span class="highlight">נעלי סנובורד (Boots):</span> חשיבות הנוחות והידוק ברגל.</li>
        <li><span class="highlight">ביינדינגס (Bindings):</span> הגדרת זוויות, חיבור יציב.</li>
        <li><span class="highlight">סנובורד (Snowboard):</span> התאמת אורך / גמישות לרמה שלך.</li>
        <li><span class="highlight">קסדה ומשקפיים (Helmet & Goggles):</span> להגנה ומניעת סינוור.</li>
        <li><span class="highlight">ביגוד:</span> שכבות חמות, גרבי סקי, כפפות.</li>
      </ul>
      <p>ציוד מותאם מקל על הלמידה ומוריד את הסיכון לפציעות וחוסר נוחות.</p>
    </div>

    <!-- כרטיסייה 3 -->
    <div class="category-content">
      <span class="anchor" id="cat1-sub3"></span>
      <h2>בטיחות וטכניקות נפילה</h2>
      <ul>
        <li><span class="highlight">מגני ידיים וברכיים:</span> מומלצים מאוד בתחילת הדרך.</li>
        <li>ליפול נכון: לכופף מרפקים קדימה או להצמיד סנטר לחזה כשנופלים אחורה.</li>
        <li>מודעות סביבתית: לשים לב לגולשים אחרים, לעצור בשולי המסלול.</li>
      </ul>
      <p>שמירה על בטיחות תבטיח שתוכל/י להמשיך לגלוש בכיף וללא חששות מיותרים.</p>
    </div>
  </div>

  <!-- קטגוריה 2: אימונים לפני -->
  <div id="cat2" class="category-page fade-bg">
    
    <!-- סרגל משנה (סאב-קטגוריות) -->
    <div class="sub-nav">
      <a href="#cat2-sub1">תוכנית כושר בסיסית</a>
      <a href="#cat2-sub2">שיווי משקל ויציבה</a>
      <a href="#cat2-sub3">הכנה מנטלית</a>
    </div>

    <!-- כרטיסייה 1 -->
    <div class="category-content">
      <span class="anchor" id="cat2-sub1"></span>
      <h2>תוכנית כושר בסיסית</h2>
      <ul>
        <li><span class="highlight">סקוואטים:</span> לחיזוק הרגליים והברכיים.</li>
        <li><span class="highlight">לאנג'ים:</span> ליציבות ולבניית שרירי ירך.</li>
        <li><span class="highlight">פלאנק (Plank):</span> לחיזוק שרירי ליבה.</li>
      </ul>
      <p>אימונים פעמיים-שלוש בשבוע לשבועיים-שלושה יכולים מאוד לעזור לפני העלייה על השלג.</p>
    </div>

    <!-- כרטיסייה 2 -->
    <div class="category-content">
      <span class="anchor" id="cat2-sub2"></span>
      <h2>שיווי משקל ויציבה</h2>
      <ul>
        <li>עמידה על רגל אחת עם עיניים עצומות/פתוחות.</li>
        <li>שימוש בכדור פיזיו/בוסו (Bosu) לתרגול תנודות.</li>
        <li><span class="highlight">Side Plank:</span> לתמיכה בשרירי הצדדים של הבטן.</li>
      </ul>
      <p>שיווי משקל טוב הוא המפתח לשליטה בקרש ולפניות חלקות.</p>
    </div>

    <!-- כרטיסייה 3 -->
    <div class="category-content">
      <span class="anchor" id="cat2-sub3"></span>
      <h2>הכנה מנטלית</h2>
      <p>
        הפחתת פחד ושיפור הביטחון חשובים כדי ליהנות מהגלישה:
      </p>
      <ul>
        <li>צפייה בסרטוני הדרכה ביוטיוב: לראות מראש איך נראית הטכניקה.</li>
        <li>דמיון מודרך: דמיין את עצמך גולש/ת בביטחון.</li>
        <li>דיבור עצמי חיובי: “אני מצליח/ה, אני שולט/ת במהירות.”</li>
      </ul>
      <!-- טיפ נפתח/נסגר -->
      <div class="tip-box">
        <div class="tip-header">טיפ: הגדרת מטרות מנטליות</div>
        <div class="tip-content">
          במקום לשאוף “להיות תותח/ית ביום הראשון”, הגדר/י יעד ריאלי: 
          “אלמד לעצור בשליטה ולהחליק מצד לצד בביטחון.” 
          כך תבנה/י ביטחון ותשמור/י על מוטיבציה.
        </div>
      </div>
    </div>
  </div>

  <!-- קטגוריה 3: יום גלישה -->
  <div id="cat3" class="category-page fade-bg">
    
    <!-- סרגל משנה (סאב-קטגוריות) -->
    <div class="sub-nav">
      <a href="#cat3-sub1">טכניקות עצירה בסיסיות</a>
      <a href="#cat3-sub2">קימה ושינוי כיוון</a>
      <a href="#cat3-sub3">התקדמות לשלב הבא</a>
    </div>

    <!-- כרטיסייה 1 -->
    <div class="category-content">
      <span class="anchor" id="cat3-sub1"></span>
      <h2>טכניקות עצירה בסיסיות</h2>
      <ul>
        <li><span class="highlight">Heel Edge:</span> האטה/עצירה ע"י הטיית עקבים.</li>
        <li><span class="highlight">Toe Edge:</span> האטה/עצירה ע"י הטיית בהונות.</li>
        <li>"עלה" (Falling Leaf): החלקה מצד לצד תוך שליטה במהירות.</li>
      </ul>
      <p>תרגל את העצירות תכופות כדי לא לצבור מהירות מסוכנת.</p>
    </div>

    <!-- כרטיסייה 2 -->
    <div class="category-content">
      <span class="anchor" id="cat3-sub2"></span>
      <h2>קימה ושינוי כיוון</h2>
      <ul>
        <li>קימה מישיבה: הטיית הקרש על Heel Edge או Toe Edge ודחיפת הגוף מעלה.</li>
        <li>שינוי כיוון: העברת משקל בין עקבים לבהונות + סיבוב מתון של האגן והכתפיים.</li>
        <li>מודעות לתנאי השלג: אם השלג רך או קשה, השיטה יכולה לדרוש התאמה.</li>
      </ul>
    </div>

    <!-- כרטיסייה 3 -->
    <div class="category-content">
      <span class="anchor" id="cat3-sub3"></span>
      <h2>התקדמות לשלב הבא</h2>
      <ul>
        <li><span class="highlight">פניות מקושרות (Linked Turns):</span> מעבר רציף בין Heel ל-Toe.</li>
        <li><span class="highlight">Carving בסיסי:</span> הטיית הקרש בזווית חדה יותר לחיתוך השלג.</li>
        <li>ניסיונות ראשונים בקפיצות קטנות (Ollie), עלייה למדרונות מעט תלולים יותר.</li>
      </ul>
      <p>
        עם הזמן והתרגול תוכל/י לגלוש בביטחון גבוה יותר, ולנסות פארקים או מסלולים 
        מאתגרים. תמיד לזכור לשמור על בטיחות ועל קצב התקדמות אישי.
      </p>
    </div>
  </div>

</div><!-- .main-container -->

<!-- סקריפטים: מעבר בין קטגוריות + רקע מתחלף + סאב קטגוריות + פתיתי שלג -->
<script>
/* -------------------------------------------------
   1) מעבר בין קטגוריות (Fade) + ניווט ראשי
-------------------------------------------------- */
const pages = document.querySelectorAll('.category-page');
const navLinks = document.querySelectorAll('header nav a');

function showCategory(catId) {
  pages.forEach(page => {
    if(page.id === catId) {
      page.classList.add('active');
    } else {
      page.classList.remove('active');
    }
  });
}

// בעת לחיצה על קישור בתפריט הראשי
navLinks.forEach(link => {
  link.addEventListener('click', () => {
    const targetCat = link.getAttribute('data-category'); 
    showCategory(targetCat);
  });
});

// ברירת מחדל: הצגת קטגוריה 1
showCategory('cat1');

/* -------------------------------------------------
   2) סאב-קטגוריות (anchor links) בתוך הקטגוריה
      מאפשר גלילה חלקה למקטע המתאים
-------------------------------------------------- */
	
const subLinks = document.querySelectorAll('.sub-nav a');
subLinks.forEach(slink => {
  slink.addEventListener('click', e => {
    e.preventDefault();
    const targetAnchor = slink.getAttribute('href'); 
    const anchorEl = document.querySelector(targetAnchor);
    if(anchorEl) {
      // גלילה חלקה
      window.scrollTo({
        top: anchorEl.offsetTop - 80, 
        behavior: 'smooth'
      });
    }
  });
});

/* -------------------------------------------------
   3) רוטציית רקעים (5 רקעים) כל 20-30 שניות
      עם Transition Fade ברקע
-------------------------------------------------- */
const bgImages = [
  'sbBG1.webp',
  'sbBG2.webp',
  'sbBG3.webp',
  'sbBG4.webp',
  'sbBG5.webp'
];
let bgIndex = 0;

function rotateBackgrounds() {
  pages.forEach(page => {
    // הגדר רקע חדש לכל קטגוריה פעילה
    page.style.backgroundImage = `url('${bgImages[bgIndex]}')`;
  });
  bgIndex = (bgIndex + 1) % bgImages.length;
}

// כל הקטגוריות יסומנו כ-fade-bg כדי לאפשר transition ב-css
pages.forEach(page => page.classList.add('fade-bg'));

// הפעלת הרוטציה – כל 25 שניות (ניתן לגוון בין 20 ל-30)
setInterval(() => {
  rotateBackgrounds();
}, 25000);

// אתחול רקע ראשוני
rotateBackgrounds();

/* -------------------------------------------------
   4) טיפים (Snippets) נפתחים/נסגרים
-------------------------------------------------- */
const tipHeaders = document.querySelectorAll('.tip-header');
tipHeaders.forEach(header => {
  header.addEventListener('click', () => {
    const content = header.nextElementSibling;
    if(content.style.display === 'block') {
      content.style.display = 'none';
    } else {
      content.style.display = 'block';
    }
  });
});

/* -------------------------------------------------
   5) אפקט שלג דו-שכבתי (רקע + קדמי) + מנגנון צבירה
      (כרגע: צבירה בתחתית המסך בלבד)
      "להערים" שלג על הכרטיסיות מצריך זיהוי מיקום
      הכרטיסיות והטלת פתיתים קוליזיית-מלאה, וזה מורכב
      יותר. אז משאירים כדוגמה בסיסית.
-------------------------------------------------- */
const canvasBack = document.getElementById('snow-canvas-back');
const ctxBack = canvasBack.getContext('2d');

const canvasFront = document.getElementById('snow-canvas-front');
const ctxFront = canvasFront.getContext('2d');

function resizeCanvas() {
  canvasBack.width = window.innerWidth;
  canvasBack.height = window.innerHeight;
  canvasFront.width = window.innerWidth;
  canvasFront.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// מערכים לפתיתים
let backFlakes = [];
let frontFlakes = [];
// נמשיך "לייצר" פתיתים חדשים כל הזמן
const spawnInterval = 500; // כל 0.5 שניות נייצר פתיתים חדשים

// פיזיקה בסיסית
class SnowFlake {
  constructor(front = false) {
    this.front = front;
    this.x = Math.random() * canvasBack.width;
    this.y = -20; // מופיע טיפה מעל המסך
    this.radius = front ? (1 + Math.random()*2) : (2 + Math.random()*3);
    this.vy = front ? (1 + Math.random()*2.5) : (0.5 + Math.random()*1.5);
    this.vx = (Math.random()-0.5) * 0.5;
    this.isSettled = false;       // האם נחת סופית (לא יזוז?)
    this.settledOn = null;        // על איזה "משטח" (card או floor)
    this.settledOffset = 0;       // מרחק הצטברות (עבור ערימה על כרטיסיה)
  }

  update(cardsData) {
    if(this.isSettled) return;

    // השפעת רוח גלובלית
    this.vx += windGlobalX * 0.001; // ככל שנוסיף, יותר השפעה לרוח

    // עדכון מיקום
    this.x += this.vx;
    this.y += this.vy;

    // גלישה לצדדים
    if(this.x < 0) this.x = canvasBack.width;
    if(this.x > canvasBack.width) this.x = 0;

    // בדיקה: האם פגע בכרטיסיה / תחתית העמוד
    // 1) כרטיסיות
    for(let cd of cardsData) {
      // בודקים אם (x,y) נמצאים בתוך תחום רוחב הכרטיס וגבוה מעליו
      if(
        this.x >= cd.left && 
        this.x <= cd.right &&
        this.y + this.radius >= cd.top && 
        this.y < cd.bottom // בערך בתוך הכרטיס
      ){
        // נבדוק ערימת שלג שייתכן שכבר הצטברה מעל כרטיסיה זו
        let localStackHeight = cd.snowStack; 
        let topSurface = cd.top - localStackHeight; 
        if(this.y + this.radius >= topSurface){
          // נוחת
          this.isSettled = true;
          this.settledOn = cd;   // מצביע לאובייקט הכרטיסיה
          // "מוסיף" גובה לערימה
          cd.snowStack += this.radius*2;
          this.settledOffset = cd.snowStack; 
          // נתלה שם
          return;
        }
      }
    }

    // 2) תחתית המסך
    if(this.y >= canvasBack.height - this.radius){
      this.isSettled = true;
      this.settledOn = 'floor';
    }
  }

  draw(ctx) {
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.radius, 0, 2*Math.PI);
    ctx.fillStyle = '#fff';
    ctx.fill();
  }

  shakeOff() {
    // אם הפתית נח על כרטיסיה, נשחרר אותו להמשך נפילה
    if(this.isSettled && this.settledOn && this.settledOn !== 'floor'){
      // ניתן לו דחיפה קטנה
      this.isSettled = false;
      this.vy = 2 + Math.random()*2;
      this.vx = (Math.random()-0.5)*1;
      // נוריד גם את הערימה מהכרטיסיה
      if(typeof this.settledOn.snowStack === 'number'){
        this.settledOn.snowStack -= this.radius*2;
        if(this.settledOn.snowStack < 0) this.settledOn.snowStack = 0;
      }
      this.settledOn = null;
    }
  }
}

// ננהל "רוח" גלובלית:
let windGlobalX = 0; // מהירות הרוח ב-X. ערך חיובי – ימינה, שלילי – שמאלה
function randomWind(){
  // כל 10 שניות נכנסת רוח, נשמרת לכמה שניות ונרגעת
  let angle = Math.random()*2*Math.PI; 
  let speed = Math.random()*0.5 + 0.2; // עוצמה רנדומלית
  windGlobalX = Math.cos(angle)*speed;
  setTimeout(() => {
    windGlobalX = 0;
  }, 3000); // אחרי 3 שניות הרוח נרגעת
}
setInterval(randomWind, 10000); // כל 10 שניות – רוח רנדומלית

// הכרטיסיות - כדי שהשלג יצטבר עליהן, צריך לזהות את boundingRect
// נשמור מערך אובייקטים {top, bottom, left, right, snowStack}
function getCardsData(){
  const cards = document.querySelectorAll('.card');
  let arr = [];
  cards.forEach(card => {
    let rect = card.getBoundingClientRect();
    // מאחר והכרטיסייה ביחס ל-viewport, נוסיף scroll offset:
    let top = rect.top + window.scrollY;
    let left = rect.left + window.scrollX;
    let bottom = rect.bottom + window.scrollY;
    let right = rect.right + window.scrollX;
    // נוסיף גם סופר ערימת שלג
    // אם כבר יש שמור, לא נדרוס
    if(!card.__snowStack) card.__snowStack = 0;

    arr.push({
      element: card,
      top, left, bottom, right,
      snowStack: card.__snowStack
    });
  });
  return arr;
}
function updateCardsStack(cardsData){
  // נעדכן חזרה ל-element
  cardsData.forEach(cd => {
    cd.element.__snowStack = cd.snowStack;
  });
}


// ליצור פתיתים חדשים כל הזמן
function spawnFlakes() {
  // נניח כל פעם 10 פתיתים אחוריים + 6 פתיתי חזית
  for(let i=0; i<10; i++){
    backFlakes.push(new SnowFlake(false));
  }
  for(let i=0; i<6; i++){
    frontFlakes.push(new SnowFlake(true));
  }
}
setInterval(spawnFlakes, spawnInterval);

function animate() {
  // נקה כל canvas
  ctxBack.clearRect(0,0,canvasBack.width, canvasBack.height);
  ctxFront.clearRect(0,0,canvasFront.width, canvasFront.height);

  // שלב 1: קבלת מידע עדכני על כרטיסיות
  let cardsData = getCardsData();

  // שלב 2: עדכון פתיתים (אחורי + קדמי)
  backFlakes.forEach(fl => fl.update(cardsData));
  frontFlakes.forEach(fl => fl.update(cardsData));

  // שלב 3: ציור פתיתים
  backFlakes.forEach(fl => fl.draw(ctxBack));
  frontFlakes.forEach(fl => fl.draw(ctxFront));

  // שלב 4: עדכן ערימות בכרטיסיות
  updateCardsStack(cardsData);

  requestAnimationFrame(animate);
}
animate();

// כשמחליפים קטגוריה - מנערים שלג מהכרטיסיות
function shakeOffAll() {
  backFlakes.forEach(fl => fl.shakeOff());
  frontFlakes.forEach(fl => fl.shakeOff());
}
navLinks.forEach(link => {
  link.addEventListener('click', () => {
    // בנקודת המעבר - "נער" את כל הפתיתים שיושבים על כרטיסיות
    shakeOffAll();
  });
});
</script>

</body>
</html>
