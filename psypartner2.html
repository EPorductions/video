<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מאגר שותפים | Psychoflash</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&display=swap');
        
        /* Gemini-like Background */
        body { 
            font-family: 'Heebo', sans-serif; 
            background-color: #F0F4F9; 
            color: #1F1F1F;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #C4C7C5; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #8E918F; }

        .animate-spin { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        /* Smooth Transitions */
        .transition-all-smooth { transition: all 0.3s cubic-bezier(0.2, 0.0, 0, 1.0); }

        /* Mobile Grid Fixes */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, updateDoc, deleteDoc, onSnapshot, serverTimestamp, query, orderBy, writeBatch } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const React = window.React;
        const { useState, useEffect, useMemo } = React;

        // --- Firebase Configuration ---
        const firebaseConfig = {
            apiKey: "AIzaSyDkEOW4aXGmuO_J-X5xJTw9Iyp0Q2pbUIY",
            authDomain: "psychoflash-control.firebaseapp.com",
            projectId: "psychoflash-control",
            storageBucket: "psychoflash-control.firebasestorage.app",
            messagingSenderId: "304053769812",
            appId: "1:304053769812:web:3b55fb16bbbda06b993fc1"
        };

        // Initialize Firebase
        let app, auth, db;
        const appId = 'psychoflash-network'; 

        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (e) {
            console.error("Failed to initialize Firebase:", e);
        }

        // --- Icons ---
        const Icons = {
            Search: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>,
            Filter: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon></svg>,
            Phone: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>,
            Mail: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>,
            MessageCircle: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>,
            MapPin: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>,
            Lightbulb: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="9" y1="18" x2="15" y2="18"></line><line x1="10" y1="22" x2="14" y2="22"></line><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 16 8c0-4.42-3.58-8-8-8s-8 3.58-8 8c0 2.08.73 3.97 1.92 5.48.1.13.2.25.3.37.66.77 1.12 1.53 1.28 2.5H15.09z"></path></svg>,
            Rocket: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"></path><path d="M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"></path><path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"></path><path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"></path></svg>,
            Edit3: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 20h9"></path><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path></svg>,
            Trash2: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>,
            Plus: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>,
            Save: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>,
            X: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>,
            RefreshCw: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>,
            Check: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"></polyline></svg>,
            UploadCloud: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"/><path d="M12 12v9"/><path d="m16 16-4-4-4 4"/></svg>,
            Zap: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>,
            Grid: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>,
            Layout: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>,
            Flash: ({size=24, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="none" className={className}><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path></svg>,
            MoreVertical: ({size=20, className=""}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
        };

        const THEME = {
            black: '#191B1D',
            yellow: '#FFC700',
            bg: '#F0F4F9',
            surface: '#FFFFFF',
            surfaceContainer: '#E9EEF6',
            outline: '#747775'
        };

        // --- CSV Parser ---
        const parseCSV = (str) => {
            const arr = [];
            let quote = false;
            for (let row = 0, col = 0, c = 0; c < str.length; c++) {
                let cc = str[c], nc = str[c+1];
                arr[row] = arr[row] || [];
                arr[row][col] = arr[row][col] || '';
                if (cc == '"' && quote && nc == '"') { arr[row][col] += cc; ++c; continue; }
                if (cc == '"') { quote = !quote; continue; }
                if (cc == ',' && !quote) { ++col; continue; }
                if (cc == '\r' && nc == '\n' && !quote) { ++row; col = 0; ++c; continue; }
                if (cc == '\n' && !quote) { ++row; col = 0; continue; }
                if (cc == '\r' && !quote) { ++row; col = 0; continue; }
                arr[row][col] += cc;
            }
            return arr;
        };

        // --- Components ---
        const Toast = ({ type, message, onClose }) => {
            if (!message) return null;
            return (
                <div className={`fixed bottom-10 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 rounded-full shadow-lg flex items-center gap-3 transition-all duration-300 ${type === 'success' ? 'bg-[#191B1D] text-white' : 'bg-red-100 text-red-800 border border-red-200'}`}>
                    {type === 'success' ? <Icons.Check size={20} className="text-[#FFC700]" /> : <Icons.X size={20} />}
                    <span className="font-medium text-sm">{message}</span>
                </div>
            );
        };

        const ActionButton = ({ href, icon: Icon, label, className }) => {
            if (!href) return null;
            return (
                <a href={href} target={href.startsWith('http') ? "_blank" : undefined} className={`flex items-center justify-center gap-2 py-2.5 px-4 rounded-full font-medium text-sm transition-all duration-200 flex-1 ${className}`}>
                    <Icon size={18} /> <span>{label}</span>
                </a>
            );
        };

        const FilterChip = ({ label, active, onClick }) => (
            <button 
                onClick={onClick}
                className={`px-4 py-2 rounded-xl text-sm font-medium transition-all duration-200 whitespace-nowrap ${
                    active 
                    ? 'bg-[#cce8ff] text-[#001d35]' // M3 inspired active state
                    : 'bg-white border border-[#E0E3E7] text-[#444746] hover:bg-[#E9EEF6]'
                }`}
            >
                {label}
            </button>
        );

        // --- Main App ---
        const App = () => {
            const [partners, setPartners] = useState([]);
            const [loading, setLoading] = useState(true);
            const [user, setUser] = useState(null);
            const [searchTerm, setSearchTerm] = useState("");
            const [selectedCategory, setSelectedCategory] = useState("הכל");
            const [filterStatus, setFilterStatus] = useState("all"); 
            const [filterSubCategory, setFilterSubCategory] = useState("all");
            
            // Layout State: 'compact' (mobile default) vs 'detailed' (desktop default)
            const [layoutMode, setLayoutMode] = useState(window.innerWidth < 768 ? 'compact' : 'detailed');

            const [editingId, setEditingId] = useState(null);
            const [viewingId, setViewingId] = useState(null); 
            
            const [editForm, setEditForm] = useState({});
            const [isAddingNew, setIsAddingNew] = useState(false);
            const [isImportModalOpen, setIsImportModalOpen] = useState(false);
            
            const [importUrl, setImportUrl] = useState("https://docs.google.com/spreadsheets/d/e/2PACX-1vS4Lo4X8Hf9h5Cw0uAI2F6pkcqlot8qW6O2lZq-fNpzrpiIj9aSto2VkNUookJ1FAeCVeIofwPSC8MZ/pub?output=csv");
            
            const [notification, setNotification] = useState(null);

            // Derived state for the active partner being viewed
            const activePartner = useMemo(() => partners.find(p => p.id === viewingId), [partners, viewingId]);

            const showNotification = (type, message) => {
                setNotification({ type, message });
                setTimeout(() => setNotification(null), 3500);
            };

            // Init Auth
            useEffect(() => {
                const initAuth = async () => {
                    try {
                        await signInAnonymously(auth);
                    } catch (e) {
                        console.error("Auth failed", e);
                        setLoading(false);
                    }
                };
                initAuth();
                return onAuthStateChanged(auth, (u) => setUser(u));
            }, []);

            // Sync with DB
            useEffect(() => {
                if (!user) return;

                const q = collection(db, 'artifacts', appId, 'public', 'data', 'partners');
                const unsubscribe = onSnapshot(q, (snapshot) => {
                    let docs = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    docs.sort((a, b) => (a.company || "").localeCompare(b.company || ""));
                    setPartners(docs);
                    setLoading(false);
                }, (err) => {
                    console.error("Sync error", err);
                    setLoading(false);
                });

                return () => unsubscribe();
            }, [user]);

            // --- Actions ---
            const toggleContact = async (partner) => {
                if (!user) return;
                try {
                    const ref = doc(db, 'artifacts', appId, 'public', 'data', 'partners', partner.id);
                    await updateDoc(ref, { contacted: !partner.contacted });
                    showNotification('success', partner.contacted ? 'סטטוס עודכן: לא נוצר קשר' : 'סטטוס עודכן: נוצר קשר');
                } catch(e) { console.error(e); showNotification('error', 'שגיאה בעדכון'); }
            };

            const handleDelete = async (id) => {
                if (!user) return;
                if (!window.confirm("האם למחוק שותף זה לצמיתות?")) return;

                try {
                    if (!id) throw new Error("Invalid ID");
                    await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'partners', id));
                    setViewingId(null);
                    setEditingId(null);
                    showNotification('success', 'השותף נמחק בהצלחה');
                } catch (e) {
                    console.error("Delete failed:", e);
                    showNotification('error', 'שגיאה במחיקה');
                }
            };

            const handleSave = async () => {
                if (!user) return;
                const colRef = collection(db, 'artifacts', appId, 'public', 'data', 'partners');
                const data = { ...editForm };
                
                try {
                    if (isAddingNew) {
                        await setDoc(doc(colRef), { ...data, contacted: false, note: "", createdAt: serverTimestamp() });
                        showNotification('success', 'שותף חדש נוסף בהצלחה');
                    } else {
                        await updateDoc(doc(colRef, editingId), data);
                        showNotification('success', 'הפרטים נשמרו בהצלחה');
                    }
                    setEditingId(null);
                    setEditForm({});
                    setIsAddingNew(false);
                } catch(e) {
                    console.error("Save failed:", e);
                    showNotification('error', 'שגיאה בשמירה');
                }
            };

            const saveNote = async (id, text) => {
                if (!user) return;
                try {
                    await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'partners', id), { note: text });
                } catch(e) { console.error(e); }
            };

            const updateNoteLocalUI = (id, text) => {
                 setPartners(prev => prev.map(p => p.id === id ? { ...p, note: text } : p));
            };

            const handleImport = async () => {
                if (!user) return;
                setLoading(true);
                try {
                    // Try primary proxy (AllOrigins)
                    let csvText = "";
                    try {
                        const proxyUrl = "https://api.allorigins.win/raw?url=" + encodeURIComponent(importUrl);
                        const response = await fetch(proxyUrl);
                        if (!response.ok) throw new Error("Proxy 1 Error");
                        csvText = await response.text();
                    } catch (err1) {
                        console.warn("Primary proxy failed, trying backup...", err1);
                        // Try backup proxy (CorsProxy.io)
                        const backupUrl = "https://corsproxy.io/?" + encodeURIComponent(importUrl);
                        const response = await fetch(backupUrl);
                         if (!response.ok) throw new Error("Network response was not ok from backup");
                        csvText = await response.text();
                    }
                    
                    // Validation: Check if response is HTML (Error page) instead of CSV
                    if (csvText.trim().toLowerCase().startsWith("<!doctype html") || csvText.trim().toLowerCase().startsWith("<html")) {
                         throw new Error("הקישור החזיר דף HTML במקום קובץ CSV. ודא שהלינק הוא Pubilshed to Web -> CSV.");
                    }

                    const rawData = parseCSV(csvText);
                    
                    if (rawData.length === 0) throw new Error("קובץ ריק");

                    const headerRowIndex = rawData.findIndex(row => row.some(cell => 
                        cell.includes('שם החברה') || cell.includes('Company') || cell.includes('חברה')
                    ));

                    if (headerRowIndex === -1) throw new Error("לא נמצאה שורת כותרת תקינה ב-CSV");

                    const headers = rawData[headerRowIndex].map(h => h.trim());
                    
                    const keyMap = {
                        "קטגוריה": "category", "תת": "subCategory", "שם החברה": "company", "חברה": "company", 
                        "מנגנון": "entryMechanism", "ערך": "valueProp", "אסטרטגיית": "acceleratorStrategy", 
                        "תובנה": "insight", "טלפון": "phone", "מייל": "email", "מיקום": "location", "דומיין": "domain"
                    };

                    const columnIndices = {};
                    headers.forEach((header, index) => {
                        const foundKey = Object.keys(keyMap).find(k => header.includes(k));
                        if (foundKey) columnIndices[keyMap[foundKey]] = index;
                    });

                    let importCount = 0;
                    const colRef = collection(db, 'artifacts', appId, 'public', 'data', 'partners');
                    const batch = writeBatch(db); 
                    let batchCount = 0;

                    for (let i = headerRowIndex + 1; i < rawData.length; i++) {
                        const row = rawData[i];
                        if (row.length <= 1 && (!row[0] || row[0].trim() === "")) continue;

                        const rowData = {};
                        let hasCompany = false;
                        Object.keys(columnIndices).forEach(key => {
                            const idx = columnIndices[key];
                            const val = row[idx] ? row[idx].trim() : "";
                            rowData[key] = val;
                            if (key === 'company' && val) hasCompany = true;
                        });

                        if (hasCompany) {
                            const newDocRef = doc(colRef);
                            batch.set(newDocRef, { ...rowData, contacted: false, note: "", createdAt: serverTimestamp() });
                            batchCount++;
                            importCount++;
                        }
                    }

                    if (batchCount > 0) {
                        await batch.commit();
                    }
            
                    showNotification('success', `יובאו ${importCount} שותפים בהצלחה!`);
                    setIsImportModalOpen(false);
                } catch (e) {
                    console.error(e);
                    showNotification('error', 'שגיאה בייבוא הנתונים: ' + e.message);
                } finally {
                    setLoading(false);
                }
            };

            const getLogoUrl = (domain, company) => domain ? `https://logo.clearbit.com/${domain}` : `https://ui-avatars.com/api/?name=${encodeURIComponent(company || "?")}&background=random&color=fff`;
            const formatForWhatsapp = (phone) => {
                if (!phone) return "";
                const clean = phone.replace(/\D/g, '');
                return clean.startsWith('0') ? `972${clean.substring(1)}` : `972${clean}`;
            };

            // Filter
            const categories = useMemo(() => ["הכל", ...new Set(partners.map(p => p.category).filter(Boolean))], [partners]);
            const subCategories = useMemo(() => {
                if (selectedCategory === "הכל") return ["הכל"];
                return ["הכל", ...new Set(partners.filter(p => p.category === selectedCategory).map(p => p.subCategory).filter(Boolean))];
            }, [partners, selectedCategory]);

            const filteredPartners = useMemo(() => {
                return partners.filter(p => {
                    const term = searchTerm.toLowerCase();
                    const matchSearch = (p.company||"").toLowerCase().includes(term) || (p.valueProp||"").toLowerCase().includes(term);
                    const matchCat = selectedCategory === "הכל" || p.category === selectedCategory;
                    const matchSub = filterSubCategory === "all" || filterSubCategory === "הכל" || p.subCategory === filterSubCategory;
                    
                    let matchStatus = true;
                    if (filterStatus === 'contacted') matchStatus = p.contacted;
                    if (filterStatus === 'not_contacted') matchStatus = !p.contacted;

                    return matchSearch && matchCat && matchSub && matchStatus;
                });
            }, [partners, searchTerm, selectedCategory, filterSubCategory, filterStatus]);

            return (
                <div className="min-h-screen flex flex-col font-sans text-[#1F1F1F]">
                    {notification && <Toast type={notification.type} message={notification.message} onClose={() => setNotification(null)} />}

                    {/* GEMINI-INSPIRED TOP BAR */}
                    <header className="sticky top-0 z-40 bg-[#F0F4F9]/95 backdrop-blur-md px-6 py-4 flex items-center justify-between">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-[#191B1D] rounded-full flex items-center justify-center text-[#FFC700]">
                                <Icons.Flash size={24} className="fill-current" />
                            </div>
                            <div>
                                <h1 className="text-xl font-bold tracking-tight text-[#191B1D]">Psychoflash</h1>
                                <p className="text-xs text-gray-500 font-medium -mt-1">Network Manager</p>
                            </div>
                        </div>

                        <div className="flex gap-2">
                             <button onClick={() => setIsImportModalOpen(true)} className="w-10 h-10 rounded-full hover:bg-[#E0E3E7] flex items-center justify-center transition-colors text-[#444746]" title="ייבוא">
                                <Icons.UploadCloud size={20} />
                            </button>
                            <button onClick={() => { setEditingId('new'); setEditForm({ company: "", category: "", subCategory: "", phone: "", email: "", location: "", valueProp: "" }); setIsAddingNew(true); }} className="hidden md:flex items-center gap-2 bg-[#C2E7FF] hover:bg-[#B3D7EF] text-[#001D35] px-5 py-2.5 rounded-full text-sm font-semibold transition-colors shadow-sm">
                                <Icons.Plus size={18} />
                                <span>שותף חדש</span>
                            </button>
                             <button onClick={() => { setEditingId('new'); setEditForm({ company: "", category: "", subCategory: "", phone: "", email: "", location: "", valueProp: "" }); setIsAddingNew(true); }} className="md:hidden w-12 h-12 bg-[#C2E7FF] text-[#001D35] rounded-xl flex items-center justify-center shadow-sm">
                                <Icons.Plus size={24} />
                            </button>
                        </div>
                    </header>

                    {/* MAIN SEARCH & FILTERS AREA */}
                    <div className="max-w-7xl mx-auto w-full px-4 md:px-6 pt-2 pb-6">
                        {/* Search Pill */}
                        <div className="relative w-full max-w-3xl mx-auto mb-6">
                            <input 
                                type="text" 
                                placeholder="חיפוש חברה, טכנולוגיה, או שם איש קשר..." 
                                className="w-full h-14 pl-12 pr-6 bg-white rounded-[28px] shadow-sm hover:shadow-md border border-transparent hover:border-[#E0E3E7] focus:border-[#FFC700] outline-none transition-all text-base text-[#1F1F1F] placeholder-gray-400"
                                value={searchTerm} 
                                onChange={(e) => setSearchTerm(e.target.value)} 
                            />
                            <div className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">
                                <Icons.Search size={22} />
                            </div>
                        </div>

                        {/* Filter Chips Scroll */}
                        <div className="flex flex-col gap-4">
                            {/* Main Filters */}
                            <div className="flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide no-scrollbar -mx-4 px-4 md:mx-0 md:px-0">
                                <FilterChip label="הכל" active={selectedCategory === "הכל"} onClick={() => {setSelectedCategory("הכל"); setFilterSubCategory("all");}} />
                                {categories.filter(c => c !== "הכל").map(cat => (
                                    <FilterChip key={cat} label={cat} active={selectedCategory === cat} onClick={() => {setSelectedCategory(cat); setFilterSubCategory("all");}} />
                                ))}
                            </div>

                            {/* Secondary Filters Row */}
                            <div className="flex flex-wrap items-center justify-between gap-3 bg-white/50 p-3 rounded-2xl border border-white">
                                <div className="flex items-center gap-2 overflow-x-auto">
                                    <span className="text-xs font-bold text-gray-400 pl-2">תת-קטגוריה:</span>
                                    <select 
                                        className="bg-transparent text-sm font-medium text-gray-700 outline-none cursor-pointer hover:bg-black/5 rounded px-2 py-1 transition-colors" 
                                        value={filterSubCategory} 
                                        onChange={(e) => setFilterSubCategory(e.target.value)} 
                                        disabled={selectedCategory === 'הכל'}
                                    >
                                        {subCategories.map(cat => <option key={cat} value={cat}>{cat}</option>)}
                                    </select>
                                </div>

                                <div className="flex items-center gap-2 bg-[#E9EEF6] rounded-full p-1">
                                    <button onClick={() => setLayoutMode('detailed')} className={`p-1.5 rounded-full transition-all ${layoutMode === 'detailed' ? 'bg-white shadow-sm text-black' : 'text-gray-500 hover:text-black'}`}><Icons.Layout size={16} /></button>
                                    <button onClick={() => setLayoutMode('compact')} className={`p-1.5 rounded-full transition-all ${layoutMode === 'compact' ? 'bg-white shadow-sm text-black' : 'text-gray-500 hover:text-black'}`}><Icons.Grid size={16} /></button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* CONTENT GRID */}
                    <div className="max-w-7xl mx-auto w-full px-4 md:px-6 pb-20 flex-grow">
                         {loading && partners.length === 0 ? (
                            <div className="flex justify-center py-20">
                                <div className="animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-[#FFC700]"></div>
                            </div>
                        ) : (
                            <>
                                {/* --- DETAILED VIEW (Cards) --- */}
                                {layoutMode === 'detailed' && (
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        {filteredPartners.map((partner) => (
                                            <div key={partner.id} className="bg-white rounded-[24px] p-0 flex flex-col relative shadow-sm hover:shadow-md transition-all duration-300 group border border-transparent hover:border-[#E0E3E7] overflow-hidden">
                                                
                                                {/* Card Header */}
                                                <div className="p-6 pb-4 flex items-start gap-4">
                                                    <div className="w-14 h-14 bg-[#F8F9FA] rounded-2xl flex items-center justify-center p-2 shrink-0 overflow-hidden">
                                                        <img src={getLogoUrl(partner.domain, partner.company)} alt="" className="w-full h-full object-contain mix-blend-multiply" onError={(e) => e.target.src = `https://ui-avatars.com/api/?name=${partner.company}`} />
                                                    </div>
                                                    <div className="flex-grow min-w-0">
                                                        <div className="flex justify-between items-start">
                                                            <h2 className="text-xl font-bold text-[#1F1F1F] leading-tight truncate" title={partner.company}>{partner.company}</h2>
                                                            <button 
                                                                onClick={(e) => { e.stopPropagation(); toggleContact(partner); }} 
                                                                className={`w-8 h-8 rounded-full flex items-center justify-center transition-colors ${partner.contacted ? 'bg-[#C4EED0] text-[#0F5132]' : 'bg-[#F0F4F9] text-gray-400 hover:bg-[#E0E3E7]'}`}
                                                            >
                                                                {partner.contacted ? <Icons.Check size={16} /> : <div className="w-2.5 h-2.5 rounded-full border-2 border-current"></div>}
                                                            </button>
                                                        </div>
                                                        <div className="flex items-center gap-2 mt-1">
                                                            <span className="text-xs font-medium bg-[#E9EEF6] px-2 py-0.5 rounded-md text-[#444746] truncate max-w-[120px]">{partner.category}</span>
                                                            <span className="text-xs text-gray-400 flex items-center gap-0.5"><Icons.MapPin size={10} /> {partner.location || "IL"}</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* Card Body */}
                                                <div className="px-6 space-y-3 flex-grow">
                                                    {partner.valueProp && (
                                                        <p className="text-sm text-[#444746] leading-relaxed line-clamp-3 bg-[#F0F4F9]/50 p-3 rounded-xl">
                                                            {partner.valueProp}
                                                        </p>
                                                    )}
                                                    
                                                    {partner.acceleratorStrategy && (
                                                        <div className="flex items-start gap-2 text-xs bg-[#FFF8E1] p-2 rounded-lg text-[#5F4500]">
                                                            <Icons.Rocket size={14} className="mt-0.5 shrink-0" />
                                                            <span className="font-medium">{partner.acceleratorStrategy}</span>
                                                        </div>
                                                    )}
                                                </div>

                                                {/* Notes Area (Invisible until hover or focus in desktop, visible on mobile) */}
                                                <div className="px-6 mt-3">
                                                    <input 
                                                        className="w-full text-xs bg-transparent border-b border-[#E0E3E7] focus:border-[#FFC700] outline-none py-2 transition-colors placeholder-gray-400" 
                                                        placeholder="הוסף הערה..." 
                                                        value={partner.note || ""} 
                                                        onChange={(e) => updateNoteLocalUI(partner.id, e.target.value)} 
                                                        onBlur={(e) => saveNote(partner.id, e.target.value)} 
                                                    />
                                                </div>

                                                {/* Action Footer */}
                                                <div className="p-4 mt-2 flex gap-2 border-t border-[#F0F4F9]">
                                                    <ActionButton href={partner.phone ? `tel:${partner.phone}` : null} icon={Icons.Phone} label="" className="bg-[#F0F4F9] hover:bg-[#E0E3E7] text-[#1F1F1F]" />
                                                    <ActionButton href={partner.email ? `mailto:${partner.email}` : null} icon={Icons.Mail} label="" className="bg-[#F0F4F9] hover:bg-[#E0E3E7] text-[#1F1F1F]" />
                                                    <ActionButton href={partner.phone ? `https://wa.me/${formatForWhatsapp(partner.phone)}` : null} icon={Icons.MessageCircle} label="" className="bg-[#C4EED0] hover:bg-[#A8E2B8] text-[#0F5132]" />
                                                    
                                                    <div className="w-px bg-gray-200 mx-1"></div>
                                                    
                                                    <button onClick={() => { setEditingId(partner.id); setEditForm(partner); }} className="p-2.5 rounded-full text-gray-400 hover:text-blue-600 hover:bg-blue-50 transition-colors">
                                                        <Icons.Edit3 size={18} />
                                                    </button>
                                                     <button onClick={() => handleDelete(partner.id)} className="p-2.5 rounded-full text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors">
                                                        <Icons.Trash2 size={18} />
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {/* --- COMPACT VIEW (Grid) --- */}
                                {layoutMode === 'compact' && (
                                    <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                                        {filteredPartners.map((partner) => (
                                            <div 
                                                key={partner.id} 
                                                onClick={() => setViewingId(partner.id)}
                                                className="bg-white rounded-[20px] p-4 flex flex-col items-center text-center cursor-pointer hover:shadow-md transition-all border border-transparent hover:border-[#C2E7FF] relative group"
                                            >
                                                {partner.contacted && <div className="absolute top-3 right-3 w-2 h-2 rounded-full bg-[#1F1F1F]"></div>}
                                                <div className="w-12 h-12 mb-3 bg-[#F8F9FA] rounded-full flex items-center justify-center p-2">
                                                    <img src={getLogoUrl(partner.domain, partner.company)} alt="" className="w-full h-full object-contain mix-blend-multiply" onError={(e) => e.target.src = `https://ui-avatars.com/api/?name=${partner.company}`} />
                                                </div>
                                                <h3 className="text-sm font-bold text-[#1F1F1F] line-clamp-1 w-full">{partner.company}</h3>
                                                <span className="text-[10px] text-gray-500 mt-1">{partner.category}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </>
                        )}
                    </div>

                    {/* VIEWER MODAL (Cleaner M3 Style) */}
                    {activePartner && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-[#1F1F1F]/40 backdrop-blur-sm" onClick={() => setViewingId(null)}>
                            <div className="bg-[#F0F4F9] w-full max-w-lg shadow-xl flex flex-col rounded-[28px] overflow-hidden relative max-h-[85vh]" onClick={e => e.stopPropagation()}>
                                
                                <div className="absolute top-4 left-4 z-10">
                                    <button onClick={() => setViewingId(null)} className="p-2 bg-white/80 hover:bg-white rounded-full text-[#1F1F1F] transition-colors shadow-sm"><Icons.X size={20} /></button>
                                </div>

                                <div className="p-0 overflow-y-auto">
                                    {/* Header Section */}
                                    <div className="bg-white p-8 pb-6 rounded-b-[32px] shadow-sm">
                                        <div className="flex flex-col items-center text-center">
                                            <div className="w-24 h-24 bg-[#F8F9FA] rounded-3xl flex items-center justify-center p-4 mb-4 shadow-inner">
                                                <img src={getLogoUrl(activePartner.domain, activePartner.company)} alt="" className="w-full h-full object-contain mix-blend-multiply" onError={(e) => e.target.src = `https://ui-avatars.com/api/?name=${activePartner.company}`} />
                                            </div>
                                            <h2 className="text-2xl font-bold text-[#1F1F1F] mb-1">{activePartner.company}</h2>
                                            <div className="flex items-center gap-2 mb-4">
                                                <span className="px-3 py-1 bg-[#E9EEF6] rounded-full text-xs font-medium text-[#444746]">{activePartner.category}</span>
                                                {activePartner.subCategory && <span className="text-xs text-gray-400">• {activePartner.subCategory}</span>}
                                            </div>

                                            <div className="flex gap-3 w-full justify-center">
                                                 <ActionButton href={activePartner.phone ? `tel:${activePartner.phone}` : null} icon={Icons.Phone} label="Call" className="bg-[#F0F4F9] text-[#1F1F1F] flex-none w-12 px-0" />
                                                 <ActionButton href={activePartner.phone ? `https://wa.me/${formatForWhatsapp(activePartner.phone)}` : null} icon={Icons.MessageCircle} label="WhatsApp" className="bg-[#C4EED0] text-[#001D35] flex-grow" />
                                                 <ActionButton href={activePartner.email ? `mailto:${activePartner.email}` : null} icon={Icons.Mail} label="Email" className="bg-[#C2E7FF] text-[#001D35] flex-grow" />
                                            </div>
                                        </div>
                                    </div>

                                    {/* Body Section */}
                                    <div className="p-6 space-y-4">
                                        <div className="bg-white p-4 rounded-2xl">
                                            <label className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 block">ערך אסטרטגי</label>
                                            <p className="text-sm text-[#1F1F1F] leading-relaxed">{activePartner.valueProp || "אין מידע זמין"}</p>
                                        </div>

                                        <div className="grid grid-cols-2 gap-3">
                                            <div className="bg-white p-4 rounded-2xl">
                                                <label className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1 block">מנגנון</label>
                                                <p className="text-sm font-medium">{activePartner.entryMechanism || "-"}</p>
                                            </div>
                                            <div className="bg-[#FFF8E1] p-4 rounded-2xl">
                                                <label className="text-xs font-bold text-[#5F4500]/70 uppercase tracking-wider mb-1 block">אסטרטגיה</label>
                                                <p className="text-sm font-bold text-[#5F4500]">{activePartner.acceleratorStrategy || "-"}</p>
                                            </div>
                                        </div>

                                        <div className="bg-white p-4 rounded-2xl">
                                            <label className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 block">הערות</label>
                                            <textarea className="w-full text-sm bg-transparent outline-none resize-none min-h-[60px]" placeholder="הוסף הערות כאן..." value={activePartner.note || ""} onChange={(e) => updateNoteLocalUI(activePartner.id, e.target.value)} onBlur={(e) => saveNote(activePartner.id, e.target.value)} />
                                        </div>

                                        <div className="flex justify-between items-center pt-4 opacity-50 hover:opacity-100 transition-opacity">
                                            <button onClick={() => handleDelete(activePartner.id)} className="text-red-500 text-xs font-medium px-3 py-2 hover:bg-red-50 rounded-lg">מחק שותף</button>
                                            <button onClick={() => { setEditingId(activePartner.id); setEditForm(activePartner); setViewingId(null); setIsAddingNew(false); }} className="text-blue-600 text-xs font-medium px-3 py-2 hover:bg-blue-50 rounded-lg">ערוך פרטים</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* IMPORT MODAL (M3) */}
                    {isImportModalOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-[#1F1F1F]/40 backdrop-blur-sm">
                            <div className="bg-[#F0F4F9] w-full max-w-lg shadow-xl flex flex-col rounded-[28px] overflow-hidden">
                                <div className="p-6 pb-0 flex justify-between items-center">
                                    <h2 className="text-xl font-bold text-[#1F1F1F]">ייבוא מ-CSV</h2>
                                    <button onClick={() => setIsImportModalOpen(false)} className="w-8 h-8 rounded-full hover:bg-[#E0E3E7] flex items-center justify-center"><Icons.X size={20} /></button>
                                </div>
                                <div className="p-6 space-y-4">
                                    <p className="text-sm text-gray-600 bg-white p-4 rounded-2xl">הדבק כאן קישור ל-Google Sheet שפורסם כ-CSV.</p>
                                    <input className="w-full p-4 bg-white rounded-xl border-none focus:ring-2 focus:ring-[#FFC700] outline-none text-sm shadow-sm" 
                                            value={importUrl} onChange={e => setImportUrl(e.target.value)} placeholder="https://docs.google.com/..." />
                                </div>
                                <div className="p-6 pt-0 flex justify-end gap-3">
                                    <button onClick={() => setIsImportModalOpen(false)} className="px-6 py-2.5 font-medium text-gray-600 hover:bg-[#E0E3E7] transition-colors rounded-full text-sm">ביטול</button>
                                    <button onClick={handleImport} className="px-6 py-2.5 font-bold text-[#001D35] bg-[#C2E7FF] hover:bg-[#B3D7EF] transition-all rounded-full text-sm shadow-sm flex items-center gap-2">
                                        {loading ? <Icons.RefreshCw className="animate-spin" size={16} /> : <Icons.UploadCloud size={16} />} ייבוא נתונים
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* EDIT/ADD MODAL (M3) */}
                    {editingId && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-[#1F1F1F]/40 backdrop-blur-sm">
                            <div className="bg-[#F0F4F9] w-full max-w-2xl shadow-xl flex flex-col max-h-[90vh] rounded-[28px] overflow-hidden">
                                <div className="p-6 border-b border-[#E0E3E7] flex justify-between items-center bg-white">
                                    <h2 className="text-xl font-bold text-[#1F1F1F]">{isAddingNew ? "הוספת שותף חדש" : "עריכה"}</h2>
                                    <button onClick={() => setEditingId(null)} className="w-8 h-8 rounded-full hover:bg-[#E0E3E7] flex items-center justify-center"><Icons.X size={20} /></button>
                                </div>
                                <div className="p-8 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6 bg-[#F0F4F9]">
                                    <div className="col-span-2 md:col-span-1">
                                        <div className="bg-white px-4 py-2 rounded-t-xl border-b border-[#747775] focus-within:border-[#FFC700] focus-within:border-b-2 transition-all">
                                            <label className="text-xs text-gray-500">שם החברה</label>
                                            <input className="w-full bg-transparent outline-none font-bold text-[#1F1F1F]" value={editForm.company || ""} onChange={e => setEditForm({...editForm, company: e.target.value})} />
                                        </div>
                                    </div>
                                    <div className="col-span-2 md:col-span-1">
                                        <div className="bg-white px-4 py-2 rounded-t-xl border-b border-[#747775] focus-within:border-[#FFC700] focus-within:border-b-2 transition-all">
                                            <label className="text-xs text-gray-500">דומיין</label>
                                            <input className="w-full bg-transparent outline-none" value={editForm.domain || ""} onChange={e => setEditForm({...editForm, domain: e.target.value})} placeholder="example.com" />
                                        </div>
                                    </div>
                                    
                                    <div className="col-span-2">
                                        <div className="bg-white px-4 py-2 rounded-xl border border-transparent focus-within:border-[#FFC700] transition-all">
                                            <label className="text-xs text-gray-500 mb-1 block">ערך אסטרטגי</label>
                                            <textarea className="w-full bg-transparent outline-none resize-none" rows="2" value={editForm.valueProp || ""} onChange={e => setEditForm({...editForm, valueProp: e.target.value})} />
                                        </div>
                                    </div>
                                    
                                    <div className="col-span-2">
                                        <div className="bg-[#FFF8E1] px-4 py-2 rounded-xl border border-transparent focus-within:border-[#5F4500] transition-all">
                                            <label className="text-xs text-[#5F4500] mb-1 block">אסטרטגיית שת"פ</label>
                                            <textarea className="w-full bg-transparent outline-none resize-none font-medium text-[#1F1F1F]" rows="2" value={editForm.acceleratorStrategy || ""} onChange={e => setEditForm({...editForm, acceleratorStrategy: e.target.value})} />
                                        </div>
                                    </div>

                                    <div className="bg-white px-4 py-2 rounded-t-xl border-b border-[#747775]">
                                        <label className="text-xs text-gray-500">טלפון</label>
                                        <input className="w-full bg-transparent outline-none" value={editForm.phone || ""} onChange={e => setEditForm({...editForm, phone: e.target.value})} />
                                    </div>
                                    <div className="bg-white px-4 py-2 rounded-t-xl border-b border-[#747775]">
                                        <label className="text-xs text-gray-500">מייל</label>
                                        <input className="w-full bg-transparent outline-none" value={editForm.email || ""} onChange={e => setEditForm({...editForm, email: e.target.value})} />
                                    </div>
                                    
                                    <div className="bg-white px-4 py-2 rounded-t-xl border-b border-[#747775]">
                                        <label className="text-xs text-gray-500">קטגוריה</label>
                                        <input className="w-full bg-transparent outline-none" value={editForm.category || ""} onChange={e => setEditForm({...editForm, category: e.target.value})} />
                                    </div>
                                    <div className="bg-white px-4 py-2 rounded-t-xl border-b border-[#747775]">
                                        <label className="text-xs text-gray-500">מנגנון כניסה</label>
                                        <input className="w-full bg-transparent outline-none" value={editForm.entryMechanism || ""} onChange={e => setEditForm({...editForm, entryMechanism: e.target.value})} />
                                    </div>
                                </div>
                                <div className="p-6 flex justify-end gap-4 bg-white border-t border-[#E0E3E7]">
                                    <button onClick={() => setEditingId(null)} className="px-6 py-2.5 font-medium text-gray-600 hover:bg-[#F0F4F9] rounded-full transition-colors text-sm">ביטול</button>
                                    <button onClick={handleSave} className="px-8 py-2.5 font-bold text-[#191B1D] bg-[#FFC700] hover:bg-[#FFD740] rounded-full transition-all shadow-sm flex items-center gap-2 text-sm">
                                        <Icons.Save size={18} /> שמירה
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
