<!DOCTYPE html>
<html lang="he" dir="rtl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CineMatch OS | The Production Operating System</title>
    <meta name="description" content="מערכת הפעלה לניהול הפקות, איתור צוותים וחיזוי סינרגיה.">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@100;300;400;500;700;900&family=Inter:wght@200;300;400;500;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

    <!-- Configuration -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Heebo', 'Inter', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    colors: {
                        brand: {
                            dark: '#0f172a',
                            light: '#f8fafc',
                            primary: '#3b82f6', // Blue
                            accent: '#8b5cf6', // Purple
                            success: '#10b981', // Green (Time)
                            warning: '#f59e0b', // Orange (Taste)
                            danger: '#ef4444'
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out forwards',
                        'slide-up': 'slideUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'pulse-glow': 'pulseGlow 3s infinite',
                        'graph-breath': 'graphBreath 3s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { transform: 'translateY(30px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        pulseGlow: {
                            '0%, 100%': { boxShadow: '0 0 5px rgba(59, 130, 246, 0.5)' },
                            '50%': { boxShadow: '0 0 20px rgba(59, 130, 246, 0.8)' },
                        },
                        graphBreath: {
                            '0%': { transform: 'scale(1)' },
                            '100%': { transform: 'scale(1.03)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Base Styles */
        :root {
            --bg-app: #0f172a;
            --bg-card: #1e293b;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --border-color: #334155;
        }

        .light-mode {
            --bg-app: #f1f5f9;
            --bg-card: #ffffff;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
        }

        body {
            background-color: var(--bg-app);
            color: var(--text-main);
            transition: background-color 0.3s, color 0.3s;
        }

        /* Glassmorphism & Cards */
        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .light-mode .glass-card {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .sys-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            transition: transform 0.2s, border-color 0.2s;
        }
        .sys-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }

        /* Canvas Ticker Styles */
        .ticker-container {
            width: 100%;
            height: 48px;
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            cursor: grab;
        }
        .ticker-container:active {
            cursor: grabbing;
        }
        canvas#ticker-canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        .ticker-fade-left, .ticker-fade-right {
            position: absolute; top: 0; bottom: 0; width: 50px; z-index: 10; pointer-events: none;
        }
        .ticker-fade-left { left: 0; background: linear-gradient(to right, var(--bg-card), transparent); }
        .ticker-fade-right { right: 0; background: linear-gradient(to left, var(--bg-card), transparent); }


        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-app); }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #3b82f6; }

        /* Utilities */
        .gradient-text {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .grid-bg {
            background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
            background-size: 30px 30px;
            opacity: 0.1;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Background Grid -->
    <div class="fixed inset-0 grid-bg pointer-events-none z-0"></div>

    <!-- Navigation -->
    <nav class="fixed w-full z-50 top-0 bg-opacity-90 backdrop-blur-md border-b border-[var(--border-color)] transition-colors duration-300" style="background-color: var(--bg-card);">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <!-- Logo -->
            <div class="flex items-center gap-3 cursor-pointer" onclick="window.scrollTo(0,0)">
                <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/20">
                    <i class="fas fa-layer-group text-lg"></i>
                </div>
                <div>
                    <h1 class="text-xl font-black tracking-tight leading-none">CineMatch <span class="text-blue-500">OS</span></h1>
                    <p class="text-[10px] text-[var(--text-muted)] font-mono tracking-widest uppercase">Production Intelligence</p>
                </div>
            </div>

            <!-- Desktop Menu -->
            <div class="hidden lg:flex items-center gap-8 text-sm font-medium text-[var(--text-muted)]">
                <a href="#dashboard" class="hover:text-blue-500 transition">דשבורד שוק</a>
                <a href="#simulator" class="hover:text-blue-500 transition">סימולטור צוותים</a>
                <a href="#calculator" class="hover:text-blue-500 transition">מחשבון תקציב</a>
                <a href="#tech" class="hover:text-blue-500 transition">טכנולוגיה (RF)</a>
                <a href="#investors" class="hover:text-blue-500 transition">משקיעים</a>
                <a href="#about" class="hover:text-blue-500 transition">על היזם</a>
            </div>

            <!-- Controls -->
            <div class="flex items-center gap-3">
                <button onclick="toggleTheme()" class="w-10 h-10 rounded-full border border-[var(--border-color)] flex items-center justify-center hover:bg-[var(--bg-app)] transition">
                    <i class="fas fa-moon" id="theme-icon"></i>
                </button>
                <a href="#contact" class="hidden md:block bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg font-bold text-sm transition shadow-lg shadow-blue-600/20">
                    צור קשר
                </a>
                <!-- Mobile Menu Button -->
                <button class="lg:hidden text-2xl" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden lg:hidden bg-[var(--bg-card)] border-b border-[var(--border-color)] p-4 absolute w-full">
            <div class="flex flex-col gap-4 text-center font-bold">
                <a href="#dashboard" onclick="this.parentElement.parentElement.classList.add('hidden')">דשבורד</a>
                <a href="#simulator" onclick="this.parentElement.parentElement.classList.add('hidden')">סימולטור</a>
                <a href="#calculator" onclick="this.parentElement.parentElement.classList.add('hidden')">מחשבון</a>
                <a href="#investors" onclick="this.parentElement.parentElement.classList.add('hidden')">משקיעים</a>
            </div>
        </div>
    </nav>

    <!-- Canvas Ticker (Replacing Old Ticker) -->
    <div class="fixed top-20 z-40 w-full ticker-container" id="ticker-container">
        <div class="ticker-fade-left"></div>
        <div class="ticker-fade-right"></div>
        <canvas id="ticker-canvas"></canvas>
    </div>

    <!-- Main Content -->
    <main class="relative z-10 pt-36 pb-20 px-6 max-w-7xl mx-auto space-y-32">

        <!-- HERO SECTION -->
        <section class="text-center min-h-[60vh] flex flex-col items-center justify-center animate-fade-in">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-500/10 text-blue-500 text-xs font-bold border border-blue-500/20 mb-6">
                <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                <span>System Online v2.5 (Gemini AI Enabled) ✨</span>
            </div>
            
            <h1 class="text-5xl md:text-7xl font-black leading-tight tracking-tight mb-6">
                מערכת ההפעלה של<br>
                <span class="gradient-text">עולם ההפקה והתוכן</span>
            </h1>
            
            <p class="text-xl text-[var(--text-muted)] max-w-2xl mx-auto mb-10 leading-relaxed">
                מאלגוריתמיקה של איתור צוותים ועד ניהול תקציב בזמן אמת.
                <br>CineMatch משתמשת בבינה מלאכותית כדי לחבר את הצוות המושלם בתוך שניות.
            </p>
            
            <div class="flex flex-col sm:flex-row gap-4">
                <button onclick="scrollToSection('simulator')" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold text-lg shadow-xl shadow-blue-500/25 transition hover:scale-105">
                    <i class="fas fa-search ml-2"></i> חפש מעגל עבודה
                </button>
                <button onclick="scrollToSection('investors')" class="px-8 py-4 bg-[var(--bg-card)] border border-[var(--border-color)] hover:border-blue-500 text-[var(--text-main)] rounded-xl font-bold text-lg transition">
                    מידע למשקיעים
                </button>
            </div>
        </section>

        <!-- DASHBOARD SECTION -->
        <section id="dashboard" class="scroll-mt-32">
            <div class="flex justify-between items-end mb-8 border-b border-[var(--border-color)] pb-4">
                <div>
                    <h2 class="text-3xl font-bold">דשבורד שוק (Market Pulse)</h2>
                    <p class="text-[var(--text-muted)]">נתונים בזמן אמת על זמינות, מחירים ומגמות.</p>
                </div>
                <div class="text-xs font-mono text-green-500 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span> LIVE DATA
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <!-- Stats Cards -->
                <div class="sys-card p-6 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition"><i class="fas fa-users text-4xl"></i></div>
                    <div class="text-sm text-[var(--text-muted)] mb-1">פרילנסרים פעילים</div>
                    <div class="text-3xl font-mono font-bold">1,240</div>
                    <div class="text-xs text-green-500 mt-2">▲ 12% החודש</div>
                </div>
                <div class="sys-card p-6 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition"><i class="fas fa-shekel-sign text-4xl"></i></div>
                    <div class="text-sm text-[var(--text-muted)] mb-1">מחזור עסקאות</div>
                    <div class="text-3xl font-mono font-bold">₪4.2M</div>
                    <div class="text-xs text-green-500 mt-2">▲ 8% החודש</div>
                </div>
                <div class="sys-card p-6 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition"><i class="fas fa-video text-4xl"></i></div>
                    <div class="text-sm text-[var(--text-muted)] mb-1">עלות יום צילום (ממוצע)</div>
                    <div class="text-3xl font-mono font-bold">₪2,850</div>
                    <div class="text-xs text-blue-500 mt-2">יציב</div>
                </div>
                
                <!-- Chart -->
                <div class="sys-card p-4 md:col-span-1 h-40 md:h-auto flex items-end">
                     <!-- Simple CSS Bar Chart for aesthetics -->
                     <div class="w-full h-full flex items-end justify-between gap-2 px-2">
                        <div class="w-full bg-blue-500/20 rounded-t hover:bg-blue-500/40 transition h-[40%]"></div>
                        <div class="w-full bg-blue-500/20 rounded-t hover:bg-blue-500/40 transition h-[60%]"></div>
                        <div class="w-full bg-blue-500/20 rounded-t hover:bg-blue-500/40 transition h-[55%]"></div>
                        <div class="w-full bg-blue-500/20 rounded-t hover:bg-blue-500/40 transition h-[80%]"></div>
                        <div class="w-full bg-blue-500/50 rounded-t hover:bg-blue-500 transition h-[95%] relative group">
                            <span class="absolute -top-6 right-0 text-xs bg-black text-white px-1 rounded opacity-0 group-hover:opacity-100 transition">Peak</span>
                        </div>
                     </div>
                </div>
            </div>
            
            <!-- Main Graph -->
            <div class="sys-card p-6 mt-6 h-[350px]">
                <canvas id="marketChart"></canvas>
            </div>
        </section>

        <!-- SIMULATOR SECTION (CORE) -->
        <section id="simulator" class="scroll-mt-32">
            <div class="text-center mb-12">
                <span class="text-blue-500 font-bold tracking-widest text-sm uppercase">The Engine</span>
                <h2 class="text-4xl font-bold mb-4">סימולטור הרכבת צוותים (AI Powered)</h2>
                <p class="text-[var(--text-muted)] max-w-2xl mx-auto">
                    הזן את דרישות ההפקה. המנוע שלנו (Gemini AI) ינתח את הדרישות, יבין את הניואנסים (כולל כמויות ותפקידים מיוחדים),
                    ויציע לך 3 מסלולים המבוססים על גרף אתיקה 4D ונתוני אמת.
                </p>
            </div>

            <div class="sys-card p-2 md:p-8 rounded-3xl shadow-2xl bg-gradient-to-b from-[var(--bg-card)] to-[var(--bg-app)]">
                <!-- Search Box -->
                <div class="relative max-w-3xl mx-auto mb-12">
                    <div class="absolute -inset-1 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl opacity-30 blur-lg transition duration-500"></div>
                    <div class="relative flex bg-[var(--bg-card)] rounded-xl overflow-hidden shadow-xl border border-[var(--border-color)]">
                        <input type="text" id="sim-input" 
                               class="w-full bg-transparent text-lg p-4 md:p-6 outline-none placeholder-[var(--text-muted)]"
                               placeholder="לדוגמה: כנס רפואי בירושלים, 2 צלמים, 5 מצלמות, סאונדמן, נתב, במאי, מנהל טכני וטכנאי זום...">
                        <button onclick="runSimulation()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 md:px-10 font-bold transition flex items-center gap-2 whitespace-nowrap">
                            <i class="fas fa-sparkles"></i> <span class="hidden md:inline">מצא צוות (AI)</span>
                        </button>
                    </div>
                </div>

                <!-- Loader -->
                <div id="sim-loader" class="hidden py-12 text-center">
                    <div class="inline-block w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"></div>
                    <div class="text-lg font-mono animate-pulse">מנתח וקטורים של אתיקה וסינרגיה באמצעות AI...</div>
                </div>

                <!-- Results Grid -->
                <div id="sim-results" class="hidden grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Cards will be injected here via JS -->
                </div>
            </div>
        </section>

        <!-- CALCULATOR SECTION -->
        <section id="calculator" class="scroll-mt-32">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
                <div>
                    <h2 class="text-3xl font-bold mb-4">מחשבון תקציב מהיר</h2>
                    <p class="text-[var(--text-muted)] mb-8">
                        בנה את השלד התקציבי לפני סגירת הצוות. השתמש ב-AI כדי לקבל הצעה ראשונית על בסיס תיאור מילולי.
                    </p>
                    
                    <div class="sys-card p-6 h-full flex flex-col">
                        <!-- AI Calc Controls -->
                        <div class="flex gap-2 mb-4">
                            <input type="text" id="ai-calc-input" placeholder="לדוגמה: יום צילום קליפ, כולל במאי, צלם, תאורן ומאפרת" class="flex-1 bg-[var(--bg-app)] border border-[var(--border-color)] rounded-lg p-3 text-sm outline-none focus:border-blue-500">
                            <button onclick="generateBudgetAI()" class="bg-purple-600 text-white px-4 rounded-lg hover:bg-purple-700 transition font-bold whitespace-nowrap flex items-center gap-2">
                                <i class="fas fa-magic"></i> הצע סעיפים
                            </button>
                        </div>

                        <!-- Manual Add -->
                        <div class="flex gap-2 mb-4 border-t border-[var(--border-color)] pt-4">
                            <input type="text" id="calc-item-name" placeholder="שם פריט ידני" class="flex-1 bg-[var(--bg-app)] border border-[var(--border-color)] rounded-lg p-2 text-sm outline-none focus:border-blue-500">
                            <input type="number" id="calc-item-price" placeholder="מחיר" class="w-24 bg-[var(--bg-app)] border border-[var(--border-color)] rounded-lg p-2 text-sm outline-none focus:border-blue-500">
                            <button onclick="addCalcItem()" class="bg-blue-600 text-white w-10 rounded-lg hover:bg-blue-700 transition"><i class="fas fa-plus"></i></button>
                        </div>
                        
                        <!-- List -->
                        <div class="flex-1 bg-[var(--bg-app)] rounded-lg border border-[var(--border-color)] mb-4 overflow-hidden relative min-h-[200px]">
                            <!-- Loader for Calculator -->
                            <div id="calc-loader" class="absolute inset-0 bg-black/50 z-10 hidden flex items-center justify-center">
                                <div class="w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
                            </div>

                            <div class="overflow-y-auto max-h-60">
                                <table class="w-full text-sm text-right">
                                    <tbody id="calc-list" class="divide-y divide-[var(--border-color)]">
                                        <!-- Items -->
                                    </tbody>
                                </table>
                                <div id="calc-empty" class="absolute inset-0 flex flex-col items-center justify-center text-[var(--text-muted)] text-sm">
                                    <i class="fas fa-calculator mb-2 opacity-50 text-2xl"></i>
                                    <span>הרשימה ריקה</span>
                                </div>
                            </div>
                        </div>

                        <!-- Total -->
                        <div class="flex justify-between items-end border-t border-[var(--border-color)] pt-4">
                            <div class="text-sm text-[var(--text-muted)]">סה"כ (כולל מע"מ והוצאות)</div>
                            <div class="text-3xl font-mono font-bold text-blue-500" id="calc-total">0 ₪</div>
                        </div>
                        
                        <button onclick="alert('הצעה נוצרה ונשמרה בטיוטות!')" class="mt-4 w-full bg-[var(--text-main)] text-[var(--bg-app)] font-bold py-3 rounded-xl hover:opacity-90 transition">
                            צור מסמך הצעת מחיר
                        </button>
                    </div>
                </div>
                
                <!-- Visualization/Graphic for Calc -->
                <div class="hidden lg:flex flex-col justify-center h-full relative">
                    <div class="absolute inset-0 bg-blue-500/5 blur-3xl rounded-full"></div>
                    <div class="relative z-10 p-8">
                        <h3 class="text-xl font-bold mb-4">למה להשתמש ב-AI Calculator?</h3>
                        <ul class="space-y-4 text-[var(--text-muted)]">
                            <li class="flex items-start gap-3">
                                <i class="fas fa-brain text-purple-500 mt-1"></i>
                                <div>
                                    <strong class="text-[var(--text-main)]">חיסכון בזמן</strong>
                                    <p class="text-sm">ה-AI מציע את כל אנשי הצוות הרלוונטיים להפקה באופן אוטומטי.</p>
                                </div>
                            </li>
                            <li class="flex items-start gap-3">
                                <i class="fas fa-check-circle text-green-500 mt-1"></i>
                                <div>
                                    <strong class="text-[var(--text-main)]">מניעת שכחה</strong>
                                    <p class="text-sm">המודל זוכר להוסיף סעיפים כמו "נסיעות" ו"ציוד נלווה" שלעיתים נשכחים.</p>
                                </div>
                            </li>
                            <li class="flex items-start gap-3">
                                <i class="fas fa-chart-line text-blue-500 mt-1"></i>
                                <div>
                                    <strong class="text-[var(--text-main)]">אומדן שוק</strong>
                                    <p class="text-sm">המחירים מוצעים בהתאם לממוצעי שוק עדכניים.</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- TECH / METHODOLOGY SECTION -->
        <section id="tech" class="scroll-mt-32">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold mb-4">השיטה: משולש האתיקה</h2>
                <p class="text-[var(--text-muted)] max-w-2xl mx-auto">
                    אנחנו לא רק מחברים אנשים, אנחנו מהנדסים את ההצלחה של ההפקה באמצעות שלושה וקטורים קריטיים.
                </p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- TIME -->
                <div class="sys-card p-8 border-t-4 border-green-500 hover:-translate-y-2 transition duration-300">
                    <div class="w-12 h-12 bg-green-500/10 text-green-500 rounded-lg flex items-center justify-center mb-6 text-xl">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3">זמן (Time)</h3>
                    <p class="text-[var(--text-muted)] text-sm leading-relaxed">
                        דירוג היכולת של הצוות לעמוד בלו"ז צפוף. קריטי לחדשות, שידורים חיים ואירועים שחייבים לתקתק. המערכת מזהה "צוותים מהירים".
                    </p>
                </div>

                <!-- LOOK -->
                <div class="sys-card p-8 border-t-4 border-blue-500 hover:-translate-y-2 transition duration-300">
                    <div class="w-12 h-12 bg-blue-500/10 text-blue-500 rounded-lg flex items-center justify-center mb-6 text-xl">
                        <i class="fas fa-eye"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3">נראות (Look)</h3>
                    <p class="text-[var(--text-muted)] text-sm leading-relaxed">
                        המדד האסתטי. איכות הציוד (4K/8K), עדשות סינמה, תאורה אמנותית וניקיון הסט. קריטי לפרסומות ומותגי יוקרה.
                    </p>
                </div>

                <!-- TASTE -->
                <div class="sys-card p-8 border-t-4 border-orange-500 hover:-translate-y-2 transition duration-300">
                    <div class="w-12 h-12 bg-orange-500/10 text-orange-500 rounded-lg flex items-center justify-center mb-6 text-xl">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-3">טעם/חוויה (Taste)</h3>
                    <p class="text-[var(--text-muted)] text-sm leading-relaxed">
                        הגורם האנושי. יחסי אנוש, שירותיות, והיכולת לפתור משברים בחיוך. קריטי לעבודה מול לקוחות קצה רגישים ומפיקים.
                    </p>
                </div>
            </div>
        </section>

        <!-- INVESTORS / ABOUT SECTION -->
        <section id="investors" class="scroll-mt-32 grid grid-cols-1 lg:grid-cols-2 gap-12 mb-20">
            <!-- About Founder -->
            <div id="about" class="sys-card p-10 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-bl-full -mr-8 -mt-8"></div>
                <div class="flex items-center gap-6 mb-8 relative z-10">
                    <img src="https://ui-avatars.com/api/?name=Orian+Edelenyi&background=2563eb&color=fff&size=128" 
                         class="w-20 h-20 rounded-full border-4 border-[var(--bg-app)] shadow-lg" alt="Orian">
                    <div>
                        <h3 class="text-2xl font-bold">על היזם</h3>
                        <div class="text-blue-500 font-medium">אוריאן אדלני</div>
                    </div>
                </div>
                <p class="text-[var(--text-muted)] leading-relaxed mb-6 relative z-10">
                    "אחרי 15 שנה בתעשיית הטלוויזיה וההפקה, הבנתי שהכאב האמיתי הוא לא ביצירה - אלא בניהול. 
                    הכאוס של קבוצות וואטסאפ, הטלפונים ברגע האחרון והעדר השקיפות הפיננסית חייבים להיפסק. 
                    <br><br>
                    CineMatch OS נולדה כדי להביא סדר, דאטה ושקט נפשי למפיקים ולאנשי הצוות כאחד."
                </p>
                <div class="flex gap-4 text-2xl text-[var(--text-muted)] relative z-10">
                    <a href="#" class="hover:text-blue-500 transition"><i class="fab fa-linkedin"></i></a>
                    <a href="#" class="hover:text-blue-500 transition"><i class="fas fa-globe"></i></a>
                </div>
            </div>

            <!-- Investors Info -->
            <div class="relative flex flex-col justify-center">
                <h3 class="text-3xl font-bold mb-6">הזדמנות להשקעה</h3>
                <div class="space-y-6">
                    <div class="flex items-start gap-4">
                        <div class="w-8 h-8 rounded-full bg-green-500/20 text-green-500 flex items-center justify-center shrink-0 mt-1"><i class="fas fa-check"></i></div>
                        <div>
                            <h4 class="font-bold text-lg">שוק של $50B (Creator Economy)</h4>
                            <p class="text-[var(--text-muted)] text-sm">הביקוש לתוכן וידאו מקצועי בשיא של כל הזמנים.</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4">
                        <div class="w-8 h-8 rounded-full bg-green-500/20 text-green-500 flex items-center justify-center shrink-0 mt-1"><i class="fas fa-check"></i></div>
                        <div>
                            <h4 class="font-bold text-lg">מודל הכנסות כפול</h4>
                            <p class="text-[var(--text-muted)] text-sm">SaaS למפיקים (מנוי חודשי) + עמלת Marketplace (Take Rate).</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4">
                        <div class="w-8 h-8 rounded-full bg-green-500/20 text-green-500 flex items-center justify-center shrink-0 mt-1"><i class="fas fa-check"></i></div>
                        <div>
                            <h4 class="font-bold text-lg">טכנולוגיה מוכחת</h4>
                            <p class="text-[var(--text-muted)] text-sm">אלגוריתם ה-RF לחיזוי התאמת צוותים כבר עובד.</p>
                        </div>
                    </div>
                </div>
                <div class="mt-8">
                    <a href="mailto:invest@cinematch.io" class="inline-flex items-center gap-2 bg-[var(--text-main)] text-[var(--bg-app)] px-6 py-3 rounded-lg font-bold hover:opacity-90 transition">
                        <i class="fas fa-download"></i> הורד Pitch Deck
                    </a>
                </div>
            </div>
        </section>

    </main>

    <!-- FOOTER / CONTACT -->
    <footer id="contact" class="bg-[var(--bg-card)] border-t border-[var(--border-color)] py-16">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-4 gap-10">
            <div class="col-span-1 md:col-span-2">
                <div class="flex items-center gap-2 mb-4">
                    <div class="w-6 h-6 bg-blue-600 rounded flex items-center justify-center text-white text-xs"><i class="fas fa-layer-group"></i></div>
                    <span class="font-bold text-lg">CineMatch OS</span>
                </div>
                <p class="text-[var(--text-muted)] text-sm max-w-sm mb-6">
                    אנחנו בונים את הסטנדרט החדש. מערכת הפעלה שמחברת בין טכנולוגיה, אומנות ואנשים בתעשיית ההפקה.
                </p>
                <form class="flex gap-2 max-w-sm">
                    <input type="email" placeholder="השאר אימייל לניוזלטר" class="flex-1 bg-[var(--bg-app)] border border-[var(--border-color)] rounded px-3 py-2 text-sm outline-none focus:border-blue-500">
                    <button class="bg-blue-600 text-white px-4 rounded hover:bg-blue-700 transition"><i class="fas fa-arrow-left"></i></button>
                </form>
            </div>
            
            <div>
                <h4 class="font-bold mb-4">ניווט</h4>
                <ul class="space-y-2 text-sm text-[var(--text-muted)]">
                    <li><a href="#simulator" class="hover:text-blue-500">סימולטור</a></li>
                    <li><a href="#dashboard" class="hover:text-blue-500">דשבורד</a></li>
                    <li><a href="#about" class="hover:text-blue-500">אודות</a></li>
                </ul>
            </div>
            
            <div>
                <h4 class="font-bold mb-4">צור קשר</h4>
                <ul class="space-y-2 text-sm text-[var(--text-muted)]">
                    <li><i class="fas fa-envelope ml-2"></i> hello@cinematch.io</li>
                    <li><i class="fas fa-phone ml-2"></i> 054-1234567</li>
                    <li><i class="fas fa-map-marker-alt ml-2"></i> תל אביב, ישראל</li>
                </ul>
            </div>
        </div>
        <div class="text-center mt-12 pt-8 border-t border-[var(--border-color)] text-xs text-[var(--text-muted)] font-mono">
            © 2025 CineMatch OS. All rights reserved. Optimized for High-End Production.
        </div>
    </footer>

    <!-- MODAL (Hidden) -->
    <div id="modal-backdrop" class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/80 backdrop-blur-sm opacity-0 transition-opacity duration-300">
        <div id="modal-content" class="bg-[var(--bg-card)] w-full max-w-2xl rounded-2xl shadow-2xl transform scale-95 transition-transform duration-300 overflow-hidden m-4">
            <!-- Content injected by JS -->
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA STORE (Expanded Mock DB) ---
        const DB = {
            freelancers: [
                { id: 'f1', name: 'רון לוי', role: 'מהנדס RF', img: 'https://randomuser.me/api/portraits/men/32.jpg', bio: 'מומחה בשידורי לוויין ומיקרוגל, עבד ב-SpaceX ובסופרבול.', gear: ['Spectrum Analyzer', 'Satcom Truck'] },
                { id: 'f2', name: 'שרה כהן', role: 'במאית ניתוב', img: 'https://randomuser.me/api/portraits/women/44.jpg', bio: 'במאית ראשית בחדשות 12 לשעבר, קור רוח בשידורים חיים.', gear: ['vMix Pro', 'Tricaster 2 Elite'] },
                { id: 'f3', name: 'דני רופ', role: 'צלם ראשי', img: 'https://randomuser.me/api/portraits/men/11.jpg', bio: 'צלם דוקו וחדשות, מתמחה בתנאי שטח קשים.', gear: ['Sony FX9', 'Arri Lights'] },
                { id: 'f4', name: 'מיכל אברהמי', role: 'מפיקה ראשית', img: 'https://randomuser.me/api/portraits/women/68.jpg', bio: 'ניהול הפקות ענק, מומחית בפתרון משברים.', gear: ['Monday.com', 'Excel Wizard'] },
                { id: 'f5', name: 'יוני בלוך', role: 'סאונדמן', img: 'https://randomuser.me/api/portraits/men/22.jpg', bio: 'סאונד להופעות ושידורים, ציוד הקלטה נייד.', gear: ['Sound Devices 888', 'Sennheiser Wireless'] },
                { id: 'f6', name: 'גל גדות', role: 'מאפרת ראשית', img: 'https://randomuser.me/api/portraits/women/23.jpg', bio: 'התמחות באיפור HD לטלוויזיה וקולנוע.', gear: ['Airbrush Tempter', 'MAC Pro Kit'] },
                { id: 'f7', name: 'אביב גפן', role: 'מפעיל רחפן', img: 'https://randomuser.me/api/portraits/men/45.jpg', bio: 'צילומי אוויר מרהיבים, רישיון מטיס מסחרי.', gear: ['DJI Inspire 3', 'Mavic 3 Cine'] },
                { id: 'f8', name: 'נועה קירל', role: 'עוזרת צלם (AC)', img: 'https://randomuser.me/api/portraits/women/12.jpg', bio: 'פוקוס פולרית מדויקת, ניהול דאטה וגיבויים.', gear: ['Teradek Bolt', 'SmallHD 703'] },
                { id: 'f9', name: 'עידן רייכל', role: 'עורך וידאו', img: 'https://randomuser.me/api/portraits/men/55.jpg', bio: 'עריכת אופליין ואונליין, אפטר אפקטס.', gear: ['DaVinci Resolve Studio', 'Mac Studio Ultra'] },
                { id: 'f10', name: 'סטטיק', role: 'תאורן ראשי (Gaffer)', img: 'https://randomuser.me/api/portraits/men/78.jpg', bio: 'עיצוב תאורה דרמטי, שליטה בלוחות פיקוד.', gear: ['Aputure 1200d', 'Astera Titan Tubes'] },
                { id: 'f11', name: 'עדן בן זקן', role: 'מנהלת תסריט', img: 'https://randomuser.me/api/portraits/women/90.jpg', bio: 'שמירה על רצף (Continuity) קפדני.', gear: ['Scriptation', 'iPad Pro'] }
            ],
            tickerItems: [
                "דרוש מהנדס RF בדחיפות לשידור במיאמי...",
                "פרויקט חדש: כנס רפואי בירושלים - דרוש צוות מלא.",
                "רון לוי (מהנדס RF) התפנה לתאריכים 12-14 לחודש.",
                "עדכון מערכת: מחירון האיגוד עודכן במחשבון.",
                "שרה כהן קיבלה דירוג 10 על הפקת אירועי הקיץ."
            ]
        };

        // --- APP STATE ---
        let calcItems = [];
        let isDarkMode = true;
        const apiKey = ""; // API Key provided by environment

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            initTickerCanvas(); // REPLACED CSS Ticker with Canvas Ticker
            initChart();
            renderCalculator();
            if(document.body.classList.contains('light-mode')) isDarkMode = false;
        });

        // --- HELPER FUNCTIONS ---
        function getRandomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
        function getRandomFloat(min, max) { return (Math.random() * (max - min) + min).toFixed(1); }

        // --- GEMINI API CALL ---
        async function callGemini(prompt) {
            
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }]
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) throw new Error('Gemini API Error');
                
                const data = await response.json();
                return data.candidates?.[0]?.content?.parts?.[0]?.text;
            } catch (error) {
                console.error("AI Error:", error);
                return null;
            }
        }

        // --- THEME TOGGLE ---
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            isDarkMode = !isDarkMode;
            const icon = document.getElementById('theme-icon');
            icon.className = isDarkMode ? 'fas fa-moon' : 'fas fa-sun';
            initChart();
        }

        // --- NEW CANVAS TICKER LOGIC ---
        let tickerCanvas, tickerCtx, tickerContainer;
        let tickerMessages = [];
        let lastTimestamp = 0;
        let isDraggingTicker = false;
        let lastDragX = 0;
        let dragStartX = 0;
        let isRealDrag = false;
        const baseSpeed = 50;
        const gap = 100;

        function initTickerCanvas() {
            tickerCanvas = document.getElementById('ticker-canvas');
            tickerContainer = document.getElementById('ticker-container');
            tickerCtx = tickerCanvas.getContext('2d');

            // Parse DB messages to objects
            const rawMessages = DB.tickerItems.map((text, idx) => ({ id: idx, text: text }));
            
            // Create Message instances
            tickerMessages = rawMessages.map(m => new TickerMessage(m));
            
            // Initial positioning
            let currentX = 50;
            tickerMessages.forEach(m => {
                m.x = currentX;
                // Rough estimate for initial placement, exact width calc happens in draw
                currentX -= (m.text.length * 10 + gap); 
            });

            resizeTicker();
            window.addEventListener('resize', resizeTicker);
            requestAnimationFrame(tickerLoop);

            // Drag Events
            tickerCanvas.addEventListener('mousedown', e => {
                isDraggingTicker = true; lastDragX = e.clientX; dragStartX = e.clientX; isRealDrag = false;
                tickerContainer.style.cursor = 'grabbing';
            });
            window.addEventListener('mousemove', e => {
                if(!isDraggingTicker) return;
                const currentX = e.clientX;
                if(Math.abs(currentX - dragStartX) > 5) isRealDrag = true;
                const dx = currentX - lastDragX;
                lastDragX = currentX;
                // Move logic RTL: positive DX means moving right (backward in time/flow)
                tickerMessages.forEach(m => { m.x += dx; });
            });
            window.addEventListener('mouseup', () => {
                isDraggingTicker = false;
                tickerContainer.style.cursor = 'grab';
            });
        }

        function resizeTicker() {
            tickerCanvas.width = tickerContainer.clientWidth;
            tickerCanvas.height = tickerContainer.clientHeight;
            tickerCtx.font = "500 16px 'Heebo', sans-serif";
            tickerCtx.textBaseline = 'middle';
            tickerCtx.textAlign = 'right'; // RTL
        }

        class TickerMessage {
            constructor(data, isSeparator = false) {
                this.data = data;
                this.text = data.text;
                this.isSeparator = isSeparator;
                if(isSeparator) this.text = "✦"; 
                this.x = 0;
                this.width = 0;
            }

            draw(ctx, y) {
                // Determine color based on theme
                ctx.fillStyle = isDarkMode ? '#94a3b8' : '#64748b'; // text-muted color
                if(this.isSeparator) ctx.fillStyle = '#3b82f6'; // Blue for separator

                this.width = ctx.measureText(this.text).width;
                ctx.fillText(this.text, this.x, y);
            }
            
            get left() { return this.x - this.width; }
        }

        function tickerLoop(timestamp) {
            if (!lastTimestamp) lastTimestamp = timestamp;
            const dt = (timestamp - lastTimestamp) / 1000;
            lastTimestamp = timestamp;

            tickerCtx.clearRect(0, 0, tickerCanvas.width, tickerCanvas.height);
            tickerCtx.font = "500 16px 'Heebo', sans-serif"; // Reset font just in case

            let currentSpeed = isDraggingTicker ? 0 : baseSpeed;

            // Draw and Move
            for (let i = 0; i < tickerMessages.length; i++) {
                let m = tickerMessages[i];
                
                if (!isDraggingTicker) {
                    if (i === 0) {
                        m.x += currentSpeed * dt; // Move Right (RTL flow)
                    } else {
                        // Follow leader logic
                        const prev = tickerMessages[i - 1];
                        // In RTL, "prev" (item ahead) is to the right (higher X)
                        // Target X for current item is: prev.left - gap
                        // Wait, RTL rendering:
                        // [Item 2] ...gap... [Item 1] -> Flow direction --->
                        // Item 1 X is largest. Item 2 X is smaller.
                        
                        const targetX = prev.left - gap;
                        
                        // Simple linear movement for now to ensure smoothness
                        m.x += currentSpeed * dt;
                        
                        // Self-correct distance if drift occurs (simple lerp)
                        if (m.x < targetX - 5) m.x += 1; // Catch up
                        if (m.x > targetX + 5) m.x -= 1; // Slow down
                    }
                }
                
                m.draw(tickerCtx, tickerCanvas.height / 2);
            }

            // Infinite Loop Logic (Recycling)
            if (tickerMessages.length > 0) {
                const first = tickerMessages[0];
                const last = tickerMessages[tickerMessages.length - 1];

                // If first item went off-screen to the right (RTL flow end)
                if (first.left > tickerCanvas.width + 100) {
                    const recycled = tickerMessages.shift();
                    // Place it behind the last item
                    // Last item X is... let's calculate relative position
                    recycled.x = last.left - gap;
                    tickerMessages.push(recycled);
                    
                    // Add separator if needed logic could go here, simplifying for CineMatch
                }
            }

            requestAnimationFrame(tickerLoop);
        }


        // --- CHART ---
        function initChart() {
            const ctx = document.getElementById('marketChart').getContext('2d');
            const color = isDarkMode ? '#3b82f6' : '#2563eb';
            const gridColor = isDarkMode ? '#334155' : '#e2e8f0';
            const textColor = isDarkMode ? '#94a3b8' : '#64748b';

            if(window.marketChartInstance) window.marketChartInstance.destroy();

            window.marketChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['ינואר', 'פברואר', 'מרץ', 'אפריל', 'מאי', 'יוני'],
                    datasets: [{
                        label: 'ביקוש לצוותים',
                        data: [65, 75, 70, 85, 92, 110],
                        borderColor: color,
                        backgroundColor: isDarkMode ? 'rgba(59, 130, 246, 0.1)' : 'rgba(37, 99, 235, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                        pointRadius: 4,
                        pointBackgroundColor: isDarkMode ? '#0f172a' : '#ffffff',
                        pointBorderColor: color,
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { color: gridColor, drawBorder: false }, ticks: { color: textColor, font: {family: 'Heebo'} } },
                        y: { grid: { color: gridColor, drawBorder: false }, ticks: { color: textColor } }
                    },
                    interaction: { intersect: false, mode: 'index' }
                }
            });
        }

        // --- SIMULATOR LOGIC (AI POWERED) ---
        async function runSimulation() {
            const input = document.getElementById('sim-input').value;
            if(!input) {
                document.getElementById('sim-input').focus();
                return;
            }

            const loader = document.getElementById('sim-loader');
            const results = document.getElementById('sim-results');
            
            results.classList.add('hidden');
            loader.classList.remove('hidden');

            const prompt = `
                You are a veteran Israeli production manager. 
                Analyze this complex Hebrew request: "${input}".
                
                1. Identify ALL specific roles and quantities requested. Create a COMPLETE crew list.
                2. For each package (Premium, Balanced, Economy), assemble a specific team.
                3. CRITICAL: Invent a "Synergy Story" for the team. 
                   - Who worked with whom before? (e.g. Cameraman A worked with Soundman B).
                   - Who is an "Outsider" (External) brought in just for this project?
                
                Return a JSON array of 3 objects. Each object must have:
                - title (Hebrew)
                - price (Number)
                - match (Number 70-100)
                - tag (Hebrew)
                - description (Hebrew, short summary of the team dynamic, e.g. "Solid core team from News 12, plus an external drone operator")
                - ethics: { time (0-100), look (0-100), taste (0-100), service (0-100) }
                - members: Array of objects. Each member: 
                  { 
                    name (Hebrew), 
                    role (Hebrew), 
                    rating (8.0-10.0), 
                    type: "Core" | "External", 
                    connected_to: [Array of names they worked with] 
                  }
                
                Return ONLY raw JSON. No markdown formatting.
            `;

            let options = [];
            
            const aiResponse = await callGemini(prompt);
            
            if (aiResponse) {
                try {
                    // Cleanup json formatting if needed
                    const jsonStr = aiResponse.replace(/```json/g, '').replace(/```/g, '').trim();
                    options = JSON.parse(jsonStr);
                    
                    // Enforce colors based on type for UI consistency
                    options[0].color = "blue"; options[0].colorRGB = "59, 130, 246";
                    options[1].color = "purple"; options[1].colorRGB = "139, 92, 246";
                    options[2].color = "green"; options[2].colorRGB = "16, 185, 129";
                    
                    // Assign random avatars from DB for visuals
                    options.forEach(opt => {
                        opt.members.forEach(m => {
                            m.img = DB.freelancers[getRandomInt(0, DB.freelancers.length-1)].img;
                        });
                    });

                } catch (e) {
                    console.error("JSON Parse Error", e);
                    options = getFallbackOptions(); // Fallback if AI fails
                }
            } else {
                options = getFallbackOptions(); // Fallback if API fails
            }

            loader.classList.add('hidden');
            results.classList.remove('hidden');
            renderResults(options);
        }

        function getFallbackOptions() {
            // Fallback hardcoded logic (similar to previous version)
            return [
                {
                    title: "צוות פרימיום (Premium)",
                    price: 18500, match: 98, tag: "איכות קולנועית",
                    description: "צוות ותיק שעבד יחד בהפקות דוקו, עם תוספת של מפעיל רחפן חיצוני.",
                    color: "blue", colorRGB: "59, 130, 246",
                    ethics: { time: 90, look: 99, taste: 95, service: 98 },
                    members: [
                        {name: "רון לוי", role: "במאי", rating: 9.9, img: DB.freelancers[0].img, type: "Core", connected_to: ["שרה כהן"]}, 
                        {name: "שרה כהן", role: "צלמת", rating: 9.7, img: DB.freelancers[1].img, type: "Core", connected_to: ["רון לוי"]}, 
                        {name: "מיכל", role: "הפקה", rating: 9.8, img: DB.freelancers[3].img, type: "External", connected_to: []}
                    ]
                },
                {
                    title: "צוות מאוזן (Balanced)",
                    price: 12000, match: 92, tag: "מומלץ",
                    description: "שילוב של כוחות חדשים עם ניסיון מוכח.",
                    color: "purple", colorRGB: "139, 92, 246",
                    ethics: { time: 95, look: 88, taste: 90, service: 92 },
                    members: [
                        {name: "דני רופ", role: "צלם", rating: 9.5, img: DB.freelancers[2].img, type: "Core", connected_to: ["יוני"]}, 
                        {name: "יוני", role: "סאונד", rating: 9.2, img: DB.freelancers[4].img, type: "Core", connected_to: ["דני רופ"]}, 
                        {name: "גל", role: "איפור", rating: 9.4, img: DB.freelancers[5].img, type: "External", connected_to: []}
                    ]
                },
                {
                    title: "צוות בסיסי (Economy)",
                    price: 8500, match: 85, tag: "חסכוני",
                    description: "צוות יעיל ומהיר למשימות דחופות.",
                    color: "green", colorRGB: "16, 185, 129",
                    ethics: { time: 98, look: 75, taste: 85, service: 88 },
                    members: [
                        {name: "אביב", role: "צלם/עורך", rating: 9.0, img: DB.freelancers[6].img, type: "Core", connected_to: []}, 
                        {name: "נועה", role: "עוזרת", rating: 9.1, img: DB.freelancers[7].img, type: "Core", connected_to: []}
                    ]
                }
            ];
        }

        function renderResults(options) {
            const container = document.getElementById('sim-results');
            
            container.innerHTML = options.map((opt, idx) => {
                // 4D Radar Chart Logic
                // Center: 50, 50
                // Max radius: 40
                
                // Time (Top): x=50, y=50 - val
                const pTime = { 
                    x: 50, 
                    y: 50 - (opt.ethics.time / 100) * 40 
                };
                
                // Look (Right): x=50 + val, y=50
                const pLook = { 
                    x: 50 + (opt.ethics.look / 100) * 40, 
                    y: 50 
                };
                
                // Taste (Bottom): x=50, y=50 + val
                const pTaste = { 
                    x: 50, 
                    y: 50 + (opt.ethics.taste / 100) * 40 
                };
                
                // Service (Left): x=50 - val, y=50  (using service or fallback)
                const serviceVal = opt.ethics.service || getRandomInt(80, 95);
                const pService = { 
                    x: 50 - (serviceVal / 100) * 40, 
                    y: 50 
                };

                // Generate random data for simulation display
                const serviceDisplayVal = opt.ethics.service || getRandomInt(80, 99);

                return `
                <div class="sys-card p-6 flex flex-col h-full animate-slide-up" style="animation-delay: ${idx * 100}ms">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <span class="text-[10px] font-bold uppercase tracking-wider text-${opt.color}-500 border border-${opt.color}-500/30 px-2 py-1 rounded mb-2 inline-block bg-${opt.color}-500/10">${opt.tag}</span>
                            <h3 class="font-bold text-lg">${opt.title}</h3>
                        </div>
                        <div class="text-left">
                            <div class="text-2xl font-mono font-bold text-${opt.color}-500">₪${opt.price.toLocaleString()}</div>
                            <div class="text-[10px] text-[var(--text-muted)]">הערכת מחיר</div>
                        </div>
                    </div>

                    <!-- Synergy Description -->
                    <div class="mb-4 text-xs text-[var(--text-muted)] bg-[var(--bg-app)] p-3 rounded border-l-4 border-${opt.color}-500">
                        <span class="font-bold block mb-1 text-${opt.color}-500">דינמיקה קבוצתית:</span>
                        ${opt.description || "צוות מגובש עם ניסיון משותף."}
                    </div>

                    <!-- 4D Radar Chart (SVG) -->
                    <div class="flex justify-center mb-6">
                        <div class="relative w-48 h-48">
                           <svg viewBox="0 0 100 100" class="w-full h-full overflow-visible">
                              <!-- Background Grid (Concentric Diamonds) -->
                              <polygon points="50,10 90,50 50,90 10,50" fill="rgba(${opt.colorRGB}, 0.05)" stroke="var(--border-color)" stroke-width="0.5" stroke-dasharray="2,2" />
                              <polygon points="50,20 80,50 50,80 20,50" fill="none" stroke="var(--border-color)" stroke-width="0.3" stroke-dasharray="2,2" />
                              
                              <!-- Axes Lines -->
                              <line x1="50" y1="50" x2="50" y2="10" stroke="var(--border-color)" stroke-width="0.3" opacity="0.5" />
                              <line x1="50" y1="50" x2="90" y2="50" stroke="var(--border-color)" stroke-width="0.3" opacity="0.5" />
                              <line x1="50" y1="50" x2="50" y2="90" stroke="var(--border-color)" stroke-width="0.3" opacity="0.5" />
                              <line x1="50" y1="50" x2="10" y2="50" stroke="var(--border-color)" stroke-width="0.3" opacity="0.5" />

                              <!-- Data Polygon (With Animation Class) -->
                              <polygon points="${pTime.x},${pTime.y} ${pLook.x},${pLook.y} ${pTaste.x},${pTaste.y} ${pService.x},${pService.y}" 
                                       fill="rgba(${opt.colorRGB}, 0.3)" 
                                       stroke="rgba(${opt.colorRGB}, 1)" 
                                       stroke-width="1.5"
                                       class="animate-graph-breath origin-center" />
                              
                              <!-- Points -->
                              <circle cx="${pTime.x}" cy="${pTime.y}" r="2" fill="white" stroke="rgba(${opt.colorRGB}, 1)" />
                              <circle cx="${pLook.x}" cy="${pLook.y}" r="2" fill="white" stroke="rgba(${opt.colorRGB}, 1)" />
                              <circle cx="${pTaste.x}" cy="${pTaste.y}" r="2" fill="white" stroke="rgba(${opt.colorRGB}, 1)" />
                              <circle cx="${pService.x}" cy="${pService.y}" r="2" fill="white" stroke="rgba(${opt.colorRGB}, 1)" />

                              <!-- Labels -->
                              <text x="50" y="6" text-anchor="middle" font-size="7" fill="var(--text-muted)" font-weight="bold">Time (${opt.ethics.time})</text>
                              <text x="94" y="52" text-anchor="start" font-size="7" fill="var(--text-muted)" font-weight="bold">Look (${opt.ethics.look})</text>
                              <text x="50" y="98" text-anchor="middle" font-size="7" fill="var(--text-muted)" font-weight="bold">Taste (${opt.ethics.taste})</text>
                              <text x="6" y="52" text-anchor="end" font-size="7" fill="var(--text-muted)" font-weight="bold">Service (${serviceDisplayVal})</text>
                           </svg>
                        </div>
                    </div>

                    <div class="flex-1 space-y-3 mb-6">
                        ${opt.members.map(m => {
                            const isExternal = m.type === 'External';
                            const hasConnections = m.connected_to && m.connected_to.length > 0;
                            const borderClass = isExternal ? 'border-dashed border-orange-500/50' : 'border-[var(--border-color)]';
                            const badge = isExternal ? '<span class="text-[9px] bg-orange-500 text-white px-1 rounded ml-2">חיצוני</span>' : '';
                            const connIcon = hasConnections ? `<i class="fas fa-link text-blue-500 text-xs ml-1" title="עבד עם: ${m.connected_to.join(', ')}"></i>` : '';

                            return `
                            <div class="flex items-center gap-3 p-2 hover:bg-[var(--bg-app)] rounded-lg cursor-pointer transition group border ${borderClass}" onclick="openProfile('${m.id || 'f1'}')">
                                <img src="${m.img}" class="w-8 h-8 rounded-full object-cover">
                                <div class="flex-1">
                                    <div class="font-bold text-sm group-hover:text-blue-500 transition flex items-center">
                                        ${m.name} ${badge} ${connIcon}
                                    </div>
                                    <div class="text-xs text-[var(--text-muted)]">${m.role}</div>
                                </div>
                                <div class="text-xs font-bold text-green-500">${m.rating}</div>
                            </div>
                        `}).join('')}
                    </div>

                    <button class="w-full py-3 rounded-xl bg-[var(--bg-app)] border border-[var(--border-color)] hover:border-${opt.color}-500 hover:text-${opt.color}-500 font-bold transition flex justify-center items-center gap-2">
                        <i class="fas fa-check-circle"></i> שריין צוות
                    </button>
                </div>
            `}).join('');
        }

        // --- CALCULATOR LOGIC (AI POWERED) ---
        async function generateBudgetAI() {
            const input = document.getElementById('ai-calc-input').value;
            if(!input) return;

            const loader = document.getElementById('calc-loader');
            loader.classList.remove('hidden');

            const prompt = `
                Act as a film producer. Create a budget list for: "${input}".
                Return JSON array of objects: { name: "Item Name (Hebrew)", price: Number (NIS) }.
                Include at least 5 relevant items.
            `;

            const aiResponse = await callGemini(prompt);
            
            if (aiResponse) {
                try {
                    const jsonStr = aiResponse.replace(/```json/g, '').replace(/```/g, '').trim();
                    const items = JSON.parse(jsonStr);
                    items.forEach(i => addCalcItemManual(i.name, i.price));
                } catch(e) {
                    console.error(e);
                    alert("AI Error. Try again.");
                }
            }
            loader.classList.add('hidden');
        }

        function addCalcItemManual(name, price) {
            calcItems.push({id: Date.now() + Math.random(), name, price});
            renderCalculator();
        }

        function addCalcItem() {
            const nameEl = document.getElementById('calc-item-name');
            const priceEl = document.getElementById('calc-item-price');
            if(nameEl.value && priceEl.value) {
                addCalcItemManual(nameEl.value, parseFloat(priceEl.value));
                nameEl.value = ''; priceEl.value = '';
            }
        }

        function quickAdd(name, price) {
            addCalcItemManual(name, price);
        }

        function removeCalcItem(id) {
            calcItems = calcItems.filter(i => i.id !== id);
            renderCalculator();
        }

        function renderCalculator() {
            const list = document.getElementById('calc-list');
            const empty = document.getElementById('calc-empty');
            const totalEl = document.getElementById('calc-total');

            if(calcItems.length === 0) {
                list.innerHTML = '';
                empty.classList.remove('hidden');
                totalEl.innerText = '0 ₪';
                return;
            }

            empty.classList.add('hidden');
            let total = 0;
            
            list.innerHTML = calcItems.map(item => {
                total += item.price;
                return `
                    <tr class="group">
                        <td class="py-2 text-[var(--text-main)]">${item.name}</td>
                        <td class="py-2 text-[var(--text-muted)] font-mono">${item.price.toLocaleString()}</td>
                        <td class="py-2 text-left">
                            <button onclick="removeCalcItem(${item.id})" class="text-red-500 opacity-0 group-hover:opacity-100 transition"><i class="fas fa-times"></i></button>
                        </td>
                    </tr>
                `;
            }).join('');

            const finalTotal = total * 1.17; 
            totalEl.innerText = Math.round(finalTotal).toLocaleString() + ' ₪';
        }

        // --- PROFILE MODAL ---
        function openProfile(id) {
            // Find person in DB or fallback for AI generated IDs
            let person = DB.freelancers.find(f => f.id === id);
            
            // Generate dynamic profile if person not found (AI member)
            if(!person) {
                person = {
                    name: "איש צוות (AI)", role: "פרילנסר", img: "https://randomuser.me/api/portraits/lego/1.jpg",
                    rating: 9.5, bio: "פרופיל נוצר אוטומטית על ידי המערכת בהתאם לדרישות ההפקה.",
                    gear: ["ציוד מותאם אישית"], ethics: {time: 90, look: 90, taste: 90}
                };
            }
            
            if(person && !person.ethics) {
                person.ethics = { time: getRandomInt(85, 99), look: getRandomInt(85, 99), taste: getRandomInt(85, 99) };
            }

            const modal = document.getElementById('modal-backdrop');
            const content = document.getElementById('modal-content');

            content.innerHTML = `
                <div class="relative">
                    <div class="h-32 bg-gradient-to-r from-blue-600 to-purple-600"></div>
                    <button onclick="closeModal()" class="absolute top-4 right-4 w-8 h-8 bg-black/20 rounded-full text-white flex items-center justify-center hover:bg-black/40 transition">✕</button>
                    
                    <div class="px-8 pb-8">
                        <div class="relative -mt-12 mb-4 flex justify-between items-end">
                            <img src="${person.img}" class="w-24 h-24 rounded-full border-4 border-[var(--bg-card)] shadow-xl bg-[var(--bg-app)] object-cover">
                            <div class="bg-green-500/10 text-green-500 border border-green-500/20 px-3 py-1 rounded-full text-sm font-bold">
                                ${person.rating} Rating
                            </div>
                        </div>
                        
                        <h2 class="text-3xl font-bold mb-1">${person.name}</h2>
                        <div class="text-blue-500 font-medium mb-6">${person.role}</div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-[var(--bg-app)] p-4 rounded-xl border border-[var(--border-color)]">
                                <h4 class="font-bold text-xs text-[var(--text-muted)] mb-2 uppercase">אודות</h4>
                                <p class="text-sm leading-relaxed">${person.bio}</p>
                            </div>
                            <div class="bg-[var(--bg-app)] p-4 rounded-xl border border-[var(--border-color)]">
                                <h4 class="font-bold text-xs text-[var(--text-muted)] mb-2 uppercase">ציוד והתמחויות</h4>
                                <div class="flex flex-wrap gap-2">
                                    ${person.gear.map(g => `<span class="px-2 py-1 bg-blue-500/10 text-blue-500 rounded text-xs border border-blue-500/20">${g}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex gap-4">
                            <div class="flex-1 text-center">
                                <div class="text-2xl font-bold text-green-500">${person.ethics.time}</div>
                                <div class="text-xs text-[var(--text-muted)]">Time</div>
                            </div>
                            <div class="flex-1 text-center">
                                <div class="text-2xl font-bold text-blue-500">${person.ethics.look}</div>
                                <div class="text-xs text-[var(--text-muted)]">Look</div>
                            </div>
                            <div class="flex-1 text-center">
                                <div class="text-2xl font-bold text-orange-500">${person.ethics.taste}</div>
                                <div class="text-xs text-[var(--text-muted)]">Taste</div>
                            </div>
                        </div>
                        
                        <button class="w-full mt-8 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl font-bold transition">
                            שלח הצעת עבודה
                        </button>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                content.classList.remove('scale-95');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('modal-backdrop');
            const content = document.getElementById('modal-content');
            modal.classList.add('opacity-0');
            content.classList.add('scale-95');
            setTimeout(() => { modal.classList.add('hidden'); }, 300);
        }

        document.getElementById('modal-backdrop').addEventListener('click', (e) => {
            if(e.target === document.getElementById('modal-backdrop')) closeModal();
        });

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({behavior: 'smooth'});
        }
    </script>
</body>
</html>
